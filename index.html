<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LaunchPad System Schematic</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%); color: #e5e7eb; min-height: 100vh; overflow-x: hidden; }
    header { padding: 1.25rem 2rem; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid rgba(148, 163, 184, 0.3); background: rgba(26, 31, 46, 0.8); }
    .header-title h1 { font-size: 1.4rem; font-weight: 700; margin-bottom: 0.25rem; }
    .header-title p { font-size: 0.8rem; color: #94a3b8; }
    .header-status { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background: rgba(34, 197, 94, 0.1); border: 1px solid rgba(34, 197, 94, 0.3); border-radius: 999px; font-size: 0.8rem; }
    .status-dot { width: 8px; height: 8px; border-radius: 50%; background: #22c55e; animation: pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    .view-container { position: relative; height: calc(100vh - 80px); overflow-y: auto; overflow-x: hidden; }
    .view { position: absolute; inset: 0; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
    .view.active { opacity: 1; pointer-events: all; }
    .schematic-view { padding: 1.5rem 2rem; display: flex; flex-direction: column; align-items: center; gap: 1.5rem; overflow-y: auto; min-height: 100%; }
    .schematic-container { background: #1a1f35; border: 1px solid rgba(148, 163, 184, 0.3); border-radius: 1rem; padding: 2rem; width: 100%; max-width: 1400px; display: flex; flex-direction: column; align-items: center; }
    .schematic-wrapper { width: 100%; max-width: 1200px; min-width: 320px; height: 500px; position: relative; background: linear-gradient(180deg, rgba(15, 23, 42, 0.5) 0%, transparent 100%); border-radius: 0.5rem; }
    .conveyor { position: absolute; bottom: 20px; left: 5%; right: 5%; height: 100px; background: linear-gradient(180deg, #4a5568 0%, #2d3748 100%); border: 3px solid #1a202c; border-radius: 8px; }
    .conveyor-belt { position: absolute; top: 25px; left: 30px; right: 30px; height: 35px; background: #718096; border: 2px solid #4a5568; border-radius: 4px; display: flex; align-items: center; justify-content: space-around; padding: 0 15px; }
    .belt-line { width: 35px; height: 8px; background: #4a5568; border-radius: 2px; }
    .cabinet { position: absolute; border: 3px solid; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95)); display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); }
    .cabinet:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 12px 35px rgba(0, 0, 0, 0.7); }
    .cabinet-icon { font-size: 2.5rem; margin-bottom: 0.5rem; filter: drop-shadow(0 0 10px currentColor); }
    .cabinet-name { font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center; }
    .cabinet-detail { font-size: 0.65rem; color: #94a3b8; margin-top: 0.25rem; }
    .wall-power-cabinet { bottom: 130px; left: 3%; width: 150px; height: 260px; border-color: #8b5cf6; color: #8b5cf6; }
    .wall-power-cabinet:hover { box-shadow: 0 0 30px rgba(139, 92, 246, 0.4), 0 12px 35px rgba(0, 0, 0, 0.7); }
    .power-cabinet { bottom: 130px; left: calc(3% + 170px); width: 150px; height: 260px; border-color: #3b82f6; color: #3b82f6; }
    .power-cabinet:hover { box-shadow: 0 0 30px rgba(59, 130, 246, 0.4), 0 12px 35px rgba(0, 0, 0, 0.7); }
    .motor-control-cabinet { bottom: 130px; left: calc(3% + 340px); width: 150px; height: 260px; border-color: #ec4899; color: #ec4899; }
    .motor-control-cabinet:hover { box-shadow: 0 0 30px rgba(236, 72, 153, 0.4), 0 12px 35px rgba(0, 0, 0, 0.7); }
    .air-cabinet { bottom: 130px; left: calc(3% + 510px); width: 150px; height: 260px; border-color: #10b981; color: #10b981; }
    .air-cabinet:hover { box-shadow: 0 0 30px rgba(16, 185, 129, 0.4), 0 12px 35px rgba(0, 0, 0, 0.7); }
    .feeder { position: absolute; width: 170px; height: 240px; border: 3px solid #f59e0b; color: #f59e0b; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95)); display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5); }
    .feeder:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 0 30px rgba(245, 158, 11, 0.4), 0 12px 35px rgba(0, 0, 0, 0.7); }
    .left-feeder { bottom: 135px; left: calc(3% + 680px); }
    .right-feeder { bottom: 135px; left: calc(3% + 870px); }
    .feeder-icon { font-size: 3rem; margin-bottom: 0.75rem; filter: drop-shadow(0 0 10px currentColor); }
    .feeder-label { font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; text-align: center; margin-bottom: 0.5rem; }
    .power-line { position: absolute; height: 3px; background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.6), transparent); animation: flow 3s linear infinite; pointer-events: none; }
    @keyframes flow { 0% { opacity: 0.3; } 50% { opacity: 0.8; } 100% { opacity: 0.3; } }
    .line-wall-to-power { bottom: 260px; left: calc(3% + 150px); width: 20px; }
    .line-power-to-motor { bottom: 260px; left: calc(3% + 320px); width: 20px; background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.6), transparent); }
    .line-motor-to-feeders { bottom: 260px; left: calc(3% + 490px); width: 20px; background: linear-gradient(90deg, transparent, rgba(236, 72, 153, 0.6), transparent); }
    .instruction-text { width: 100%; max-width: 1200px; text-align: center; padding: 1.5rem; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 0.75rem; font-size: 1rem; color: #94a3b8; margin: 0 auto; }
    .instruction-text strong { color: #3b82f6; }
    
    /* Password Protection Overlay */
    #password-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      animation: fadeIn 0.5s ease;
    }
    #password-overlay.hidden {
      display: none;
    }
    .login-container {
      background: rgba(26, 31, 46, 0.95);
      border: 2px solid rgba(59, 130, 246, 0.3);
      border-radius: 1rem;
      padding: 3rem 2.5rem;
      max-width: 420px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 100px rgba(59, 130, 246, 0.1);
      animation: slideUp 0.6s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .login-header {
      text-align: center;
      margin-bottom: 2rem;
    }
    .login-icon {
      font-size: 3rem;
      color: #3b82f6;
      margin-bottom: 1rem;
      filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.4));
    }
    .login-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #e5e7eb;
      margin-bottom: 0.5rem;
    }
    .login-subtitle {
      font-size: 0.95rem;
      color: #94a3b8;
    }
    .login-form {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .form-label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #cbd5e1;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    .form-input {
      padding: 0.875rem 1rem;
      background: rgba(15, 23, 42, 0.8);
      border: 2px solid rgba(148, 163, 184, 0.3);
      border-radius: 0.5rem;
      color: #e5e7eb;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    .form-input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
    }
    .form-input.error {
      border-color: #ef4444;
      animation: shake 0.4s ease;
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    .error-message {
      color: #ef4444;
      font-size: 0.875rem;
      margin-top: 0.5rem;
      display: none;
    }
    .error-message.visible {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    .login-button {
      padding: 1rem;
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      border: none;
      border-radius: 0.5rem;
      color: white;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: 0.5rem;
    }
    .login-button:hover {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
    }
    .login-button:active {
      transform: translateY(0);
    }
    .login-footer {
      margin-top: 1.5rem;
      text-align: center;
      font-size: 0.85rem;
      color: #64748b;
    }
    .login-footer .lock-icon {
      color: #10b981;
      margin-right: 0.25rem;
    }
    
    /* Logout Button */
    .logout-button {
      display: none; /* Hidden by default, shown when authenticated */
      align-items: center;
      gap: 0.5rem;
      padding: 0.625rem 1.25rem;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      border: 2px solid #ef4444;
      border-radius: 0.5rem;
      color: white;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2);
    }
    .logout-button:hover {
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(239, 68, 68, 0.4);
    }
    .logout-button:active {
      transform: translateY(0);
    }
    .logout-button.visible {
      display: flex;
    }
    .logout-icon {
      font-size: 1.1rem;
    }
    .flow-view { padding: 1.5rem 2rem; overflow-y: auto; }
    .flow-main { background: #1a1f35; border: 1px solid rgba(148, 163, 184, 0.3); border-radius: 1rem; padding: 1.5rem; }
    .flow-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(148, 163, 184, 0.3); }
    .flow-title-section h2 { font-size: 1.3rem; font-weight: 700; margin-bottom: 0.25rem; }
    .flow-title-section p { font-size: 0.85rem; color: #94a3b8; }
    .back-btn { padding: 0.5rem 1rem; background: rgba(148, 163, 184, 0.1); border: 1px solid rgba(148, 163, 184, 0.3); border-radius: 0.5rem; color: #e5e7eb; font-size: 0.85rem; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; gap: 0.5rem; }
    .back-btn:hover { background: rgba(148, 163, 184, 0.2); transform: translateX(-3px); }
    .tab-navigation { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 1.5rem; }
    .tab-btn { padding: 0.75rem; background: rgba(30, 41, 59, 0.95); border: 1px solid rgba(148, 163, 184, 0.3); border-radius: 0.5rem; color: #94a3b8; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 0.5rem; transition: all 0.2s; }
    .tab-btn.active { background: #6366f1; color: white; border-color: #6366f1; }
    .tab-icon { font-size: 1.5rem; }
    .tab-content { display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .section-title { font-size: 1.4rem; font-weight: 700; margin-bottom: 1rem; color: #60a5fa; }
    .info-box { background: rgba(59, 130, 246, 0.1); border-left: 4px solid #3b82f6; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
    .info-box h4 { font-weight: 700; color: #60a5fa; margin-bottom: 0.5rem; }
    .info-box ul { list-style: disc; margin-left: 1.5rem; color: #cbd5e1; line-height: 1.6; }
    .info-box p { color: #cbd5e1; line-height: 1.6; }
    .warning-box { background: rgba(251, 191, 36, 0.1); border-left: 4px solid #fbbf24; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
    .warning-box h4 { font-weight: 700; color: #fbbf24; margin-bottom: 0.5rem; }
    .warning-box p, .warning-box ul { color: #cbd5e1; line-height: 1.6; }
    .danger-box { background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
    .danger-box h4 { font-weight: 700; color: #ef4444; margin-bottom: 0.5rem; }
    .danger-box ul { list-style: disc; margin-left: 1.5rem; color: #cbd5e1; line-height: 1.6; }
    .flow-diagram { background: rgba(15, 23, 42, 0.5); border: 1px solid rgba(148, 163, 184, 0.3); border-radius: 0.75rem; padding: 2rem; margin-bottom: 1.5rem; }
    .flow-stage { display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem; }
    .flow-box { flex: 1; min-width: 200px; padding: 1rem; border-radius: 0.5rem; font-weight: 600; text-align: center; cursor: pointer; transition: all 0.3s; border: 3px solid transparent; }
    .flow-box:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4); }
    .flow-box.selected { border-color: #fbbf24; box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); }
    .flow-box-red { background: #dc2626; color: white; }
    .flow-box-orange { background: #f97316; color: white; }
    .flow-box-blue { background: #2563eb; color: white; }
    .flow-box-purple { background: #7c3aed; color: white; }
    .flow-box-pink { background: #ec4899; color: white; }
    .flow-box .subtitle { font-size: 0.75rem; opacity: 0.9; margin-top: 0.25rem; }
    .flow-arrow { font-size: 2rem; color: #94a3b8; }
    .flow-note { flex: 1; font-size: 0.8rem; color: #94a3b8; background: rgba(148, 163, 184, 0.05); padding: 0.75rem; border-radius: 0.5rem; }
    .split-path { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem; }
    .path-box { padding: 1rem; border-radius: 0.5rem; border: 2px solid; transition: all 0.3s; cursor: pointer; }
    .path-box:hover { transform: translateY(-3px); }
    .path-box.selected { border-width: 3px; box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); }
    .path-box h4 { font-weight: 700; margin-bottom: 0.75rem; }
    .path-blue { border-color: #2563eb; background: rgba(37, 99, 235, 0.05); }
    .path-blue h4 { color: #60a5fa; }
    .path-green { border-color: #16a34a; background: rgba(22, 163, 74, 0.05); }
    .path-green h4 { color: #4ade80; }
    .wire-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
    .wire-box { padding: 0.75rem; border-radius: 0.5rem; border: 2px solid; }
    .wire-box strong { display: block; margin-bottom: 0.5rem; }
    .wire-red { border-color: #dc2626; background: rgba(220, 38, 38, 0.1); }
    .wire-red strong { color: #dc2626; }
    .wire-black { border-color: #1f2937; background: rgba(31, 41, 55, 0.3); }
    .wire-black strong { color: white; }
    .wire-white { border-color: #d1d5db; background: rgba(209, 213, 219, 0.1); }
    .wire-white strong { color: #d1d5db; }
    .wire-green { border-color: #16a34a; background: rgba(22, 163, 74, 0.1); }
    .wire-green strong { color: #4ade80; }
    .wire-copper { border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
    .wire-copper strong { color: #fbbf24; }
    .specs-grid { display: grid; gap: 0.75rem; background: rgba(148, 163, 184, 0.05); padding: 1rem; border-radius: 0.5rem; margin-bottom: 1.5rem; }
    .spec-row { display: flex; justify-content: space-between; gap: 1rem; font-size: 0.85rem; }
    .spec-label { color: #94a3b8; }
    .spec-value { color: #e5e7eb; font-weight: 600; }
    .operation-step { background: rgba(30, 41, 59, 0.95); border: 2px solid rgba(148, 163, 184, 0.3); border-radius: 0.75rem; padding: 1rem; margin-bottom: 1rem; }
    .step-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.5rem; }
    .step-number { background: #6366f1; color: white; width: 2rem; height: 2rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; }
    .step-title { font-weight: 700; }
    .step-content { margin-left: 2.75rem; color: #cbd5e1; line-height: 1.6; }
    .step-content ul { list-style: disc; margin-left: 1.5rem; margin-top: 0.5rem; }
    .footer-warning { background: #1f2937; color: white; padding: 1rem; border-radius: 0.5rem; text-align: center; margin-top: 1.5rem; }
    .footer-warning strong { color: #fbbf24; }
    .power-flow-detail { margin-top: 1.5rem; background: #1a1f35; border: 2px solid #fbbf24; border-radius: 0.75rem; padding: 1.5rem; display: none; }
    .power-flow-detail.active { display: block; animation: slideIn 0.3s; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .power-detail-header { display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 2px solid rgba(251, 191, 36, 0.3); }
    .power-detail-title { font-size: 1.2rem; font-weight: 700; color: #fbbf24; }
    .power-detail-close { background: rgba(239, 68, 68, 0.2); border: 1px solid #ef4444; color: #ef4444; padding: 0.25rem 0.75rem; border-radius: 0.375rem; cursor: pointer; }
    .power-detail-section { margin-bottom: 1rem; }
    .power-detail-section h4 { font-size: 0.95rem; font-weight: 600; color: #60a5fa; margin-bottom: 0.5rem; }
    .power-detail-section p { color: #cbd5e1; line-height: 1.6; }
    .power-detail-section ul { list-style: disc; margin-left: 1.5rem; color: #cbd5e1; line-height: 1.6; }
    .info-icon { display: inline-flex; width: 1.25rem; height: 1.25rem; background: rgba(168, 85, 247, 0.2); border: 1px solid #a855f7; border-radius: 50%; color: #c084fc; font-size: 0.75rem; font-weight: 700; cursor: pointer; margin-left: 0.5rem; align-items: center; justify-content: center; }

    @media (max-width: 768px) {
      .schematic-wrapper { height: 350px; }
      .wall-power-cabinet, .power-cabinet, .motor-control-cabinet { width: 100px; height: 180px; bottom: 100px; }
      .wall-power-cabinet { left: 2%; }
      .power-cabinet { left: calc(2% + 110px); }
      .motor-control-cabinet { left: calc(2% + 220px); }
      .feeder { width: 100px; height: 160px; bottom: 105px; }
      .left-feeder { left: calc(2% + 330px); }
      .right-feeder { left: calc(2% + 440px); }
      .cabinet-icon, .feeder-icon { font-size: 2rem; }
      .tab-navigation { grid-template-columns: repeat(2, 1fr); }
      .split-path { grid-template-columns: 1fr; }
    }
  
    /* ========================================
   ADDITIONAL CSS FOR ENHANCED POWER DISTRIBUTION
   Add this to your existing <style> section
   ======================================== */

/* Operation Sequence Styling */
.operation-sequence {
  background: rgba(99, 102, 241, 0.1);
  border: 1px solid rgba(99, 102, 241, 0.3);
  border-radius: 0.75rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
}

.operation-sequence h4 {
  color: #818cf8;
  font-size: 1.1rem;
  margin-bottom: 1rem;
}

.operation-step {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
  padding: 0.75rem;
  background: rgba(30, 41, 59, 0.5);
  border-radius: 0.5rem;
}

.step-number {
  flex-shrink: 0;
  width: 32px;
  height: 32px;
  background: #6366f1;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 0.95rem;
}

.step-content {
  flex: 1;
  color: #cbd5e1;
  line-height: 1.6;
}

.step-content strong {
  color: #e5e7eb;
}

.step-content ul {
  margin-top: 0.5rem;
}

/* Terminal Block Styling */
.terminal-block {
  background: rgba(168, 85, 247, 0.1);
  border: 1px solid rgba(168, 85, 247, 0.3);
  border-radius: 0.5rem;
  padding: 1rem;
  margin-bottom: 1rem;
}

.terminal-block h4 {
  color: #c084fc;
  margin-bottom: 0.5rem;
  font-size: 1rem;
}

.terminal-block h5 {
  color: #c084fc;
  margin-bottom: 0.5rem;
  font-size: 0.95rem;
  font-weight: 600;
}

.terminal-block ul {
  list-style: disc;
  margin-left: 1.5rem;
  color: #cbd5e1;
  line-height: 1.6;
}

.terminal-block p {
  color: #cbd5e1;
  line-height: 1.6;
}

/* Component Cards (for Overview tab if needed) */
.component-card {
  background: rgba(30, 41, 59, 0.7);
  border: 1px solid rgba(148, 163, 184, 0.3);
  border-radius: 0.75rem;
  padding: 1rem;
  transition: all 0.3s;
}

.component-card:hover {
  border-color: #60a5fa;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.component-card h4 {
  color: #60a5fa;
  font-size: 1rem;
  margin-bottom: 0.75rem;
}

.component-card p {
  color: #cbd5e1;
  font-size: 0.85rem;
  line-height: 1.5;
}

/* Note Callout */
.note-callout {
  background: rgba(236, 72, 153, 0.1);
  border: 1px solid rgba(236, 72, 153, 0.3);
  border-radius: 0.5rem;
  padding: 1rem;
  margin-top: 1rem;
  font-size: 0.9rem;
  color: #cbd5e1;
  line-height: 1.6;
}

.note-callout strong {
  color: #ec4899;
}

/* Enhanced Info Box for nested content */
.info-box h5 {
  color: #60a5fa;
  font-size: 0.95rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.info-box ol {
  list-style: decimal;
  margin-left: 1.5rem;
  color: #cbd5e1;
  line-height: 1.8;
}

/* Component Detail Panel (if using clickable components) */
.component-detail {
  display: none;
  background: rgba(30, 41, 59, 0.95);
  border: 2px solid #fbbf24;
  border-radius: 0.75rem;
  padding: 1.5rem;
  margin-top: 1.5rem;
  animation: slideDown 0.3s ease;
}

.component-detail.active {
  display: block;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.component-detail-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid rgba(251, 191, 36, 0.3);
}

.component-detail-header h3 {
  color: #fbbf24;
  font-size: 1.2rem;
}

/* Mobile responsiveness for new components */
@media (max-width: 768px) {
  .operation-step {
    flex-direction: row;
    align-items: flex-start;
  }
  
  .step-number {
    margin-top: 0.25rem;
  }
  
  .terminal-block h5 {
    font-size: 0.9rem;
  }
}

      /* Side Panel Styles */
      .component-side-panel {
        position: fixed;
        right: -600px;
        top: 0;
        width: 600px;
        max-width: 90vw;
        height: 100vh;
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        box-shadow: -5px 0 30px rgba(0,0,0,0.5);
        z-index: 10000;
        transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        overflow-y: auto;
        border-left: 3px solid #3b82f6;
      }
      .component-side-panel.active {right: 0;}
      .side-panel-header {
        position: sticky;
        top: 0;
        background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
        padding: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #3b82f6;
        z-index: 10;
      }
      .side-panel-header h3 {margin: 0;color: #fff;font-size: 1.5rem;font-weight: 700;}
      .panel-close-btn {
        background: rgba(255,255,255,0.1);
        border: 2px solid rgba(255,255,255,0.3);
        color: #fff;
        font-size: 1.5rem;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .panel-close-btn:hover {
        background: rgba(239,68,68,0.8);
        border-color: #ef4444;
        transform: rotate(90deg);
      }
      .side-panel-content {padding: 2rem;color: #cbd5e1;line-height: 1.6;}
      .panel-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.7);
        z-index: 9999;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
      }
      .panel-overlay.active {opacity: 1;pointer-events: auto;}
      .clickable-component {cursor: pointer;transition: all 0.3s ease;position: relative;}
      .clickable-component::after {
        content: "‚ÑπÔ∏è";
        position: absolute;
        top: 5px;
        right: 5px;
        font-size: 0.9rem;
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .clickable-component:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
      }
      .clickable-component:hover::after {opacity: 1;}
      .flow-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        background: rgba(30, 41, 59, 0.3);
        border-radius: 1rem;
        border: 1px solid rgba(148, 163, 184, 0.2);
      }
      @media (max-width: 768px) {
        .component-side-panel {width: 100%;right: -100%;}
        .flow-stage {flex-direction: column !important;}
        .flow-arrow {transform: rotate(90deg);margin: 0.5rem 0;}
      }

      /* Flow box background colors */
      .flow-box-red {
        background: linear-gradient(135deg, rgba(220, 38, 38, 0.3), rgba(185, 28, 28, 0.25)) !important;
        border: 2px solid #dc2626 !important;
      }
      
      .flow-box-orange {
        background: linear-gradient(135deg, rgba(249, 115, 22, 0.3), rgba(234, 88, 12, 0.25)) !important;
        border: 2px solid #f97316 !important;
      }
      
      .flow-box-yellow {
        background: linear-gradient(135deg, rgba(234, 179, 8, 0.3), rgba(202, 138, 4, 0.25)) !important;
        border: 2px solid #eab308 !important;
      }
      
      .flow-box-green {
        background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(22, 163, 74, 0.25)) !important;
        border: 2px solid #22c55e !important;
      }
      
      .flow-box-purple {
        background: linear-gradient(135deg, rgba(168, 85, 247, 0.3), rgba(147, 51, 234, 0.25)) !important;
        border: 2px solid #a855f7 !important;
      }
      
      .flow-box-cyan {
        background: linear-gradient(135deg, rgba(6, 182, 212, 0.3), rgba(8, 145, 178, 0.25)) !important;
        border: 3px solid #06b6d4 !important;
      }
      
      .flow-box-blue {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.3), rgba(37, 99, 235, 0.25)) !important;
        border: 2px solid #3b82f6 !important;
      }
</style>
</head>
<body>
  <!-- Password Protection Overlay -->
  <div id="password-overlay">
    <div class="login-container">
      <div class="login-header">
        <div class="login-icon">üîí</div>
        <h2 class="login-title">LaunchPad Access</h2>
        <p class="login-subtitle">Secure System Documentation</p>
      </div>
      
      <form class="login-form" id="loginForm" onsubmit="return false;">
        <div class="form-group">
          <label class="form-label" for="username">Username</label>
          <input 
            type="text" 
            id="username" 
            class="form-input" 
            placeholder="Enter your username"
            autocomplete="username"
            required
          />
        </div>
        
        <div class="form-group">
          <label class="form-label" for="password">Password</label>
          <input 
            type="password" 
            id="password" 
            class="form-input" 
            placeholder="Enter your password"
            autocomplete="current-password"
            required
          />
        </div>
        
        <div class="error-message" id="errorMessage">
          ‚ùå Invalid username or password. Please try again.
        </div>
        
        <button type="submit" class="login-button" onclick="validateLogin()">
          Access System
        </button>
      </form>
      
      <div class="login-footer">
        <span class="lock-icon">üîê</span>
        Authorized Personnel Only
      </div>
    </div>
  </div>

  <header>
    <div class="header-title">
      <h1>LaunchPad System Schematic</h1>
      <p id="headerSubtitle">Click on any cabinet to view its detailed flow diagram</p>
    </div>
    <div style="display: flex; align-items: center; gap: 1rem;">
      <div class="header-status">
        <div class="status-dot"></div>
        <span>All Systems Operational</span>
      </div>
      <button id="logoutButton" class="logout-button" onclick="manualLogout()">
        <span class="logout-icon">üö™</span>
        <span>Logout</span>
      </button>
    </div>
  </header>

  <div class="view-container">
    <div class="view schematic-view active" id="schematicView">
      <div class="schematic-container">
        <div class="schematic-wrapper">
          <div class="conveyor">
            <div class="conveyor-belt">
              <div class="belt-line"></div>
              <div class="belt-line"></div>
              <div class="belt-line"></div>
              <div class="belt-line"></div>
              <div class="belt-line"></div>
              <div class="belt-line"></div>
              <div class="belt-line"></div>
            </div>
          </div>

          <div class="power-line line-wall-to-power"></div>
          <div class="power-line line-power-to-motor"></div>
          <div class="power-line line-motor-to-feeders"></div>

          <div class="cabinet wall-power-cabinet" data-system="wall-power">
            <div class="cabinet-icon">üîå</div>
            <div class="cabinet-name">Wall Power</div>
            <div class="cabinet-detail">200-240V AC</div>
          </div>

          <div class="cabinet power-cabinet" data-system="power">
            <div class="cabinet-icon">‚ö°</div>
            <div class="cabinet-name">Power Dist.</div>
            <div class="cabinet-detail">Main Cabinet</div>
          </div>

          <div class="cabinet motor-control-cabinet" data-system="motor-control">
            <div class="cabinet-icon">üéõÔ∏è</div>
            <div class="cabinet-name">Motor Control</div>
            <div class="cabinet-detail">X/Y/Z Drivers</div>
          </div>

          <div class="cabinet air-cabinet" data-system="air-distribution">
            <div class="cabinet-icon">üí®</div>
            <div class="cabinet-name">Air Distribution</div>
            <div class="cabinet-detail">Pneumatic Control</div>
          </div>

          <div class="feeder left-feeder" data-system="left-feeder">
            <div class="feeder-icon">‚öôÔ∏è</div>
            <div class="feeder-label">Left Feeder</div>
          </div>

          <div class="feeder right-feeder" data-system="right-feeder">
            <div class="feeder-icon">‚öôÔ∏è</div>
            <div class="feeder-label">Right Feeder</div>
          </div>
        </div>
      </div>

      <div class="instruction-text">
        <strong>Click on any cabinet</strong> to view its detailed system flow diagram
      </div>
    </div>

    <div class="view flow-view" id="flowView">
      <div class="flow-main">
        <div class="flow-header">
          <div class="flow-title-section">
            <h2 id="flowViewTitle">System Flow Diagram</h2>
            <p id="flowViewSubtitle">Detailed system analysis</p>
          </div>
          <button class="back-btn" id="backBtn">
            <span>‚Üê</span>
            <span>Back to Overview</span>
          </button>
        </div>
        <div id="flowContent"></div>
      </div>
    </div>
  </div>

  <script>
    const DATA = {
      'wall-power': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">‚ö°</span>Power Flow</button>
            <button class="tab-btn" data-tab="technical"><span class="tab-icon">üîß</span>Technical</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">240V Power Distribution System</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Single-phase 200-240V AC power distribution system supplying a Mitsubishi MR-JE-200C conveyor driver and 120V power distribution to nine branch circuits including feeder controls, cabinet systems, and auxiliary equipment.</p>
            
            <div class="info-box">
              <h4>Key Components:</h4>
              <ul>
                <li><strong>Wall Power Outlet:</strong> 200-240V split-phase service entrance</li>
                <li><strong>240V Power Switch:</strong> Main disconnect/safety switch</li>
                <li><strong>Mitsubishi MR-JE-200C:</strong> Conveyor driver for motor control</li>
                <li><strong>120V Distribution:</strong> 9 branch circuits (Feeders, Cabinets, Controls, Computer, Aux)</li>
              </ul>
            </div>
            
            <div class="warning-box">
              <h4>‚ö†Ô∏è Safety Note:</h4>
              <p>HIGH VOLTAGE system (200-240VAC). 10 AWG for 240V high-power lines and 14-22 AWG for 120V and control circuits. Only qualified electricians should work on this system.</p>
            </div>
          </div>
          
          <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Voltage Flow Through System</h3>
            <p style="color:#94a3b8;text-align:center;margin-bottom:1rem;">üí° <strong style="color:#fbbf24;">Click on any colored box</strong> for details</p>
            
            <div class="flow-diagram">
              <div class="flow-stage">
                <div class="flow-box flow-box-red" data-power-component="wall-power">
                  WALL POWER
                  <div class="subtitle">200-240V Split-Phase</div>
                </div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-note">10 AWG Wires<br>Red (L1), Black (L2)<br>White (N), Green (GND)</div>
              </div>
              
              <div style="text-align:center;font-size:2rem;color:#94a3b8;margin:1rem 0;">‚Üì</div>
              
              <div class="flow-stage">
                <div class="flow-box flow-box-orange" data-power-component="power-switch">
                  240V POWER SWITCH
                  <div class="subtitle">Main Disconnect</div>
                </div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-note">Safety shutoff<br>Controls both hot legs</div>
              </div>
              
              <div style="text-align:center;font-size:1.5rem;color:#94a3b8;margin:1rem 0;">‚Üì Split Path</div>
              
              <div class="split-path">
                <div class="path-box path-blue" data-power-component="servo-drive">
                  <h4>MITSUBISHI MR-JE-200C<br>Conveyor Driver</h4>
                  <p style="margin-top:0.75rem;text-align:center;font-weight:600;color:#60a5fa;">Powers Conveyor Motor</p>
                </div>
                <div class="path-box path-green" data-power-component="outlet-120v">
                  <h4>120V POWER DISTRIBUTION</h4>
                  <p style="margin-top:0.75rem;text-align:center;font-weight:600;color:#4ade80;">Feeds 9 Branch Circuits</p>
                  <p style="margin-top:0.5rem;font-size:0.75rem;color:#94a3b8;line-height:1.4;">Feeders (Almond/Clay/White) ‚Ä¢ Cabinets (L/R) ‚Ä¢ Controls (L/R) ‚Ä¢ Computer ‚Ä¢ Aux</p>
                </div>
              </div>
            </div>
            
            <div class="power-flow-detail" id="powerFlowDetail">
              <div class="power-detail-header">
                <h3 class="power-detail-title" id="powerDetailTitle">Component</h3>
                <button class="power-detail-close" id="powerDetailClose">‚úï Close</button>
              </div>
              <div id="powerDetailContent"></div>
            </div>
            
            <div class="info-box" style="background:rgba(168,85,247,0.1);border-left-color:#a855f7;">
              <h4 style="color:#c084fc;">Understanding Split-Phase 200-240V:<span class="info-icon" id="splitPhaseInfo">!</span></h4>
              <ul>
                <li><strong>L1 to Neutral:</strong> 120VAC</li>
                <li><strong>L2 to Neutral:</strong> 120VAC</li>
                <li><strong>L1 to L2:</strong> 240VAC (high-power)</li>
              </ul>
            </div>
          </div>
          
          <div class="tab-content" id="tab-technical">
            <h3 class="section-title">Technical Specifications</h3>
            
            <h4 style="font-weight:700;margin-bottom:1rem;color:#cbd5e1;">Wire Specifications (All 10 AWG):</h4>
            <div class="wire-grid">
              <div class="wire-box wire-red"><strong>Red Wire:</strong><p>Hot Line 1 (L1) - 120V to neutral, part of 240V</p></div>
              <div class="wire-box wire-black"><strong>Black Wire:</strong><p>Hot Line 2 (L2) - 120V to neutral, part of 240V</p></div>
              <div class="wire-box wire-white"><strong>White Wire:</strong><p>Neutral - Common return path for 120V circuits</p></div>
              <div class="wire-box wire-green"><strong>Green Wire:</strong><p>Ground - Equipment safety ground (0V)</p></div>
              <div class="wire-box wire-copper"><strong>Bare Copper:</strong><p>Additional ground connection</p></div>
            </div>
            
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;">200-240V Power Outlet:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Supply Voltage:</span><span class="spec-value">200-240 VAC split-phase</span></div>
                            <div class="spec-row"><span class="spec-label">Line 1 (L1):</span><span class="spec-value">Red wire - 120V to neutral, 240V to L2</span></div>
              <div class="spec-row"><span class="spec-label">Line 2 (L2):</span><span class="spec-value">Black wire - 120V to neutral, 240V to L1</span></div>
              <div class="spec-row"><span class="spec-label">Neutral (N):</span><span class="spec-value">White wire - Common return path</span></div>
              <div class="spec-row"><span class="spec-label">Ground (GND):</span><span class="spec-value">Green wire + bare copper</span></div>
              <div class="spec-row"><span class="spec-label">Wire Gauge:</span><span class="spec-value">10 AWG all conductors</span></div>
            </div>
            <p style="color:#cbd5e1;line-height:1.6;margin-top:1rem;"><strong>Function:</strong> Primary electrical service entrance point providing 200-240V split-phase power to the entire system.</p>
            
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;">240V Main Power Switch:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Voltage Rating:</span><span class="spec-value">240 VAC</span></div>
              <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Main disconnect - breaks both L1 and L2 simultaneously</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">L1, L2, N, GND from wall power</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">L1, L2, N, GND to downstream equipment</span></div>
            </div>
            <p style="color:#cbd5e1;line-height:1.6;margin-top:1rem;"><strong>Function:</strong> Critical safety device providing single control point to de-energize entire system.</p>
            
            <div class="danger-box" style="margin-top:1.5rem;">
              <h4>Safety Features:</h4>
              <ul>
                <li>240V Power Switch for complete system disconnection</li>
                <li>10 AWG wiring rated for main service</li>
                <li>14-16 AWG branch circuits with individual breakers</li>
                <li>Dual ground paths for redundancy</li>
                <li>Isolated circuits prevent cascade failures</li>
              </ul>

            </div>
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;">Mitsubishi MR-JE-200C Conveyor Driver:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Mitsubishi MR-JE-200C</span></div>
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">AC Servo Drive</span></div>
              <div class="spec-row"><span class="spec-label">Power Input:</span><span class="spec-value">200-240V AC (L1, L2, L3)</span></div>
              <div class="spec-row"><span class="spec-label">Motor Outputs:</span><span class="spec-value">U, V, W (3-phase to conveyor motor)</span></div>
              <div class="spec-row"><span class="spec-label">Control Terminals:</span><span class="spec-value">C, D (control signals)</span></div>
              <div class="spec-row"><span class="spec-label">DC Bus:</span><span class="spec-value">P+ (DC link connection)</span></div>
              <div class="spec-row"><span class="spec-label">Ground:</span><span class="spec-value">GND terminal for motor ground</span></div>
              <div class="spec-row"><span class="spec-label">Wire Gauge:</span><span class="spec-value">10 AWG for power connections</span></div>
            </div>
            <p style="color:#cbd5e1;line-height:1.6;margin-top:1rem;"><strong>Function:</strong> Controls conveyor motor speed and position using servo control technology. Receives 240V power and provides variable-frequency drive to 3-phase motor.</p>
            
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;">120V Power Distribution Panel:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V derived from L1 or L2 to Neutral</span></div>
              <div class="spec-row"><span class="spec-label">Number of Circuits:</span><span class="spec-value">9 branch circuits</span></div>
              <div class="spec-row"><span class="spec-label">Wire Gauge:</span><span class="spec-value">14-22 AWG depending on load</span></div>
            </div>
            
            <div style="margin-top:1rem;">
              <h5 style="color:#60a5fa;margin-bottom:0.5rem;">Branch Circuit Distribution:</h5>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Feeder Circuits:</span><span class="spec-value">Left Feeder, Right Feeder control power</span></div>
                <div class="spec-row"><span class="spec-label">Cabinet Circuits:</span><span class="spec-value">Power Distribution Cabinet, Motor Control Cabinet</span></div>
                <div class="spec-row"><span class="spec-label">Control Circuit:</span><span class="spec-value">Main control system power</span></div>
                <div class="spec-row"><span class="spec-label">Computer Circuit:</span><span class="spec-value">PC/HMI interface power</span></div>
                <div class="spec-row"><span class="spec-label">Auxiliary Circuits:</span><span class="spec-value">Lighting, accessories, spare capacity</span></div>
              </div>
            </div>
            <p style="color:#cbd5e1;line-height:1.6;margin-top:1rem;"><strong>Function:</strong> Distributes 120V AC power to nine separate systems throughout the machine. Each circuit is independently fused/breakered for safety and isolation.</p>

          </div>
          
          <div class="tab-content" id="tab-operation">
            <h3 class="section-title">System Operation</h3>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Power Input from Wall</div>
              </div>
              <div class="step-content">
                Standard North American 200-240V split-phase power enters through the outlet. Two "hot" legs (L1 and L2) at 120V each relative to neutral, and 240V between them.
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Main Power Switch Control</div>
              </div>
              <div class="step-content">
                240V power switch acts as main disconnect. When OFF, breaks both hot legs simultaneously, ensuring complete power isolation critical for safety.
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Power Distribution Split</div>
              </div>
              <div class="step-content">
                Power splits two ways: (1) Full 240V to Mitsubishi MR-JE-200C conveyor driver for high-power motor control, (2) 120V distribution to 9 branch circuits for feeders, cabinets, controls, computer, and auxiliary equipment.
              </div>
            </div>
          </div>
                `
      },
      'power': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">‚ö°</span>Flow Diagram</button>
            <button class="tab-btn" data-tab="technical"><span class="tab-icon">üîß</span>Technical</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">Power Distribution Cabinet</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Central power distribution cabinet housing all primary electrical protection devices, safety relay system, and DC power supplies. This cabinet receives power from the wall supply and conditions it for use throughout the machine.</p>
            
            <div class="info-box">
              <h4>Key Components:</h4>
              <ul>
                <li><strong>RCD + Main Breaker:</strong> Doepke G16 and Nader NDB1L-32 breaker for protection</li>
                <li><strong>Safety Relay:</strong> DOLD D-78120 safety relay monitoring E-stops and light curtains</li>
                <li><strong>48V PSU:</strong> Mean Well SDR-480-48 </li>
                <li><strong>24V PSU:</strong> Mean Well NDR-240-24 for valves & logic </li>
                <li><strong>12V/5V PSU:</strong> Mean Well NDR-120-12  and 5V supply </li>
              </ul>
            </div>
            
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Input Power:</span><span class="spec-value">120-240 VAC from wall</span></div>
              <div class="spec-row"><span class="spec-label">Main Protection:</span><span class="spec-value">Doepke G16 + Nader NDB1L-32</span></div>
              <div class="spec-row"><span class="spec-label">Safety System:</span><span class="spec-value">DOLD D-78120 safety relay</span></div>
              <div class="spec-row"><span class="spec-label">DC Outputs:</span><span class="spec-value">48V, 24V, 12V, 5V</span></div>
            </div>
          </div>
          
          <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Power Distribution Flow</h3>
            <p style="color:#94a3b8;text-align:center;margin-bottom:1.5rem;">üí° <strong style="color:#fbbf24;">Click on any colored box</strong> for detailed component information</p>
            
            <div class="flow-diagram">
              <!-- STAGE 1: AC INPUT -->
              <div style="text-align:center;margin-bottom:1rem;">
                <div style="display:inline-block;padding:0.5rem 1rem;background:rgba(239,68,68,0.2);border-radius:0.5rem;border:2px solid #ef4444;">
                  <strong style="color:#ef4444;font-size:1.1rem;">‚ö° STAGE 1: AC INPUT</strong>
                </div>
              </div>
              
              <div style="display:flex;justify-content:center;margin-bottom:1rem;">
                <div class="flow-box flow-box-red" data-power-component="ac-input" style="min-width:300px;">
                  <div style="font-size:1.5rem;margin-bottom:0.25rem;">üîå</div>
                  WALL AC INPUT
                  <div class="subtitle">200-240V AC</div>
                  <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">From wall outlet</div>
                </div>
              </div>
              
              <div style="text-align:center;margin:1.5rem 0;">
                <div style="display:inline-block;color:#60a5fa;font-size:2rem;">‚Üì</div>
                <div style="color:#94a3b8;font-size:0.85rem;margin-top:0.25rem;">Wires: Red (L1), Black (L2), White (N), Green (GND)</div>
              </div>
              
              <!-- STAGE 2: PROTECTION -->
              <div style="text-align:center;margin-bottom:1rem;">
                <div style="display:inline-block;padding:0.5rem 1rem;background:rgba(251,146,60,0.2);border-radius:0.5rem;border:2px solid #fb923c;">
                  <strong style="color:#fb923c;font-size:1.1rem;">üõ°Ô∏è STAGE 2: PROTECTION LAYER</strong>
                </div>
              </div>
              
              <div style="display:flex;justify-content:center;gap:2rem;margin-bottom:1rem;flex-wrap:wrap;">
                <div style="text-align:center;">
                  <div class="flow-box flow-box-orange" data-power-component="breaker" style="min-width:200px;">
                    <div style="font-size:1.3rem;margin-bottom:0.25rem;">‚ö°</div>
                    NADER BREAKER
                    <div class="subtitle">NDB1L-32</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">Overcurrent</div>
                  </div>
                </div>
                
                <div style="text-align:center;">
                  <div class="flow-box flow-box-orange" data-power-component="rcd" style="min-width:200px;">
                    <div style="font-size:1.3rem;margin-bottom:0.25rem;">üîç</div>
                    DOEPKE G16
                    <div class="subtitle">RCD</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">Ground Fault Detection</div>
                  </div>
                </div>
              </div>
              
              <div style="text-align:center;margin:1.5rem 0;">
                <div style="display:inline-block;color:#60a5fa;font-size:2rem;">‚Üì</div>
                <div style="color:#94a3b8;font-size:0.85rem;margin-top:0.25rem;">Protected AC power</div>
              </div>
              
              <!-- STAGE 3: SAFETY CONTROL -->
              <div style="text-align:center;margin-bottom:1rem;">
                <div style="display:inline-block;padding:0.5rem 1rem;background:rgba(168,85,247,0.2);border-radius:0.5rem;border:2px solid #a855f7;">
                  <strong style="color:#a855f7;font-size:1.1rem;">üîê STAGE 3: SAFETY CONTROL</strong>
                </div>
              </div>
              
              <div style="display:flex;justify-content:center;gap:2rem;margin-bottom:1rem;flex-wrap:wrap;">
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#a855f7;color:white;min-width:200px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="safety-relay" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.3rem;margin-bottom:0.25rem;">üõ°Ô∏è</div>
                    DOLD SAFETY RELAY
                    <div class="subtitle">D-78120</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">Monitors E-stops</div>
                  </div>
                  <div style="color:#94a3b8;font-size:0.75rem;margin-top:0.5rem;">Controls ‚Üì</div>
                </div>
                
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#a855f7;color:white;min-width:200px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="finder-contactor" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.3rem;margin-bottom:0.25rem;">üîå</div>
                    FINDER CONTACTOR
                    <div class="subtitle">22.32.0120</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">AC Power Switch</div>
                  </div>
                </div>
              </div>
              
              <div style="text-align:center;margin:1.5rem 0;">
                <div style="display:inline-block;color:#60a5fa;font-size:2rem;">‚Üì</div>
                <div style="color:#94a3b8;font-size:0.85rem;margin-top:0.25rem;">Safety-approved AC power</div>
              </div>
              
              <!-- STAGE 4: AC DISTRIBUTION -->
              <div style="text-align:center;margin-bottom:1rem;">
                <div style="display:inline-block;padding:0.5rem 1rem;background:rgba(234,179,8,0.2);border-radius:0.5rem;border:2px solid #eab308;">
                  <strong style="color:#eab308;font-size:1.1rem;">üìä STAGE 4: POWER SUPPLIES</strong>
                </div>
              </div>
              
              <div style="display:flex;justify-content:center;margin-bottom:1rem;">
                <div class="flow-box" style="background:#eab308;color:#1e293b;min-width:300px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;font-weight:600;" data-power-component="ukk-terminals" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                  <div style="font-size:1.3rem;margin-bottom:0.25rem;">üîó</div>
                  UKK80 TERMINAL BLOCKS
                  <div class="subtitle">LINE + NEUTRAL Buses</div>
                  <div style="font-size:0.75rem;opacity:0.8;margin-top:0.25rem;">Distributes AC to all loads</div>
                </div>
              </div>
              
              <div style="text-align:center;margin:1.5rem 0;">
                <div style="display:inline-block;color:#60a5fa;font-size:1.5rem;">‚Üì ‚Üì ‚Üì</div>
                <div style="color:#94a3b8;font-size:0.85rem;margin-top:0.25rem;">Split to four power supplies</div>
              </div>
              
              <!-- Power Supply Boxes -->
              <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1.5rem;max-width:900px;margin:2rem auto;">
                
                <!-- 48V Supply -->
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#3b82f6;color:white;min-width:180px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="psu-48v" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.2rem;margin-bottom:0.25rem;">üì¶</div>
                    SDR-480-48
                    <div class="subtitle">48V</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">PSU</div>
                  </div>
                </div>
                
                <!-- 24V Supply -->
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#3b82f6;color:white;min-width:180px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="psu-24v" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.2rem;margin-bottom:0.25rem;">üì¶</div>
                    NDR-240-24
                    <div class="subtitle">24V</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">PSU</div>
                  </div>
                </div>
                
                <!-- 12V Supply -->
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#3b82f6;color:white;min-width:180px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="psu-12v" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.2rem;margin-bottom:0.25rem;">üì¶</div>
                    NDR-120-12
                    <div class="subtitle">12V</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">PSU</div>
                  </div>
                </div>
                
                <!-- 5V Supply -->
                <div style="text-align:center;">
                  <div class="flow-box" style="background:#3b82f6;color:white;min-width:180px;cursor:pointer;border:3px solid transparent;transition:all 0.3s;" data-power-component="psu-5v" onmouseover="this.style.borderColor='#fbbf24'" onmouseout="if(!this.classList.contains('selected'))this.style.borderColor='transparent'">
                    <div style="font-size:1.2rem;margin-bottom:0.25rem;">üì¶</div>
                    5V SUPPLY
                    <div class="subtitle">5V</div>
                    <div style="font-size:0.75rem;color:rgba(255,255,255,0.7);margin-top:0.25rem;">PSU</div>
                  </div>
                </div>
                
              </div>

              <!-- System Ready -->
              <div style="text-align:center;margin-top:2rem;padding:1rem;background:rgba(34,197,94,0.1);border-radius:0.5rem;border:2px solid #22c55e;">
                <div style="font-size:1.5rem;margin-bottom:0.5rem;">‚úÖ</div>
                <div style="color:#22c55e;font-weight:700;font-size:1.2rem;">POWER SUPPLIES READY</div>
                <div style="color:#94a3b8;font-size:0.9rem;margin-top:0.25rem;">DC voltages available: 48V, 24V, 12V, 5V</div>
              </div>
            </div>

            <div class="info-box" style="margin-top:2rem;">
              <h4>üîç Power Flow Summary:</h4>
              <ul style="color:#cbd5e1;line-height:1.8;">
                <li><strong>Stage 1-2:</strong> AC power enters and passes through protection (Nader breaker + Doepke G16)</li>
                <li><strong>Stage 3:</strong> Safety control (DOLD monitors E-stops, Finder switches power)</li>
                <li><strong>Stage 4:</strong> UKK80 terminals distribute AC to four power supplies (48V, 24V, 12V, 5V)</li>
                <li><strong>Safety:</strong> Any E-stop ‚Üí DOLD drops ‚Üí Finder opens ‚Üí Instant power cutoff</li>
              </ul>
            </div>
          </div>
          
          <div class="tab-content" id="tab-technical">
  <h3 class="section-title">Component Specifications</h3>
  
  <div class="info-box">
    <h4>Nader NDB1L-32 Breaker</h4>
    <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Primary overcurrent, overvoltage, and leakage protection for AC input.</p>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Circuit Breaker</span></div>
      <div class="spec-row"><span class="spec-label">Voltage Rating:</span><span class="spec-value">200-240V AC</span></div>
      <div class="spec-row"><span class="spec-label">Trip Characteristics:</span><span class="spec-value">Electrical fault protection</span></div>
      
    </div>
    <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Operation:</strong> If breaker detects abnormal conditions, it trips and stops power flow. Must be manually reset after fault is cleared.</p>
  </div>
  
  <div class="info-box">
    <h4>Doepke G16 </h4>
    <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Provides electrical protection for the system.</p>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">2-pole Protection Device</span></div>
      <div class="spec-row"><span class="spec-label">Monitoring:</span><span class="spec-value">Electrical system</span></div>
    </div>
    <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Operation:</strong> Monitors electrical system and trips on fault conditions to protect equipment and personnel.</p>
  </div>
  
  <div class="info-box">
    <h4>DOLD D-78120 Safety Relay</h4>
    <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Monitors safety devices (E-stops, light curtains) and controls power enable through Finder contactor.</p>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DOLD D-78120 (LG 5925 series)</span></div>
      <div class="spec-row"><span class="spec-label">Supply Voltage:</span><span class="spec-value">24V DC</span></div>
      <div class="spec-row"><span class="spec-label">Safety Contacts:</span><span class="spec-value">K1, K2 dual channel redundancy</span></div>
      
      <div class="spec-row"><span class="spec-label">Output Contacts:</span><span class="spec-value">23-24, 33-34 (drives Finder coil)</span></div>
    </div>
  </div>
  
  <div class="operation-sequence">
    <h4>üîÑ DOLD Safety Relay Operation Sequence:</h4>
    <div class="operation-step">
      <div class="step-number">1</div>
      <div class="step-content">DOLD powers on and performs self-test</div>
    </div>
    <div class="operation-step">
      <div class="step-number">2</div>
      <div class="step-content">Checks S11 ‚Üí S12 and S11 ‚Üí S22 safety circuit continuity</div>
    </div>
    <div class="operation-step">
      <div class="step-number">3</div>
      <div class="step-content">Checks S21 for cross faults</div>
    </div>
    <div class="operation-step">
      <div class="step-number">4</div>
      <div class="step-content">Operator presses reset button</div>
    </div>
    <div class="operation-step">
      <div class="step-number">5</div>
      <div class="step-content">K1 and K2 internal relays energize</div>
    </div>
    <div class="operation-step">
      <div class="step-number">6</div>
      <div class="step-content">Contacts 23-24 and 33-34 close (redundant outputs)</div>
    </div>
    <div class="operation-step">
      <div class="step-number">7</div>
      <div class="step-content">Finder relay coil powers up</div>
    </div>
    <div class="operation-step">
      <div class="step-number">8</div>
      <div class="step-content">Finder closes AC power contacts</div>
    </div>
    <div class="operation-step">
      <div class="step-number">9</div>
      <div class="step-content">Machine receives power and operates normally</div>
    </div>
  </div>
  
  <div class="danger-box">
    <h4>‚ö†Ô∏è Safety Event Response:</h4>
    <p>Any safety event (E-stop pressed or light curtain broken) ‚Üí S12/S22 contacts open ‚Üí DOLD drops K1/K2 ‚Üí Finder relay de-energizes ‚Üí Machine loses power instantly.</p>
    <p style="margin-top:0.5rem;"><strong>Note:</strong> S24 and S34 are paralleled for redundancy and safety of the safety loop.</p>
  </div>
  
  <div class="info-box">
    <h4>Finder 22.32.0120.1340 Contactor</h4>
    <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Electrically controlled AC power switch that enables/disables system power based on DOLD safety relay signal.</p>
    
    <div style="margin-top:1rem;margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">A) Coil Circuit (Control Side):</h5>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Terminals:</span><span class="spec-value">A1 and A2</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Low-power signal creates magnetic field</span></div>
        <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">Controlled by DOLD safety relay outputs (23-24, 33-34)</span></div>
        <div class="spec-row"><span class="spec-label">A1 Connection:</span><span class="spec-value">Safety output from DOLD</span></div>
        <div class="spec-row"><span class="spec-label">A2 Connection:</span><span class="spec-value">Neutral</span></div>
      </div>
      <p style="margin-top:0.5rem;color:#94a3b8;"><strong>Purpose:</strong> Decides whether the contactor should turn on.</p>
    </div>
    
    <div style="margin-top:1rem;margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">B) Power Circuit (Load Side):</h5>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Terminals:</span><span class="spec-value">1‚Üí3 and 2‚Üí4</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Carry AC mains power</span></div>
        <div class="spec-row"><span class="spec-label">Coil OFF:</span><span class="spec-value">Both switches OPEN (no power flow)</span></div>
        <div class="spec-row"><span class="spec-label">Coil ON:</span><span class="spec-value">Both switches CLOSE (power flows to loads)</span></div>
        <div class="spec-row"><span class="spec-label">Power Flow:</span><span class="spec-value">Power enters pins 1 & 2, exits pins 3 & 4 to loads</span></div>
      </div>
      <p style="margin-top:0.5rem;color:#94a3b8;"><strong>Purpose:</strong> Passes actual AC power to machine when coil allows it.</p>
    </div>
  </div>
  
  <div class="info-box">
    <h4>Mean Well SDR-480-48 Power Supply</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">SDR-480-48</span></div>
      <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">48V DC</span></div>
      <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">200-240V AC</span></div>
      <div class="spec-row"><span class="spec-label">Protection:</span><span class="spec-value">OVP, OCP, OLP, OTP</span></div>
      <div class="spec-row"><span class="spec-label">Features:</span><span class="spec-value">PFC, DC OK relay</span></div>
    </div>
    
  </div>
  
  <div class="info-box">
    <h4>Mean Well NDR-240-24 Power Supply</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">NDR-240-24</span></div>
      <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">24V DC</span></div>
      <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">200-240V AC</span></div>
      <div class="spec-row"><span class="spec-label">Protection:</span><span class="spec-value">OVP, OCP, OLP, OTP</span></div>
          </div>
    
  </div>
  
  <div class="info-box">
    <h4>Mean Well NDR-120-12 Power Supply</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">NDR-120-12 (12V) + 5V supply</span></div>
      <div class="spec-row"><span class="spec-label">12V Output:</span><span class="spec-value">12V DC</span></div>
      <div class="spec-row"><span class="spec-label">5V Output:</span><span class="spec-value">5V DC</span></div>
      <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">200-240V AC</span></div>
    </div>
    
  </div>
  
  <div class="terminal-block">
    <h4>UKK80 Terminal Blocks</h4>
    <p style="color:#cbd5e1;margin-bottom:0.75rem;">Single-pole power distribution blocks. Each screw terminal connects to same internal metal bar - works like a "power splitter".</p>
    
    <div style="margin-top:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">LINE UKK Block:</h5>
      <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
        <li>Receives protected Line (L) from Doepke</li>
        <li>Distributes AC power to downstream components</li>
        <li>Acts as main Line bus for entire machine</li>
      </ul>
    </div>
    
    <div style="margin-top:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">NEUTRAL UKK Block:</h5>
      <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
        <li>Receives Neutral (N) from Doepke</li>
        <li>Sends Neutral to all AC loads</li>
        <li>Carries return Neutral current back toward Doepke</li>
        <li>Acts as Neutral bus for entire machine</li>
      </ul>
    </div>
  </div>
  
  <div class="terminal-block">
    <h4>Phoenix Contact Terminal Blocks</h4>
    <p style="color:#cbd5e1;margin-bottom:0.75rem;">Color-coded DC distribution rails organized by voltage/function:</p>
    
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:0.75rem;margin-top:0.75rem;">
      <div style="background:rgba(30,41,59,0.7);padding:0.75rem;border-radius:0.5rem;border-left:4px solid #ef4444;">
        <strong style="color:#ef4444;">Red:</strong><br>
        <span style="color:#cbd5e1;font-size:0.85rem;">+24V DC</span>
      </div>
      <div style="background:rgba(30,41,59,0.7);padding:0.75rem;border-radius:0.5rem;border-left:4px solid #6b7280;">
        <strong style="color:#9ca3af;">Black:</strong><br>
        <span style="color:#cbd5e1;font-size:0.85rem;">0V/GND</span>
      </div>
    </div>
    
    <p style="color:#94a3b8;margin-top:1rem;"><strong>Power Flow:</strong> NDR-120 ‚Üí UKK80 ‚Üí Phoenix terminals ‚Üí distributed to all devices. Each device gets: one wire from red terminal (+24V), one from black terminal (0V return), forming complete electrical loop.</p>
  </div>
</div>

          <div class="tab-content" id="tab-operation">
  <h3 class="section-title">Complete System Operation</h3>
  
  <div class="operation-sequence">
    <h4>üîÑ Power-On Sequence:</h4>
    <div class="operation-step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>Wall AC Input:</strong> 200-240V AC power enters cabinet through wall outlet
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>Nader Breaker Protection:</strong> Power flows through Nader NDB1L-32 breaker which monitors for short circuit, overload, leakage, and over-voltage
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>RCD Monitoring:</strong> Doepke G16 monitors for ground faults by comparing Line and Neutral current
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">4</div>
      <div class="step-content">
        <strong>DOLD Self-Test:</strong> DOLD D-78120 safety relay powers on, performs self-test, and monitors safety circuit (S11‚ÜíS12, S11‚ÜíS22, S21)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">5</div>
      <div class="step-content">
        <strong>Operator Reset:</strong> After verifying all safety devices are in normal state, operator presses DOLD reset button
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">6</div>
      <div class="step-content">
        <strong>Safety Relay Enable:</strong> DOLD energizes K1 and K2 internal relays, closing contacts 23-24 and 33-34 (redundant outputs)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">7</div>
      <div class="step-content">
        <strong>Finder Activation:</strong> DOLD output energizes Finder contactor coil (A1-A2), causing magnetic field to close power contacts 1‚Üí3 and 2‚Üí4
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">8</div>
      <div class="step-content">
        <strong>AC Distribution:</strong> AC power flows through Finder to UKK80 terminal blocks which distribute to all AC loads
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">9</div>
      <div class="step-content">
        <strong>DC Conversion:</strong> AC powers three Mean Well supplies:
        <ul style="margin-top:0.5rem;margin-left:1.5rem;">
          <li>SDR-480-48 produces 48V DC output</li>
          <li>NDR-240-24 produces 24V DC output</li>
          <li>NDR-120-12 produces 12V DC output, 5V supply produces 5V DC output</li>
        </ul>
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">10</div>
      <div class="step-content">
        <strong>Phoenix Distribution:</strong> DC voltages distributed via color-coded Phoenix terminals throughout machine:
        <ul style="margin-top:0.5rem;margin-left:1.5rem;">
          <li>Red terminals: +24V to devices</li>
          <li>Black terminals: 0V/GND return path</li>
          <li>Gray terminals: AC neutral common</li>
          <li>Green/Yellow: Safety ground</li>
        </ul>
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">11</div>
      <div class="step-content">
        <strong>System Ready:</strong> All systems powered and operational. Machine ready for operation
      </div>
    </div>
  </div>
  
  <div class="danger-box">
    <h4>‚ö° Emergency Shutdown Sequence:</h4>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>Safety Event Occurs:</strong> E-stop pressed OR light curtain broken
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>Safety Contacts Open:</strong> S12 and/or S22 contacts open immediately
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>DOLD Response:</strong> Detects open contacts, drops K1 and K2 relays within 50ms
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>Finder De-energizes:</strong> DOLD outputs 23-24 and 33-34 open, removing power from Finder coil
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>Power Cutoff:</strong> Finder contacts 1‚Üí3 and 2‚Üí4 open, disconnecting AC power
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">!</div>
      <div class="step-content">
        <strong>System Shutdown:</strong> All power supplies shut down, machine loses power instantly. Total response time: &lt;100ms from safety event to complete power loss
      </div>
    </div>
  </div>
  
  <div class="warning-box">
    <h4>‚ö†Ô∏è Safety Restart Procedure:</h4>
    <ol style="margin-left:1.5rem;color:#cbd5e1;line-height:1.8;">
      <li>Clear safety condition (reset E-stop or remove obstruction from light curtain)</li>
      <li>Verify all personnel are clear of machine</li>
      <li>Inspect area for any hazards or damage</li>
      <li>Press DOLD safety relay reset button</li>
      <li>Verify all systems power on normally</li>
      <li>Test machine operation in safe manner</li>
    </ol>
  </div>
  
  <div class="info-box">
    <h4>üîß Maintenance & Testing:</h4>
    <ul>
      <li><strong>Monthly:</strong> Test Nader and Doepke using test buttons to verify trip mechanisms work</li>
      <li><strong>Monthly:</strong> Test E-stop and light curtain functionality</li>
      <li><strong>Quarterly:</strong> Inspect terminal blocks for loose connections</li>
      <li><strong>Quarterly:</strong> Clean cabinet interior, check for dust buildup on power supplies</li>
      <li><strong>Annually:</strong> Verify all power supply output voltages are within spec</li>
      <li><strong>Annually:</strong> Check DC OK relay functionality on SDR-480-48</li>
    </ul>
  </div>
  
  <div class="danger-box">
    <h4>‚ö†Ô∏è Critical Safety Warnings:</h4>
    <ul>
      <li><strong>Never bypass</strong> the DOLD safety relay or Finder contactor</li>
      <li><strong>Never use</strong> Finder selector switch in ON or OFF positions - AUTO only</li>
      <li><strong>Never bypass</strong> the Protection Device or breaker protection</li>
      <li><strong>Always follow</strong> lockout/tagout procedures during maintenance</li>
      <li><strong>Only qualified electricians</strong> should work on this system</li>
      <li><strong>Test safety systems</strong> regularly to ensure proper operation</li>
    </ul>
  </div>
</div>
                `
      },
      'motor-control': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">üéõÔ∏è</span>Control Flow</button>
            <button class="tab-btn" data-tab="technical"><span class="tab-icon">üîß</span>Technical</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">Motor Control Cabinet</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Centralized motor control system housing four motor control boards that manage motor outputs for X, Y, Z axes and additional motor functions. This cabinet coordinates all motion control operations for the LaunchPad system with precise positioning and speed control.</p>
            
            <div class="info-box">
              <h4>Four Motor Control Boards:</h4>
              <ul>
                <li><strong>X-Axis Motor Control Board:</strong> Controls horizontal X-axis motion</li>
                <li><strong>Y-Axis Motor Control Board:</strong> Controls lateral Y-axis motion</li>
                <li><strong>Z-Axis Motor Control Board (Bottom-Left):</strong> Controls vertical Z-axis motion with special brake integration</li>
                <li><strong>4th Motor Control Board:</strong> Additional motor control for auxiliary functions</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>Power Distribution from Power Supply:</h4>
              <ul>
                <li><strong>SDR-480-48:</strong> 48V DC main motor power (Vmain for all 4 boards)</li>
                <li><strong>NDR-240-24:</strong> 24V DC logic and relay power (Vlogic and control signals)</li>
                <li><strong>NDR-120-12:</strong> 12V DC auxiliary systems power</li>
                <li><strong>Mean Well 5V PSU:</strong> 5V DC sensor power (encoders, opto-sensors, light bars)</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>Key Components in Motor Control Cabinet:</h4>
              <ul>
                <li><strong>Motor Control Boards (4x):</strong> Four motor control boards for each axis (48VDC power)</li>
                <li><strong>Phoenix Terminal Blocks:</strong> Red (48V/24V/5V+), Black (GND)</li>
                <li><strong>WAGO 221 Splicing System:</strong> Ground, power, Vlogic, and CAN communication distribution</li>
                <li><strong>UKK80 Terminal Blocks:</strong> Wire junction and connection points</li>
                <li><strong>CANBus Communication Loop:</strong> Digital control, tuning, and status monitoring between all boards</li>
                <li><strong>RS485 Serial:</strong> Serial communication capability (Modbus or similar protocols)</li>
                <li><strong>Encoder Feedback System:</strong> Closed-loop position verification via X-LIN, Y-LIN, Z-LIN bundles</li>
                <li><strong>Home Sensors (3x):</strong> EE-SX950W opto-interrupters for X-START, Y-START, Z-START</li>
                <li><strong>Z-Axis Brake:</strong> Connected to Board 3 (bottom-left) OUT0 for load holding</li>
                <li><strong>Enable Signal Distribution:</strong> 24V control to activate/deactivate each board</li>
              </ul>
            </div>
            
            <h4 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.75rem;">Power Supply Specifications:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">48V Main (SDR-480-48):</span><span class="spec-value">total, distributed to all 4 Vmain inputs</span></div>
              <div class="spec-row"><span class="spec-label">24V Logic (NDR-240-24):</span><span class="spec-value">for Vlogic, relays, and control signals</span></div>
              <div class="spec-row"><span class="spec-label">12V Auxiliary (NDR-120-12):</span><span class="spec-value">for auxiliary systems</span></div>
              <div class="spec-row"><span class="spec-label">5V Sensors (Mean Well):</span><span class="spec-value">Powers encoders, opto-sensors, light bars</span></div>
            </div>
            
            <h4 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.75rem;">Motor Control Specifications:</h4>
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Motor Power (Vmain):</span><span class="spec-value">48 VDC from SDR-480-48 via Phoenix Red terminals</span></div>
              <div class="spec-row"><span class="spec-label">Logic Voltage (Vlogic):</span><span class="spec-value">24 VDC from NDR-240-24 via WAGO 221 splicing</span></div>
              <div class="spec-row"><span class="spec-label">Total Current:</span><span class="spec-value">peak (all 4 drivers each)</span></div>
              <div class="spec-row"><span class="spec-label">Individual Driver:</span><span class="spec-value">per axis driver (DM542)</span></div>
              <div class="spec-row"><span class="spec-label">Positioning Accuracy:</span><span class="spec-value">¬±0.01mm per axis</span></div>
              <div class="spec-row"><span class="spec-label">Max Speed:</span><span class="spec-value">200mm/sec coordinated motion</span></div>
              <div class="spec-row"><span class="spec-label">Communication:</span><span class="spec-value">CANBus loop + RS485 (Modbus or similar) available</span></div>
              <div class="spec-row"><span class="spec-label">Encoder Type:</span><span class="spec-value">Quadrature (A/B channels) 5V powered</span></div>
            </div>
            
            <div class="warning-box">
              <h4>‚ö†Ô∏è Critical Safety Features:</h4>
              <ul style="list-style: disc; margin-left: 1.5rem;">
                <li>Emergency stop immediately disables all motor drivers</li>
                <li>Each axis has independent enable control</li>
                <li>Soft-stop limits (STOP_L/STOP_R) prevent motion but maintain power</li>
                <li>Overcurrent protection on each driver</li>
                <li>Thermal monitoring prevents driver overheating</li>
                <li>Z-Axis brake system for vertical load holding</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>üîÑ Closed-Loop Servo Operation:</h4>
              <p style="color:#cbd5e1;line-height:1.6;"><strong>ENC_A + ENC_B = Closed-Loop Stepper</strong></p>
              <p style="color:#cbd5e1;line-height:1.6;margin-top:0.5rem;">When both encoder channels are connected, the motor control boards operate as closed-loop servo systems, providing position verification, automatic error correction, and lost step prevention.</p>
            </div>
          </div>
          
                    <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Motor Control Power & Signal Flow</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;"><strong>Simplified view:</strong> Click any component to see detailed information</p>
            
            <div class="flow-diagram">
              <h4 style="color:#60a5fa;margin-bottom:1.5rem;">üîå Simple Power Flow Overview</h4>
              
              <!-- Single unified power flow -->
              <div class="flow-stage">
                <div class="flow-box" style="background:#8b5cf6;color:white;flex:2;cursor:pointer;" data-motor-component="power-cabinet-summary">
                  <strong>POWER SUPPLY</strong>
                  <div class="subtitle">4 Power Supplies (PCUs)</div>
                  <div style="font-size:0.75rem;margin-top:0.5rem;opacity:0.9;">48V ‚Ä¢ 24V ‚Ä¢ 12V ‚Ä¢ 5V</div>
                </div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-box" style="background:#dc2626;color:white;flex:1.5;cursor:pointer;" data-motor-component="phoenix-summary">
                  <strong>PHOENIX TERMINALS</strong>
                  <div class="subtitle">Distribution Rails</div>
                </div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-box" style="background:#ec4899;color:white;flex:2;cursor:pointer;" data-motor-component="motor-boards-summary">
                  <strong>4 MOTOR BOARDS</strong>
                  <div class="subtitle">X, Y, Z, & 4th Axis</div>
                </div>
              </div>
              
              <div style="text-align:center;margin:2rem 0;">
                <div style="display:inline-block;background:rgba(59,130,246,0.1);border:1px solid rgba(59,130,246,0.3);padding:1rem 1.5rem;border-radius:0.5rem;">
                  <p style="color:#60a5fa;font-size:0.9rem;margin:0;"><strong>üí° That's it!</strong> Power flows from Power Supply PCUs ‚Üí through Phoenix terminal blocks ‚Üí to the 4 motor control boards</p>
                </div>
              </div>
            </div>
            
            <!-- Collapsible detailed sections -->
            <div class="info-box" style="border-left-color:#8b5cf6;">
              <h4 style="cursor:pointer;user-select:none;" onclick="this.parentElement.querySelector('.detail-content').classList.toggle('active')">
                üì¶ Power Supply PCUs (Click to expand) ‚ñº
              </h4>
              <div class="detail-content" style="display:none;margin-top:1rem;">
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;">
                  <div style="background:rgba(220,38,38,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(220,38,38,0.3);cursor:pointer;" data-motor-component="sdr-480-48">
                    <strong style="color:#ef4444;">SDR-480-48</strong>
                    <p style="margin:0.5rem 0 0 0;font-size:0.85rem;">48V DC ‚Üí Motor power (Vmain)</p>
                  </div>
                  <div style="background:rgba(249,115,22,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(249,115,22,0.3);cursor:pointer;" data-motor-component="ndr-240-24">
                    <strong style="color:#f97316;">NDR-240-24</strong>
                    <p style="margin:0.5rem 0 0 0;font-size:0.85rem;">24V DC ‚Üí Logic power (Vlogic)</p>
                  </div>
                  <div style="background:rgba(59,130,246,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(59,130,246,0.3);cursor:pointer;" data-motor-component="ndr-120-12">
                    <strong style="color:#3b82f6;">NDR-120-12</strong>
                    <p style="margin:0.5rem 0 0 0;font-size:0.85rem;">12V DC ‚Üí Auxiliary systems</p>
                  </div>
                  <div style="background:rgba(34,197,94,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(34,197,94,0.3);cursor:pointer;" data-motor-component="mean-well-5v">
                    <strong style="color:#22c55e;">Mean Well 5V</strong>
                    <p style="margin:0.5rem 0 0 0;font-size:0.85rem;">5V DC ‚Üí Sensors & encoders</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="info-box" style="border-left-color:#dc2626;">
              <h4 style="cursor:pointer;user-select:none;" onclick="this.parentElement.querySelector('.detail-content').classList.toggle('active')">
                üîå Phoenix Terminals (Click to expand) ‚ñº
              </h4>
              <div class="detail-content" style="display:none;margin-top:1rem;">
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;">
                  <div style="text-align:center;padding:1rem;background:rgba(220,38,38,0.1);border-radius:0.5rem;cursor:pointer;" data-motor-component="phoenix-red">
                    <div style="font-size:2rem;margin-bottom:0.5rem;">üî¥</div>
                    <strong style="color:#dc2626;">RED</strong>
                    <p style="font-size:0.8rem;margin-top:0.25rem;">Positive rails (+48V, +24V, +5V)</p>
                  </div>
                  <div style="text-align:center;padding:1rem;background:rgba(31,41,55,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="phoenix-black">
                    <div style="font-size:2rem;margin-bottom:0.5rem;">‚ö´</div>
                    <strong style="color:#9ca3af;">BLACK</strong>
                    <p style="font-size:0.8rem;margin-top:0.25rem;">Ground (0V)</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="info-box" style="border-left-color:#c084fc;">
              <h4 style="cursor:pointer;user-select:none;" onclick="this.parentElement.querySelector('.detail-content').classList.toggle('active')">
                üîó WAGO Splicing System (Click to expand) ‚ñº
              </h4>
              <div class="detail-content" style="display:none;margin-top:1rem;">
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;">
                  <div style="padding:0.75rem;background:rgba(168,85,247,0.05);border:1px solid rgba(168,85,247,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="wago-ground">
                    <strong style="color:#c084fc;">Ground Splicer</strong>
                    <p style="font-size:0.85rem;margin-top:0.25rem;">Connects all 4 boards to common ground</p>
                  </div>
                  <div style="padding:0.75rem;background:rgba(168,85,247,0.05);border:1px solid rgba(168,85,247,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="wago-vlogic">
                    <strong style="color:#c084fc;">Vlogic Splicer</strong>
                    <p style="font-size:0.85rem;margin-top:0.25rem;">Distributes 24V logic to all 4 boards</p>
                  </div>
                  <div style="padding:0.75rem;background:rgba(168,85,247,0.05);border:1px solid rgba(168,85,247,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="can-network">
                    <strong style="color:#c084fc;">CAN Splicer</strong>
                    <p style="font-size:0.85rem;margin-top:0.25rem;">Creates communication loop between all boards</p>
                  </div>
                  <div style="padding:0.75rem;background:rgba(168,85,247,0.05);border:1px solid rgba(168,85,247,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="wago-power">
                    <strong style="color:#c084fc;">Power Splicer</strong>
                    <p style="font-size:0.85rem;margin-top:0.25rem;">24V power to 3 boards</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="flow-diagram" style="margin-top:2rem;">
              <h4 style="color:#4ade80;margin-bottom:1rem;">üéÆ Control Signal Flow</h4>
              <div class="flow-stage">
                <div class="flow-box flow-box-blue" style="flex:1;cursor:pointer;" data-motor-component="motion-controller">
                  <strong>MOTION CONTROLLER</strong>
                  <div class="subtitle">Sends commands</div>
                </div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-box" style="background:#ec4899;color:white;flex:1;cursor:pointer;" data-motor-component="motor-boards-summary">
                  <strong>4 MOTOR BOARDS</strong>
                  <div class="subtitle">Process signals & drive motors</div>
                </div>
              </div>
              
              <div style="margin-top:1rem;padding:1rem;background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.3);border-radius:0.5rem;cursor:pointer;" data-motor-component="encoders">
                <p style="color:#cbd5e1;font-size:0.9rem;margin:0;"><strong style="color:#4ade80;">Encoder Feedback:</strong> Position data returns through X-LIN, Y-LIN, Z-LIN encoder bundles for closed-loop control</p>
              </div>
            </div>
            
            <div class="warning-box" style="margin-top:2rem;">
              <h4>üîë Key Communication Protocol</h4>
              <p style="margin-bottom:0.5rem;"><strong>CANBus:</strong> All 4 motor control boards communicate via CAN network for synchronized control and status monitoring</p>
              <p style="margin:0;"><strong>Alternative:</strong> RS485 (Modbus or similar) available as backup communication method</p>
            </div>
            
            <style>
              .detail-content.active { display: block !important; animation: slideDown 0.3s ease; }
              @keyframes slideDown { from { opacity: 0; max-height: 0; } to { opacity: 1; max-height: 1000px; } }
              
              /* Enhanced hover effects for all clickable components in Control Flow */
              #tab-flow [data-motor-component] {
                position: relative;
                transition: all 0.3s ease;
              }
              
              /* Main flow boxes - light up with glow */
              #tab-flow .flow-box[data-motor-component]:hover {
                transform: translateY(-5px) scale(1.02);
                box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
                filter: brightness(1.2);
              }
              
              /* Purple Power Supply box */
              #tab-flow .flow-box[data-motor-component="power-cabinet-summary"]:hover {
                box-shadow: 0 12px 30px rgba(139, 92, 246, 0.6), 0 0 40px rgba(139, 92, 246, 0.4);
              }
              
              /* Red Phoenix box */
              #tab-flow .flow-box[data-motor-component="phoenix-summary"]:hover {
                box-shadow: 0 12px 30px rgba(220, 38, 38, 0.6), 0 0 40px rgba(220, 38, 38, 0.4);
              }
              
              /* Pink Motor Boards box */
              #tab-flow .flow-box[data-motor-component="motor-boards-summary"]:hover {
                box-shadow: 0 12px 30px rgba(236, 72, 153, 0.6), 0 0 40px rgba(236, 72, 153, 0.4);
              }
              
              /* Blue Motion Controller box */
              #tab-flow .flow-box[data-motor-component="motion-controller"]:hover {
                box-shadow: 0 12px 30px rgba(37, 99, 235, 0.6), 0 0 40px rgba(37, 99, 235, 0.4);
              }
              
              /* Collapsible section items - PCUs grid */
              #tab-flow .detail-content [data-motor-component] {
                transition: all 0.3s ease;
              }
              
              #tab-flow .detail-content [data-motor-component]:hover {
                transform: translateY(-3px);
                filter: brightness(1.15);
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
              }
              
              /* SDR-480-48 red glow */
              #tab-flow [data-motor-component="sdr-480-48"]:hover {
                box-shadow: 0 6px 20px rgba(220, 38, 38, 0.5), 0 0 30px rgba(220, 38, 38, 0.3);
              }
              
              /* NDR-240-24 orange glow */
              #tab-flow [data-motor-component="ndr-240-24"]:hover {
                box-shadow: 0 6px 20px rgba(249, 115, 22, 0.5), 0 0 30px rgba(249, 115, 22, 0.3);
              }
              
              /* NDR-120-12 blue glow */
              #tab-flow [data-motor-component="ndr-120-12"]:hover {
                box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5), 0 0 30px rgba(59, 130, 246, 0.3);
              }
              
              /* Mean Well green glow */
              #tab-flow [data-motor-component="mean-well-5v"]:hover {
                box-shadow: 0 6px 20px rgba(34, 197, 94, 0.5), 0 0 30px rgba(34, 197, 94, 0.3);
              }
              
              /* Phoenix terminals with emoji */
              #tab-flow [data-motor-component="phoenix-red"]:hover {
                box-shadow: 0 6px 20px rgba(220, 38, 38, 0.5), 0 0 30px rgba(220, 38, 38, 0.3);
                background: rgba(220, 38, 38, 0.15) !important;
              }
              
              #tab-flow [data-motor-component="phoenix-black"]:hover {
                box-shadow: 0 6px 20px rgba(148, 163, 184, 0.5), 0 0 30px rgba(148, 163, 184, 0.3);
                background: rgba(31, 41, 55, 0.5) !important;
              }
              
              /* WAGO splicers purple glow */
              #tab-flow [data-motor-component="wago-ground"]:hover,
              #tab-flow [data-motor-component="wago-vlogic"]:hover,
              #tab-flow [data-motor-component="can-network"]:hover,
              #tab-flow [data-motor-component="wago-power"]:hover {
                box-shadow: 0 6px 20px rgba(168, 85, 247, 0.5), 0 0 30px rgba(168, 85, 247, 0.3);
                background: rgba(168, 85, 247, 0.1) !important;
              }
              
              /* Encoder feedback box green glow */
              #tab-flow [data-motor-component="encoders"]:hover {
                box-shadow: 0 6px 20px rgba(16, 185, 129, 0.5), 0 0 30px rgba(16, 185, 129, 0.3);
                background: rgba(16, 185, 129, 0.15) !important;
                transform: translateY(-2px);
              }
              
              /* Add pulsing effect for extra emphasis */
              @keyframes pulseGlow {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.85; }
              }
              
              #tab-flow [data-motor-component]:hover {
                animation: pulseGlow 2s ease-in-out infinite;
              }
              
              /* Cursor pointer for all interactive elements */
              #tab-flow [data-motor-component] {
                cursor: pointer !important;
              }
            </style>
          </div>
          
          </div>
          
          <div class="tab-content" id="tab-technical">
  <h3 class="section-title">Motor Control Board Specifications</h3>
  <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Four motor control boards manage X, Y, Z axes and additional motor functions. Each board has dedicated communication, input/feedback, motor output, and power connections.</p>
  
  <div class="info-box">
    <h4>üîå Power Conversion Units (PCUs) from Power Supply</h4>
    <p style="color:#cbd5e1;margin-bottom:1rem;">All power for the Motor Control Cabinet originates from these four PCUs located in the Power Supply:</p>
    
    <div class="terminal-block">
      <h4>SDR-480-48 (Main Motor Power)</h4>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">48V DC</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Vmain power for all 4 motor control boards</span></div>
        <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix Red terminal ‚Üí 4 motor control boards</span></div>
      </div>
      <p style="color:#cbd5e1;margin-top:0.75rem;">Provides the high-current power needed to drive motors.</p>
    </div>
    
    <div class="terminal-block">
      <h4>NDR-240-24 (Logic & Relay Power)</h4>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Vlogic power, relay coils, enable signals</span></div>
        <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix Red ‚Üí WAGO 221 ‚Üí All 4 boards</span></div>
      </div>
      <p style="color:#cbd5e1;margin-top:0.75rem;">Powers the control logic circuits in each motor driver board, enabling them to process signals and control motor movement.</p>
    </div>
    
    <div class="terminal-block">
      <h4>NDR-120-12 (Auxiliary Systems)</h4>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">12V DC</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Auxiliary system power</span></div>
        <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix Red terminal</span></div>
      </div>
      <p style="color:#cbd5e1;margin-top:0.75rem;">Provides power for auxiliary systems that require 12V DC operation.</p>
    </div>
    
    <div class="terminal-block">
      <h4>Mean Well 5V Power Supply (Sensor Power)</h4>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">5V DC</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Encoder and sensor power</span></div>
        <div class="spec-row"><span class="spec-label">Powers:</span><span class="spec-value">EE-SX950W sensors, encoders (X/Y/Z-LIN), light bars</span></div>
        <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix Red terminal ‚Üí Sensors</span></div>
      </div>
      <p style="color:#cbd5e1;margin-top:0.75rem;">Provides clean, regulated 5V power for all position feedback sensors and status indicators.</p>
    </div>
  </div>
  
  <div class="info-box">
    <h4>üîß Phoenix Terminal Block Distribution System</h4>
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">Phoenix Red Terminals (Positive Rails):</h5>
      <p style="color:#cbd5e1;">Multiple DIN rail terminal blocks carrying +48V, +24V, and +5V power. These act as distribution buses, allowing multiple connections to each voltage rail.</p>
    </div>
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">Phoenix Black Terminals (Ground Rail):</h5>
      <p style="color:#cbd5e1;">Common ground (0V) reference for all systems. All ground returns connect here to ensure proper current flow and signal integrity.</p>
    </div>
  </div>
  
  <div class="info-box">
    <h4>‚ö° Communication Ports (Left Side)</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">CAN_L / CAN_H:</span><span class="spec-value">CANBus communication for digital control, tuning, and status</span></div>
      <div class="spec-row"><span class="spec-label">RS485‚Äì / RS485+:</span><span class="spec-value">Serial communication lines (Modbus or similar)</span></div>
      <div class="spec-row"><span class="spec-label">GND:</span><span class="spec-value">Signal ground for CAN/RS485</span></div>
    </div>
    <div class="note-callout">
      <strong>CAN vs RS485:</strong> CAN includes both physical wire rules AND message rules. RS485 provides physical wiring standards and can support various protocols (Modbus or similar).
    </div>
  </div>
  
  <div class="info-box">
    <h4>üì• Input / Feedback Ports (Top Middle)</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">GND:</span><span class="spec-value">Ground reference for all inputs</span></div>
      <div class="spec-row"><span class="spec-label">IN0 / HOME:</span><span class="spec-value">Home or limit switch input</span></div>
      <div class="spec-row"><span class="spec-label">IN1 / ENC_A:</span><span class="spec-value">Encoder channel A (position feedback)</span></div>
      <div class="spec-row"><span class="spec-label">IN2 / ENC_B:</span><span class="spec-value">Encoder channel B (position feedback)</span></div>
      <div class="spec-row"><span class="spec-label">STOP_L / STEP:</span><span class="spec-value">Left stop limit OR step pulses for motion</span></div>
      <div class="spec-row"><span class="spec-label">STOP_R / DIR:</span><span class="spec-value">Right stop limit OR direction signal</span></div>
      <div class="spec-row"><span class="spec-label">ISO_COM / OUT0:</span><span class="spec-value">Isolated output for fault or status signal</span></div>
    </div>
  </div>
  
  <div class="terminal-block">
    <h4>IN0 / HOME - Home/Limit Switch</h4>
    <p style="color:#cbd5e1;margin-bottom:0.5rem;"><strong>Functions:</strong></p>
    <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
      <li><strong>Resetting position:</strong> Returns axis to known zero point</li>
      <li><strong>Detecting zero position:</strong> Establishes reference for coordinates</li>
      <li><strong>Endstop protection:</strong> Prevents axis from traveling beyond safe limits</li>
    </ul>
  </div>
  
  <div class="terminal-block">
    <h4>IN1 / ENC_A + IN2 / ENC_B - Encoder Feedback</h4>
    <p style="color:#cbd5e1;margin-bottom:0.5rem;"><strong>Purpose:</strong> Position feedback for closed-loop control</p>
    <div class="note-callout">
      <strong>ENC_A + ENC_B = Closed-Loop Stepper</strong> ‚Üí Acts as a servo motor with position verification and error correction
    </div>
  </div>
  
  <div class="terminal-block">
    <h4>STOP_L / STEP - Left Limit & Step Input</h4>
    <p style="color:#cbd5e1;margin-bottom:0.5rem;"><strong>Dual Function Port:</strong></p>
    <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
      <li><strong>STOP_L:</strong> Stop input - limits how far motor can move left</li>
      <li><strong>STEP:</strong> Step pulses for motion control</li>
      <li>When limit is triggered, motor will not move in this direction or will gently decelerate</li>
      <li>Provides soft-stop protection for axis travel</li>
    </ul>
  </div>
  
  <div class="terminal-block">
    <h4>STOP_R / DIR - Right Limit & Direction</h4>
    <p style="color:#cbd5e1;margin-bottom:0.5rem;"><strong>Dual Function Port:</strong></p>
    <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
      <li><strong>STOP_R:</strong> Stop input - limits how far motor can move right</li>
      <li><strong>DIR:</strong> Direction signal (clockwise/counterclockwise, forward/reverse)</li>
      <li>When limit is triggered, motor will not move in this direction or will gently decelerate</li>
      <li>Provides soft-stop protection for axis travel</li>
    </ul>
    <div class="warning-box" style="margin-top:0.75rem;">
      <p><strong>‚ö†Ô∏è Important:</strong> STOP_L and STOP_R both force the motor to stop but DO NOT cut power to the driver. The motor remains energized and holding position.</p>
    </div>
  </div>
  
  <div class="terminal-block">
    <h4>ISO_COM / OUT0 - Isolated Output</h4>
    <p style="color:#cbd5e1;margin-bottom:0.5rem;"><strong>Function:</strong> Isolated output used for fault or status signal</p>
    <div class="warning-box" style="margin-top:0.75rem;">
      <h4 style="color:#fbbf24;">‚ö†Ô∏è Special Z-Axis Configuration:</h4>
      <p><strong>Critical Note:</strong> All OUT0 connections are blunt cuts (not used) except for the <strong>bottom-left motor control board</strong> where it is specifically connected to the <strong>"Z Brake"</strong> system. This connection is essential for Z-axis safety, allowing the brake to engage when needed to hold vertical loads.</p>
    </div>
  </div>
  
  <div class="info-box">
    <h4>üîå Motor Outputs (Right Side)</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">motor A1 / motor A2:</span><span class="spec-value">Motor coil A outputs - directly drive motor phase A</span></div>
      <div class="spec-row"><span class="spec-label">motor B1 / motor B2:</span><span class="spec-value">Motor coil B outputs - directly drive motor phase B</span></div>
    </div>
    <p style="color:#cbd5e1;margin-top:0.75rem;">These four wires connect directly to the motor windings to control position and speed.</p>
  </div>
  
  <div class="info-box">
    <h4>‚ö° Power Inputs (Bottom)</h4>
    <div class="specs-grid">
      <div class="spec-row"><span class="spec-label">Vlogic:</span><span class="spec-value">Low-voltage logic power (5‚Äì24V depending on board)</span></div>
      <div class="spec-row"><span class="spec-label">Enable:</span><span class="spec-value">Turns the motor driver ON/OFF</span></div>
      <div class="spec-row"><span class="spec-label">Vmain:</span><span class="spec-value">Main motor power (48VDC)</span></div>
      <div class="spec-row"><span class="spec-label">GND:</span><span class="spec-value">Power ground / return path</span></div>
    </div>
  </div>
  
  <div class="info-box">
    <h4>üìè Encoder Bundles: X-LIN / Y-LIN / Z-LIN</h4>
    <p style="color:#cbd5e1;margin-bottom:1rem;">For each axis (X, Y, Z), the encoder mounted on the motor has several wires that travel from the motor (on the moving axis) into the main control panel. These wires are grouped into encoder bundles for clean cable management:</p>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">Encoder Wire Bundle Contents:</h5>
      <div class="specs-grid">
        <div class="spec-row"><span class="spec-label">ENC_A:</span><span class="spec-value">Position pulse channel A (quadrature signal)</span></div>
        <div class="spec-row"><span class="spec-label">ENC_B:</span><span class="spec-value">Position pulse channel B (quadrature signal, 90¬∞ phase shift)</span></div>
        <div class="spec-row"><span class="spec-label">V+:</span><span class="spec-value">Encoder power supply (5V or 24V depending on encoder model)</span></div>
        <div class="spec-row"><span class="spec-label">GND:</span><span class="spec-value">Encoder ground reference</span></div>
        <div class="spec-row"><span class="spec-label">INDEX Z (optional):</span><span class="spec-value">Absolute reference pulse (one pulse per revolution)</span></div>
      </div>
    </div>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">Encoder Bundle Labels:</h5>
      <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
        <li><strong>X-LIN:</strong> Linear encoder bundle for X-axis (horizontal motion)</li>
        <li><strong>Y-LIN:</strong> Linear encoder bundle for Y-axis (lateral motion)</li>
        <li><strong>Z-LIN:</strong> Linear encoder bundle for Z-axis (vertical motion)</li>
      </ul>
    </div>
    
    <div class="note-callout">
      <p><strong>Purpose of Bundling:</strong> Grouping encoder wires together makes wiring cleaner, prevents cross-talk interference, and clearly shows that encoder wires stay together as one harness from motor to control board. The schematic uses these labels to simplify documentation.</p>
    </div>
  </div>
  
  <div class="info-box">
    <h4>üè† Home Sensors: X-START / Y-START / Z-START</h4>
    <p style="color:#cbd5e1;margin-bottom:1rem;">X-START, Y-START, and Z-START are the home sensors for each axis. They mark the beginning (zero position) of X, Y, and Z travel.</p>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">What They Do:</h5>
      <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
        <li>Tell the controller "This axis is at its home position"</li>
        <li>Set X=0, Y=0, Z=0 during homing sequence</li>
        <li>Act as limit switches so axis doesn't crash beyond safe end</li>
        <li>Give consistent reference points for accurate motion</li>
      </ul>
    </div>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#60a5fa;margin-bottom:0.5rem;">How They Work:</h5>
      <div class="operation-step" style="margin-bottom:0.5rem;">
        <div class="step-number">1</div>
        <div class="step-content">Each START sensor is an opto-interrupter (EE-SX950W)</div>
      </div>
      <div class="operation-step" style="margin-bottom:0.5rem;">
        <div class="step-number">2</div>
        <div class="step-content">A small flag on the carriage breaks the optical beam</div>
      </div>
      <div class="operation-step" style="margin-bottom:0.5rem;">
        <div class="step-number">3</div>
        <div class="step-content">The sensor sends a signal (Black wire) to motor driver ‚Üí controller</div>
      </div>
      <div class="operation-step" style="margin-bottom:0.5rem;">
        <div class="step-number">4</div>
        <div class="step-content">When beam is blocked ‚Üí START is triggered ‚Üí axis at home position</div>
      </div>
    </div>
  </div>
  
  <div class="terminal-block">
    <h4>üîó WAGO Terminal Connections</h4>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">WAGO Terminals [1, 2, 3] - Ground Splicer:</h5>
      <p style="color:#cbd5e1;">Splicer for all 4 motor control boards connecting their ground wires together</p>
    </div>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">WAGO 221 - Power Splicer:</h5>
      <p style="color:#cbd5e1;">3 motor control boards spliced together along with a 24V wire to power them</p>
    </div>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">WAGO Communication Splicer:</h5>
      <p style="color:#cbd5e1;">All CAN lines from each motor control board connected to make a communication loop</p>
    </div>
    
    <div style="margin-bottom:1rem;">
      <h5 style="color:#c084fc;margin-bottom:0.5rem;">WAGO 221 Vlogic Splicer:</h5>
      <p style="color:#cbd5e1;">All 4 motor control boards Vlogic connections plus a 5th connection to 24V power supply</p>
    </div>
  </div>
  
  <div class="warning-box">
    <h4>‚ö†Ô∏è Critical Notes:</h4>
    <ul style="list-style: disc; margin-left: 1.5rem;">
      <li><strong>Power Sequence:</strong> Always power Vmain (48V) before sending control signals</li>
      <li><strong>Enable Signal:</strong> Each board must be enabled before motor will respond</li>
      <li><strong>Stop Limits:</strong> STOP_L and STOP_R prevent motion but don't cut power</li>
      <li><strong>Encoder Feedback:</strong> Closed-loop operation requires both ENC_A and ENC_B connected</li>
      <li><strong>Home Sensors:</strong> Must be calibrated and verified before first use</li>
    </ul>
  </div>
</div>
          
          <div class="tab-content" id="tab-operation">
  <h3 class="section-title">Motor Control System Operation</h3>
  
  <div class="operation-sequence">
    <h4>üîÑ Complete System Startup Sequence:</h4>
    <div class="operation-step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>Power Supply PCU Activation:</strong> Wall power (240V AC) energizes all PCUs: SDR-480-48 (48V), NDR-240-24 (24V), NDR-120-12 (12V), and Mean Well 5V PSU
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>Phoenix Terminal Block Energization:</strong> Phoenix Red terminals receive +48V, +24V, and +5V; Phoenix Black terminal establishes ground reference
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>48V Main Power Distribution (Vmain):</strong> 48V DC from SDR-480-48 distributed through Phoenix Red terminal to all four motor control boards' Vmain inputs
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">4</div>
      <div class="step-content">
        <strong>24V Logic Power Distribution (Vlogic):</strong> 24V DC from NDR-240-24 distributed through Phoenix Red terminal and WAGO 221 Vlogic splicer to all four boards
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">5</div>
      <div class="step-content">
        <strong>Ground Connection Established:</strong> All boards connected to common ground through Phoenix Black terminal and WAGO Ground splicer [Terminals 1, 2, 3]
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">6</div>
      <div class="step-content">
        <strong>5V Sensor Power Active:</strong> Mean Well 5V PSU powers EE-SX950W home sensors, encoders (X/Y/Z-LIN bundles), and light bars
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">7</div>
      <div class="step-content">
        <strong>Communication Loop Established:</strong> CAN bus communication network formed between all boards through WAGO communication splicer, enabling digital control, tuning, and status monitoring
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">8</div>
      <div class="step-content">
        <strong>Board Initialization & Self-Diagnostics:</strong> Each motor control board performs power-on self-test, checks Vmain and Vlogic levels, and enters ready state
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">9</div>
      <div class="step-content">
        <strong>Enable Signal Distribution:</strong> Controller sends 24V Enable signals to each board to activate motor drivers
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">10</div>
      <div class="step-content">
        <strong>Encoder Verification:</strong> System verifies 5V-powered encoder signals (ENC_A and ENC_B) from each axis encoder bundle (X-LIN, Y-LIN, Z-LIN)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">11</div>
      <div class="step-content">
        <strong>System Ready:</strong> All boards enabled, all power rails stable, all communication paths verified - ready to receive motion commands
      </div>
    </div>
  </div>
  
  <div class="operation-sequence">
    <h4>üè† Homing Sequence (Establishing Zero Position):</h4>
    <div class="operation-step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>Initiate Homing:</strong> Controller sends homing command to all three axes (X, Y, Z)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>Move to Home Sensors:</strong> Each axis moves toward its START sensor (X-START, Y-START, Z-START)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>Sensor Detection:</strong> EE-SX950W opto-interrupter detects flag on carriage. A small flag breaks the optical beam between emitter and receiver, triggering the sensor
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">4</div>
      <div class="step-content">
        <strong>Signal to Controller:</strong> Black wire carries signal from sensor through IN0/HOME input on motor control board to main controller
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">5</div>
      <div class="step-content">
        <strong>Zero Position Set:</strong> Controller sets axis position to zero (X=0, Y=0, Z=0)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">6</div>
      <div class="step-content">
        <strong>Verification:</strong> Encoder position verified through ENC_A and ENC_B feedback
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">7</div>
      <div class="step-content">
        <strong>Homing Complete:</strong> All axes at known zero positions, ready for motion commands
      </div>
    </div>
  </div>
  
  <div class="operation-sequence">
    <h4>üéØ Motion Control Operation:</h4>
    <div class="operation-step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>Motion Command:</strong> Controller sends STEP pulses and DIR signals to motor drivers
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>Driver Processing:</strong> Each board converts step pulses into precise motor control signals sent through motor outputs
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>Motor Movement:</strong> Stepper motors move in coordinated motion according to commands
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">4</div>
      <div class="step-content">
        <strong>Position Feedback:</strong> Encoders send position data through ENC_A and ENC_B to verify movement
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">5</div>
      <div class="step-content">
        <strong>Closed-Loop Correction:</strong> If actual position differs from commanded position, driver adjusts automatically (servo-like behavior)
      </div>
    </div>
    <div class="operation-step">
      <div class="step-number">6</div>
      <div class="step-content">
        <strong>Limit Monitoring:</strong> STOP_L and STOP_R inputs continuously monitored to prevent exceeding travel limits
      </div>
    </div>
  </div>
  
  <div class="danger-box">
    <h4>üõë Soft-Stop Limit Switch Response (STOP_L / STOP_R):</h4>
    <p style="color:#cbd5e1;margin-bottom:0.75rem;"><strong>Important Distinction:</strong> These are soft-stop limits that prevent motion but do NOT cut power. They are different from emergency stop systems.</p>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">1</div>
      <div class="step-content">
        <strong>Limit Triggered:</strong> STOP_L or STOP_R input activated (physical limit switch or soft limit in software)
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">2</div>
      <div class="step-content">
        <strong>Motion Halted:</strong> Driver stops accepting STEP pulses in the restricted direction
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">3</div>
      <div class="step-content">
        <strong>Gentle Deceleration:</strong> Motor decelerates smoothly to prevent mechanical shock and component damage
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">4</div>
      <div class="step-content">
        <strong>Power Maintained:</strong> Driver remains powered and energized (48V Vmain still present, unlike safety relay cutoff)
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">5</div>
      <div class="step-content">
        <strong>Reverse Motion Allowed:</strong> Axis can move away from limit but not toward it (prevents collision but allows recovery)
      </div>
    </div>
    <div class="operation-step" style="background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);">
      <div class="step-number" style="background:#ef4444;">6</div>
      <div class="step-content">
        <strong>Status Output:</strong> ISO_COM/OUT0 signals fault condition to controller for logging and response
      </div>
    </div>
  </div>
  
  <div class="info-box">
    <h4>üîß Encoder Feedback (Closed-Loop Operation):</h4>
    <p style="margin-bottom:0.75rem;">When both ENC_A and ENC_B are connected, the motor control board operates as a closed-loop servo system:</p>
    <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.8;">
      <li><strong>Position Tracking:</strong> Encoder sends quadrature signals (A/B channels) for precise position measurement</li>
      <li><strong>Error Detection:</strong> Driver compares commanded position vs actual encoder position</li>
      <li><strong>Automatic Correction:</strong> If positions don't match, driver adds/subtracts steps to correct</li>
      <li><strong>Lost Step Prevention:</strong> System detects and compensates for missed steps immediately</li>
      <li><strong>Servo-Like Behavior:</strong> Closed-loop stepper behaves like a servo motor with position verification</li>
    </ul>
  </div>
  
  <div class="warning-box">
    <h4>‚ö†Ô∏è Operational Safety:</h4>
    <ul>
      <li><strong>Never disconnect motors while enabled:</strong> Always disable driver before disconnecting motor cables</li>
      <li><strong>Verify home sensors:</strong> Test X-START, Y-START, Z-START before first operation</li>
      <li><strong>Check limit switches:</strong> STOP_L and STOP_R must be functioning for safe operation</li>
      <li><strong>Monitor encoder signals:</strong> Verify ENC_A and ENC_B are providing feedback during motion</li>
      <li><strong>CAN bus integrity:</strong> Ensure communication loop is intact for all boards</li>
      <li><strong>Enable signal control:</strong> Use Enable input to safely power down drivers</li>
    </ul>
  </div>
  
  <div class="info-box">
    <h4>üîß Maintenance & Testing:</h4>
    <ul>
      <li><strong>Daily:</strong> Verify home sensors trigger correctly during startup homing</li>
      <li><strong>Weekly:</strong> Test limit switches (STOP_L, STOP_R) by manually triggering</li>
      <li><strong>Monthly:</strong> Check encoder signal quality on oscilloscope if available</li>
      <li><strong>Monthly:</strong> Inspect motor cable connections for wear or looseness</li>
      <li><strong>Quarterly:</strong> Verify CAN bus communication with diagnostic tools</li>
      <li><strong>Quarterly:</strong> Clean optical sensors (EE-SX950W) to ensure reliable detection</li>
      <li><strong>Annually:</strong> Recalibrate home positions and verify accuracy</li>
    </ul>
  </div>
  
  <div class="danger-box">
    <h4>‚ö†Ô∏è Critical Safety Warnings:</h4>
    <ul>
      <li><strong>PCU Power Sequencing:</strong> SDR-480-48 and NDR-240-24 must be fully powered before enabling motor drivers - incorrect sequence can damage boards</li>
      <li><strong>48V Vmain Hazard:</strong> Phoenix Red terminal carries 48V DC  - always verify power is OFF before working on connections</li>
      <li><strong>Stop limits DO NOT cut power:</strong> STOP_L/STOP_R prevent motion but driver remains energized with 48V present on Vmain and motor outputs</li>
      <li><strong>Emergency stop via safety relay:</strong> Only DOLD safety relay (in Power Supply) can completely cut all system power at the source (SDR-480-48 and NDR-240-24)</li>
      <li><strong>Z-axis special connection:</strong> Bottom-left board OUT0 connects to Z Brake - absolutely critical for Z-axis safety and vertical load holding</li>
      <li><strong>Motor cables are live:</strong> 48V (Vmain) present on motor outputs whenever SDR-480-48 is powered, even if Enable is low</li>
      <li><strong>Encoder power verification:</strong> Mean Well 5V PSU powers encoders - verify 5V ¬±0.25V at encoder V+ pins, incorrect voltage damages encoders immediately</li>
      <li><strong>Ground all boards:</strong> Common ground through Phoenix Black and WAGO ground splicer [1, 2, 3] is essential for signal integrity and safety</li>
      <li><strong>Enable before operation:</strong> Each board must receive Enable signal (24V from NDR-240-24) before motors will respond to commands</li>
      <li><strong>Vlogic critical:</strong> All boards require stable 24V Vlogic from NDR-240-24 via WAGO 221 - loss of Vlogic disables all drivers immediately</li>
      <li><strong>Terminal block ratings:</strong> Phoenix terminals and WAGO 221 have current limits - never exceed rated capacity (check wire gauge and fusing)</li>
      <li><strong>CAN bus integrity:</strong> Communication loop through WAGO splicer must be intact - damaged CAN wiring prevents status monitoring and can cause unsafe conditions</li>
    </ul>
  </div>
</div>
                `
      },
      
      'left-feeder': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">üîå</span>Signal Flow</button>
            <button class="tab-btn" data-tab="technical"><span class="tab-icon">üîß</span>Technical</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">Left Feeder System - Y-Axis Control</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Automated feeder system for precise Y-axis component positioning using stepper motor control.</p>
            
            <div class="info-box">
              <h4>Key Components:</h4>
              <ul>
                <li><strong>Stepper Motor:</strong> NEMA 23 bipolar</li>
                <li><strong>Stepper Driver:</strong> DD50D40NOM, 24V</li>
                <li><strong>Optical Sensor:</strong> 1x EE-SX950W</li>
                <li><strong>Solenoid Valves:</strong> 4x 24VDC</li>
                <li><strong>Limit Switches:</strong> Y-START, Y-END, Y-LIN</li>
              </ul>
            </div>
            
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Axis:</span><span class="spec-value">Y-Axis (Vertical)</span></div>
              <div class="spec-row"><span class="spec-label">Accuracy:</span><span class="spec-value">¬±0.01mm</span></div>
              <div class="spec-row"><span class="spec-label">Max Speed:</span><span class="spec-value">200mm/sec</span></div>
            </div>
          </div>
          
          <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Left Feeder Power & Signal Flow</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Complete electrical power distribution and control signal paths. <strong style="color:#fbbf24;">Click any component</strong> for detailed specifications.</p>
            
            <div style="display:flex;flex-direction:column;align-items:center;gap:2rem;padding:2rem;background:rgba(15,23,42,0.5);border-radius:1rem;overflow-x:auto;">
              
              <!-- AC INPUT CHAIN -->
              <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;">
                <div class="clickable-component flow-box flow-box-red" data-component="wall-ac" style="width:220px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">WALL AC</strong><br>
                  <span style="font-size:0.9rem;">200-240V</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-orange" data-component="nader" style="width:240px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">NADER NDB1L-32</strong><br>
                  <span style="font-size:0.9rem;">RCBO Protection</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-orange" data-component="doepke" style="width:240px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">DOEPKE G16</strong><br>
                  <span style="font-size:0.9rem;">Ground Fault Detection</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-yellow" data-component="ukk160" style="width:220px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">UKK160</strong><br>
                  <span style="font-size:0.9rem;">Terminal Blocks</span>
                </div>
              </div>
              
              <!-- POWER SUPPLY SPLIT -->
              <div style="display:flex;gap:5rem;margin-top:2rem;flex-wrap:wrap;justify-content:center;align-items:flex-start;">
                
                <!-- LEFT SIDE: 24V PSU BRANCH -->
                <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;min-width:320px;">
                  <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                  <div class="clickable-component flow-box flow-box-green" data-component="psu-24v" style="width:220px;text-align:center;padding:1rem;">
                    <strong style="font-size:1.1rem;">24V PSU</strong><br>
                    <span style="font-size:0.9rem;">Standard</span>
                  </div>
                  
                  <!-- 24V splits TWO ways -->
                  <div style="display:flex;gap:3rem;margin-top:1rem;flex-wrap:wrap;justify-content:center;">
                    
                    <!-- Path 1: To Driver Power -->
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
                      <div style="font-size:2rem;color:#a78bfa;font-weight:700;">‚Üì V+/V-</div>
                      <div class="clickable-component flow-box flow-box-purple" data-component="driver" style="width:180px;text-align:center;padding:1rem;">
                        <strong style="font-size:1rem;">DRIVER</strong><br>
                        <span style="font-size:0.85rem;">FMDD50D40NOM</span>
                        <div style="margin-top:0.75rem;padding-top:0.75rem;border-top:2px dashed rgba(251,191,36,0.5);">
                          <div style="font-size:0.8rem;color:#fbbf24;font-weight:600;">‚Üê 5V logic</div>
                          <div style="font-size:0.75rem;color:#fbbf24;">(PU, DR, MF)</div>
                        </div>
                      </div>
                      <div style="font-size:2.5rem;color:#a78bfa;font-weight:bold;">‚Üì</div>
                      <div class="clickable-component flow-box flow-box-red" data-component="motor" style="width:180px;text-align:center;padding:1rem;">
                        <strong style="font-size:1rem;">MOTOR</strong><br>
                        <span style="font-size:0.85rem;">X-Axis NEMA 23</span>
                      </div>
                    </div>
                    
                    <!-- Path 2: To Red Phoenix Terminal -->
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
                      <div style="font-size:2rem;color:#f87171;font-weight:700;">‚Üì 24V</div>
                      <div class="clickable-component flow-box flow-box-red" data-component="red-phoenix" style="width:180px;text-align:center;background:rgba(220,38,38,0.3);border:3px solid #dc2626;padding:1rem;">
                        <strong style="font-size:1rem;">RED PHOENIX</strong><br>
                        <span style="font-size:0.85rem;">Terminal Block</span>
                      </div>
                      
                      <!-- Red Phoenix splits to Relay and CAP -->
                      <div style="display:flex;gap:2rem;margin-top:0.5rem;">
                        <div style="display:flex;flex-direction:column;align-items:center;gap:0.75rem;">
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì Pin 11</div>
                          <div class="clickable-component flow-box flow-box-orange" data-component="relays" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">RELAY (4x)</strong><br>
                            <span style="font-size:0.8rem;">11 ‚Üí 14</span>
                            <div style="margin-top:0.5rem;padding-top:0.5rem;border-top:2px dashed rgba(251,191,36,0.5);pointer-events:none;">
                              <div style="font-size:0.75rem;color:#fbbf24;font-weight:600;">‚Üê A1/A2</div>
                            </div>
                          </div>
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì Pin 14</div>
                          <div class="clickable-component flow-box flow-box-green" data-component="solenoids" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">SOLENOIDS</strong><br>
                            <span style="font-size:0.8rem;">4x 24VDC</span>
                          </div>
                        </div>
                        
                        <div style="display:flex;flex-direction:column;align-items:center;gap:0.75rem;">
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì</div>
                          <div class="clickable-component flow-box flow-box-yellow" data-component="cap-circuits" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">CAP CIRCUITS</strong><br>
                            <span style="font-size:0.8rem;">4x Protection</span>
                          </div>
                        </div>
                      </div>
                      
                    </div>
                    
                  </div>
                </div>
                
                <!-- RIGHT SIDE: 5V PSU BRANCH -->
                <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;min-width:320px;">
                  <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                  <div class="clickable-component flow-box flow-box-green" data-component="psu-5v" style="width:220px;text-align:center;padding:1rem;">
                    <strong style="font-size:1.1rem;">5V PSU</strong><br>
                    <span style="font-size:0.9rem;">Low Power</span>
                  </div>
                  
                  <!-- 5V Logic Loop Box -->
                  <div style="margin-top:1.5rem;padding:2rem;background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border:3px solid #8b5cf6;border-radius:1rem;min-width:300px;box-shadow:0 4px 20px rgba(139,92,246,0.3);">
                    <div style="text-align:center;color:#8b5cf6;font-weight:700;font-size:1.1rem;margin-bottom:1.5rem;text-transform:uppercase;">5V Logic Loop</div>
                    
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;">
                      
                      <!-- 5V PSU text at top -->
                      <div style="font-size:0.95rem;color:#8b5cf6;font-weight:600;text-align:center;">5V from PSU ‚Üì</div>
                      
                      <!-- DN31C01 -->
                      <div class="clickable-component flow-box flow-box-cyan" data-component="dn31c01" style="width:200px;text-align:center;border:4px solid #06b6d4;padding:1rem;box-shadow:0 0 20px rgba(6,182,212,0.5);">
                        <strong style="font-size:1.1rem;">DN31C01</strong><br>
                        <span style="font-size:0.9rem;">MicroController</span>
                        <div style="margin-top:0.75rem;font-size:0.85rem;color:#fbbf24;font-weight:700;">"PLC BRAIN"</div>
                      </div>
                      
                      <!-- Control signals down arrow -->
                      <div style="font-size:2rem;color:#fbbf24;font-weight:bold;">‚Üì</div>
                      <div style="font-size:0.9rem;color:#fbbf24;font-weight:600;">PU-, DR- signals</div>
                      <div style="font-size:2rem;color:#fbbf24;font-weight:bold;">‚Üì</div>
                      
                      <!-- Connects to Driver BOX -->
                      <div style="background:linear-gradient(135deg,rgba(168,85,247,0.3),rgba(147,51,234,0.25));border:3px solid #a855f7;border-radius:0.75rem;padding:1.25rem;width:220px;text-align:center;box-shadow:0 4px 15px rgba(168,85,247,0.4);">
                        <div style="font-size:1rem;color:#e9d5ff;font-weight:700;margin-bottom:0.5rem;">Connects to Driver</div>
                        <div style="font-size:0.85rem;color:#cbd5e1;">(PU, DR, MF terminals)</div>
                      </div>
                      
                      <!-- Loop arrow back -->
                      <div style="font-size:2rem;color:#8b5cf6;font-weight:bold;">‚Üì</div>
                      <div style="font-size:0.95rem;color:#8b5cf6;font-weight:600;text-align:center;">Back to 5V PSU</div>
                      
                    </div>
                    
                  </div>

                  <!-- Control summary -->
                  <div style="margin-top:1.5rem;padding:1.25rem;background:rgba(6,182,212,0.1);border:2px dashed #06b6d4;border-radius:0.75rem;width:100%;max-width:300px;">
                    <div style="font-size:1rem;font-weight:700;color:#06b6d4;text-align:center;margin-bottom:0.75rem;">DN31C01 CONTROLS:</div>
                    <div style="font-size:0.9rem;color:#cbd5e1;line-height:2;">
                      <div style="font-weight:600;">‚Üí Driver (PU-, DR-)</div>
                      <div style="font-weight:600;">‚Üí Relay (A1/A2)</div>
                      <div style="font-weight:600;">‚Üê Sensors (OUT1)</div>
                    </div>
                  </div>
                  
                </div>
                
              </div>
              
            </div>

            <!-- Legend -->
            <div style="margin-top:2.5rem;padding:1.75rem;background:rgba(30,41,59,0.6);border-radius:0.75rem;border-left:5px solid #60a5fa;">
              <h4 style="color:#60a5fa;margin-bottom:1.25rem;font-size:1.2rem;">Power & Signal Legend</h4>
              <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.25rem;color:#cbd5e1;font-size:1rem;">
                <div><strong style="color:#a78bfa;font-size:1.1rem;">Purple (V+/V-):</strong> 24V Motor Power</div>
                <div><strong style="color:#f87171;font-size:1.1rem;">Red (24V):</strong> Relay & Solenoid Power</div>
                <div><strong style="color:#8b5cf6;font-size:1.1rem;">Purple Loop:</strong> 5V Logic Circuit</div>
                <div><strong style="color:#fbbf24;font-size:1.1rem;">Yellow Text:</strong> Control Signals</div>
                <div><strong style="color:#06b6d4;font-size:1.1rem;">Cyan Border:</strong> Central Controller</div>
              </div>
            </div>

            <!-- Side Panel -->
            <div id="component-side-panel" class="component-side-panel">
              <div class="side-panel-header">
                <h3 id="panel-component-name">Component Details</h3>
                <button class="panel-close-btn" onclick="closeComponentPanel()">‚úï</button>
              </div>
              <div id="panel-component-content" class="side-panel-content"></div>
            </div>
            <div id="panel-overlay" class="panel-overlay" onclick="closeComponentPanel()"></div>

          </div>
          
<div class="tab-content" id="tab-technical">
            <h3 class="section-title">Left Feeder Component Specifications</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Comprehensive component documentation for the Left Feeder control system including microcontroller, motor control, sensors, power distribution, and pneumatic actuation.</p>
            
            <!-- CONTROL & LOGIC SECTION -->
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üß† Control & Logic</h4>
            
            <div class="info-box">
              <h4>DN31C01 Microcontroller (Arduino Nano)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Central motion-control microcontroller / I/O controller board. The "PLC brain" of the feeder.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Arduino Nano based controller</span></div>
                <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB-C connection for programming</span></div>
                <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V logic, 24V outputs</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Primary Functions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Reads all sensors (optical, CAP sensors, limit switches)</li>
                  <li>Sends step/direction commands to FMDD50D40NOM driver</li>
                  <li>Activates solenoid relays for pneumatic control</li>
                  <li>Controls motion sequences and timing logic</li>
                  <li>Interfaces electrically with all feeder components</li>
                </ul>
              </div>
            </div>
            
            <div class="info-box">
              <h4>FMDD50D40NOM Stepper Driver</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Electronic module that controls the X-axis stepper motor. The "brain of the motor".</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">FMDD50D40NOM</span></div>
                <div class="spec-row"><span class="spec-label">Input Voltage:</span><span class="spec-value">DC 20-50V</span></div>
                <div class="spec-row"><span class="spec-label">Logic Inputs:</span><span class="spec-value">PU-, DR-, MF+, MF-</span></div>
                <div class="spec-row"><span class="spec-label">Motor Outputs:</span><span class="spec-value">A+, A-, B+, B-</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Driver Functions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>PU- (Pulse):</strong> Step signal from DN31C01 (one pulse = one microstep)</li>
                  <li><strong>DR- (Direction):</strong> Direction control (left or right)</li>
                  <li><strong>MF+/MF-:</strong> Enable control (not connected, auto-enabled)</li>
                  <li>Provides controlled current to motor coils</li>
                  <li>Microsteps the motor for smooth motion</li>
                  <li>Controls coil energizing order and direction</li>
                  <li>Protects motor from overcurrent</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Note:</strong> PU+ and DR+ are tied to +5V (common-anode wiring). Driver automatically enables when MF+/MF- left disconnected.</p>
            </div>
            
            <div class="info-box">
              <h4>X-Axis Stepper Motor</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Bipolar stepper motor that converts electrical pulses into precise rotational movement for X-axis positioning.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">NEMA 23 Bipolar Stepper</span></div>
                <div class="spec-row"><span class="spec-label">Phases:</span><span class="spec-value">2-phase (A and B coils)</span></div>
                <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">A+: Red, A-: Green, B+: Yellow, B-: Blue</span></div>
                <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">Receives signals from FMDD50D40NOM driver</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Operation:</strong> Purely a motor that receives coil energizing signals from the driver. Driver controls torque, speed, smoothness, and stepping sequence.</p>
            </div>
            
            <!-- SENSING SECTION -->
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üëÅÔ∏è Sensors & Detection</h4>
            
            <div class="info-box">
              <h4>Sensors (EE-SX950W Optical + CAP Sensors)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Infrared optical sensors and capacitive sensors for position detection, presence sensing, and part status monitoring.</p>
              
              <h5 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.75rem;">EE-SX950W Optical Sensors</h5>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Slot-type photoelectric sensor</span></div>
                <div class="spec-row"><span class="spec-label">Detection Method:</span><span class="spec-value">Infrared LED + phototransistor</span></div>
                <div class="spec-row"><span class="spec-label">Supply Voltage (Vcc):</span><span class="spec-value">5V DC</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">OUT1 signal to DN31C01</span></div>
                <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Vcc (5V), GND (0V), OUT1 (signal)</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>How Optical Sensors Work:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Beam Clear:</strong> LED light hits phototransistor ‚Üí OUT1 goes HIGH</li>
                  <li><strong>Beam Blocked:</strong> Part/flag blocks slot ‚Üí OUT1 goes LOW</li>
                  <li>DN31C01 monitors OUT1 to detect: home position, limit confirmation, jam detection</li>
                </ul>
              </div>
              
              <h5 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.75rem;">CAP Sensors (Capacitive Part Sensors)</h5>
              <p style="margin-bottom:0.75rem;color:#cbd5e1;"><strong>Function:</strong> Part presence sensors that detect component position and status.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">2 physical wires (power and signal combined)</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">Signal to DN31C01</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Detection Capabilities:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Is the part present or missing?</li>
                  <li>Is the part misaligned?</li>
                  <li>Is the part doubled or stuck?</li>
                </ul>
              </div>
              
              <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Combined Applications in Feeder:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Optical:</strong> Home position, limit switches (X-START, X-END, X-LIN), jam detection</li>
                  <li><strong>CAP:</strong> Part presence/absence, alignment verification, double-part detection</li>
                  <li>All sensor outputs feed to DN31C01 for integrated position and status monitoring</li>
                </ul>
              </div>
            </div>
            
            <!-- POWER & PROTECTION SECTION -->
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">‚ö° Power & Protection</h4>
            
            <div class="info-box">
              <h4>Nader NDB1L-32</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Combined breaker providing overcurrent, short circuit, ground fault, and overvoltage protection for the Left Feeder cabinet.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Residual Current Breaker with Overcurrent (RCBO)</span></div>
                <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">High Current</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">Line H (Hot), Line N (Neutral) from wall</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">Load H, Load N to Doepke G16</span></div>
                <div class="spec-row"><span class="spec-label">Test Button:</span><span class="spec-value">Simulates fault to verify trip mechanism</span></div>
              </div>
              <div class="note-callout" style="background:rgba(239,68,68,0.1);border-left:4px solid #ef4444;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Protection Functions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Short circuit protection</li>
                  <li>Overload protection</li>
                  <li>Leakage current detection</li>
                  <li>Overvoltage protection</li>
                  <li>Trips immediately if any fault detected</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Power Flow:</strong> Wall AC ‚Üí Nader Circuit Breaker ‚Üí Doepke G16 ‚Üí UKK160 ‚Üí Power Supplies</p>
            </div>
            
            <div class="info-box">
              <h4>Doepke G16</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Residual Current Device providing additional ground fault protection. Secondary safety layer after Nader.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">2-pole Protection Device</span></div>
                <div class="spec-row"><span class="spec-label">Monitoring:</span><span class="spec-value">Compares Line and Neutral current</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">From Nader Load H, Load N</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">To UKK160 terminal blocks</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Protection:</strong> Detects current imbalance between Line and Neutral. Trips if ground fault detected, protecting against electric shock and insulation failure.</p>
            </div>
            
            <div class="info-box">
              <h4>Dinkle Series 24V Power Supply (DRL-24V240W1AA)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Switching power supply converting AC mains to regulated 24V DC for control systems, relays, and solenoids.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DRL-24V240W1AA</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">200-240V AC from UKK160 Line and UKK160 Neutral</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">24V DC</span></div>
                <div class="spec-row"><span class="spec-label">Vo+ Terminal:</span><span class="spec-value">+24V to Line UKK160</span></div>
                <div class="spec-row"><span class="spec-label">Vo- Terminal:</span><span class="spec-value">0V to Neutral UKK160</span></div>
                <div class="spec-row"><span class="spec-label">FG Terminal:</span><span class="spec-value">Frame Ground to Yellow-Green TB</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Internal Stages:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>EMI Filter & Bridge Rectifier:</strong> Converts AC to high-voltage DC, filters noise</li>
                  <li><strong>PFC Converter:</strong> Power Factor Correction, improves efficiency, stabilizes DC bus</li>
                  <li><strong>PWM Converter:</strong> High-frequency switching through transformer for isolation and step-down</li>
                  <li><strong>Output Rectifier & Filter:</strong> Converts transformer secondary to clean 24V DC</li>
                  <li><strong>Feedback Control:</strong> CV (Constant Voltage) and CC (Constant Current) mode regulation</li>
                  <li><strong>Protection:</strong> Overvoltage, overcurrent, over-temperature protection</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Loads Powered:</strong> DN31C01 controller, relay coils, solenoid valves, driver logic circuits.</p>
            </div>
            
            <div class="info-box">
              <h4>5V Power Supply</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Provides 5V DC logic power for microcontroller and sensors.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">5V DC</span></div>
                <div class="spec-row"><span class="spec-label">Output Current:</span><span class="spec-value">Low Power</span></div>
                <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">Low Power</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">From UKK160 AC distribution</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Loads:</strong> DN31C01 microcontroller (5V logic), EE-SX950W optical sensors (Vcc).</p>
            </div>
            
            <div class="info-box">
              <h4>UKK160 Terminal Blocks</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Heavy-duty terminal blocks acting as distribution buses for Line and Neutral power throughout the cabinet.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Feed-through terminal blocks</span></div>
                <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">High rating</span></div>
                <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">Two blocks - Line bus and Neutral bus</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Connections:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Neutral UKK160:</strong> Terminal 6 ‚Üí connects to Doepke G16 Pin 2</li>
                  <li><strong>Line UKK160:</strong> Terminal 7 ‚Üí connects to Doepke G16 Pin 4</li>
                  <li>Distributes AC to: 24V power supply, 5V power supply inputs</li>
                  <li>Distributes 24V DC from Vo+ and Vo- to all DC loads</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Function:</strong> Acts as central power distribution point (splicing hub) for both AC input and DC output circuits.</p>
            </div>
            
            <div class="info-box">
              <h4>Yellow-Green TB (Earth Bus Bar)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Common earth ground terminal block serving as protective earth (PE) bus bar for the entire cabinet.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Safety bonding and grounding</span></div>
                <div class="spec-row"><span class="spec-label">Color Code:</span><span class="spec-value">Yellow-Green (PE standard)</span></div>
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Multi-point grounding terminal block</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Bonded Connections:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Incoming machine earth from mains</li>
                  <li>Earth from 24V PSU (FG terminal)</li>
                  <li>Earth from 5V PSU</li>
                  <li>Metal chassis / enclosure / door grounding</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Safety Function:</strong> If fault causes live wire to touch metal case, fault current flows through PE to breaker causing immediate trip. Prevents enclosure from becoming energized.</p>
              <div class="danger-box" style="margin-top:1rem;">
                <h4>‚ö†Ô∏è Important Safety Note</h4>
                <ul>
                  <li>Yellow-Green TB is <strong>NOT</strong> the DC return path (0V)</li>
                  <li>It is solely for <strong>safety earth bonding</strong></li>
                  <li>Do not use PE for signal or power returns</li>
                </ul>
              </div>
            </div>
            
            <!-- ACTUATION SECTION -->
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üí® Pneumatic Actuation</h4>
            
            <div class="info-box">
              <h4>41F-1ZC2-5 Relay</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Electromechanical relays that switch 24V power to solenoid valves based on DN31C01 control signals.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1ZC2-5</span></div>
                <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 relays (one per solenoid)</span></div>
                <div class="spec-row"><span class="spec-label">Coil Terminals:</span><span class="spec-value">A1, A2 (control input from DN31C01)</span></div>
                <div class="spec-row"><span class="spec-label">Contact Terminals:</span><span class="spec-value">11, 14 (switched output to solenoid)</span></div>
                <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC (or controlled by DN31C01 output)</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Operation Sequence:</strong>
                <ol style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>DN31C01 outputs control signal to relay coil terminal A1</li>
                  <li>Current flows through coil (A1 to A2), energizing electromagnet</li>
                  <li>Relay contacts close: Pin 11 connects to Pin 14</li>
                  <li>+24V flows from Red Phoenix Terminal ‚Üí Pin 11 ‚Üí Pin 14 ‚Üí Solenoid V+</li>
                  <li>Solenoid energizes and actuates pneumatic valve</li>
                  <li>When DN31C01 de-energizes relay, contacts open, solenoid de-energizes</li>
                </ol>
              </div>
            </div>
            
            <div class="info-box">
              <h4>24VDC Solenoid Valves (4x)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Pneumatic valves controlled by 24V coils that direct compressed air to actuators for mechanical operations.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 solenoids</span></div>
                <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC</span></div>
                <div class="spec-row"><span class="spec-label">Terminals:</span><span class="spec-value">V+ (24V), GND (0V return)</span></div>
                <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">Top/Bottom, Left/Right positions</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Solenoid Positions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Top Right Solenoid:</strong> Controls top-right pneumatic actuator</li>
                  <li><strong>Top Left Solenoid:</strong> Controls top-left pneumatic actuator</li>
                  <li><strong>Bottom Right Solenoid:</strong> Controls bottom-right pneumatic actuator</li>
                  <li><strong>Bottom Left Solenoid:</strong> Controls bottom-left pneumatic actuator</li>
                </ul>
              </div>
              <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Pneumatic Functions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Cap ejection</li>
                  <li>Cap clamping</li>
                  <li>Air blast for part clearing</li>
                  <li>Cap forwarding/pushing</li>
                </ul>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Operation:</strong> When relay closes, 24V appears at V+ ‚Üí current flows through coil ‚Üí coil becomes electromagnet ‚Üí valve shifts ‚Üí air flows to cylinder ‚Üí mechanical action occurs. When relay opens, spring returns valve to idle position.</p>
            </div>
            
            <div class="info-box">
              <h4>CAP Circuits (4x - Surge Protection)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Snubber/suppression circuits that protect relay contacts and electronics from voltage spikes when solenoid coils are de-energized.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">RC snubber or diode network</span></div>
                <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">Parallel with each solenoid coil</span></div>
                <div class="spec-row"><span class="spec-label">Terminals:</span><span class="spec-value">V+, GND (same nodes as solenoid)</span></div>
                <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 circuits (one per solenoid)</span></div>
              </div>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>How Surge Protection Works:</strong>
                <ol style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Relay ON:</strong> 24V applied, solenoid energizes, CAP circuit capacitor charges</li>
                  <li><strong>Relay turns OFF:</strong> Relay opens contact</li>
                  <li><strong>Coil collapse:</strong> Solenoid's magnetic field collapses, generating voltage spike (can reach 100s of volts)</li>
                  <li><strong>Spike absorption:</strong> CAP circuit clamps/absorbs energy via capacitor + resistor/diode</li>
                  <li><strong>Protection:</strong> Voltage spike reduced, relay contacts protected from arcing</li>
                </ol>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Benefits:</strong> Extends relay contact life, reduces electrical noise on communication lines, protects microcontroller and sensor circuits from voltage transients.</p>
            </div>
            
            <!-- SYSTEM ARCHITECTURE -->
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#cbd5e1;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üîó System Architecture</h4>
            
            <div class="info-box">
              <h4>Command Chain: DN31C01 ‚Üí Driver ‚Üí Motor</h4>
              <div style="background:rgba(15,23,42,0.5);border:1px solid rgba(148,163,184,0.3);border-radius:0.75rem;padding:1.5rem;margin-top:1rem;">
                <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem;">
                  <div style="flex:1;text-align:center;padding:1rem;background:#6366f1;border-radius:0.5rem;">
                    <div style="font-weight:600;margin-bottom:0.25rem;">DN31C01</div>
                    <div style="font-size:0.75rem;opacity:0.9;">COMMAND BRAIN</div>
                    <div style="font-size:0.7rem;margin-top:0.5rem;">Decides when/how far</div>
                  </div>
                  <div style="font-size:1.5rem;color:#60a5fa;">‚Üí</div>
                  <div style="flex:1;text-align:center;padding:1rem;background:#8b5cf6;border-radius:0.5rem;">
                    <div style="font-weight:600;margin-bottom:0.25rem;">FMDD50D40NOM</div>
                    <div style="font-size:0.75rem;opacity:0.9;">MOTOR BRAIN</div>
                    <div style="font-size:0.7rem;margin-top:0.5rem;">Coil control</div>
                  </div>
                  <div style="font-size:1.5rem;color:#60a5fa;">‚Üí</div>
                  <div style="flex:1;text-align:center;padding:1rem;background:#ec4899;border-radius:0.5rem;">
                    <div style="font-weight:600;margin-bottom:0.25rem;">X Stepper Motor</div>
                    <div style="font-size:0.75rem;opacity:0.9;">MUSCLE</div>
                    <div style="font-size:0.7rem;margin-top:0.5rem;">Movement</div>
                  </div>
                </div>
              </div>
            </div>
            
          </div>
          
                              <div class="tab-content" id="tab-operation">
            <h3 class="section-title">Left Rear Feeder Operation Sequence</h3>
            <p style="color:#cbd5e1;margin-bottom:1.5rem;">Complete operational workflow for Y-axis vertical positioning and pneumatic control using 41F-1Z-C2-5 relays.</p>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">System Initialization & Homing</div>
              </div>
              <div class="step-content">
                <p><strong>Power-On Sequence:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>24V DC power energizes stepper driver (DD50D40NOM)</li>
                  <li>5V logic power activates DN31C01 microcontroller</li>
                  <li>System performs self-check of limit switches (Y-START, Y-END, Y-LIN)</li>
                  <li>Optical sensor (EE-SX950W) initializes for position detection</li>
                </ul>
                <p style="margin-top:0.75rem;"><strong>Homing Routine:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>Controller sends Y-axis to <strong>Y-START</strong> limit switch (home position)</li>
                  <li>Motor moves slowly until Y-START is triggered</li>
                  <li>Position counter resets to zero (0)</li>
                  <li>System confirms Y-LIN safety interlock is clear</li>
                </ul>
                <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:0.75rem;margin-top:0.75rem;">
                  <strong>Note:</strong> Homing must complete successfully before accepting position commands. If Y-START is not reached within timeout, system flags FAULT condition.
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Position Command Reception</div>
              </div>
              <div class="step-content">
                <p><strong>Main Controller Interface:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>Main PLC/controller sends Y-axis target position (in steps or mm)</li>
                  <li>DN31C01 validates position is within travel limits (Y-START to Y-END)</li>
                  <li>Calculates required STEP pulses based on:
                    <ul style="margin-left:1.5rem;margin-top:0.25rem;">
                      <li>Current position (encoder feedback or step counting)</li>
                      <li>Target position</li>
                      <li>Motor resolution (steps/rev)</li>
                    </ul>
                  </li>
                  <li>Determines motion direction (UP or DOWN)</li>
                </ul>
                <div class="specs-grid" style="margin-top:1rem;">
                  <div class="spec-row"><span class="spec-label">Direction Signal:</span><span class="spec-value">DIR pin (HIGH = UP, LOW = DOWN)</span></div>
                  <div class="spec-row"><span class="spec-label">Step Signal:</span><span class="spec-value">STEP pin pulses (1 pulse = 1 microstep)</span></div>
                  <div class="spec-row"><span class="spec-label">Enable:</span><span class="spec-value">EN pin (LOW = motor enabled)</span></div>
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Y-Axis Motion Execution</div>
              </div>
              <div class="step-content">
                <p><strong>Stepper Motor Control:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li><strong>Enable Motor:</strong> EN pin pulled LOW (motor energized)</li>
                  <li><strong>Set Direction:</strong> DIR pin set according to move direction</li>
                  <li><strong>Generate Pulses:</strong> STEP pin receives pulse train from controller
                    <ul style="margin-left:1.5rem;margin-top:0.25rem;">
                      <li>Each rising edge = 1 microstep</li>
                      <li>Pulse frequency determines speed (e.g., 1000 Hz = 1000 steps/sec)</li>
                      <li>Ramp profile: acceleration ‚Üí constant velocity ‚Üí deceleration</li>
                    </ul>
                  </li>
                  <li><strong>Monitor Position:</strong> Real-time step counting tracks absolute position</li>
                </ul>
                
                <p style="margin-top:1rem;"><strong>Safety Interlocks During Motion:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li><strong>Y-END:</strong> Prevents movement beyond upper travel limit</li>
                  <li><strong>Y-START:</strong> Prevents movement beyond lower travel limit</li>
                  <li><strong>Y-LIN:</strong> Safety interlock - MUST be clear for motion</li>
                  <li><strong>Optical Sensor:</strong> Detects part presence at specific Y positions</li>
                </ul>
                
                <div class="warning-box" style="margin-top:1rem;">
                  <h4>‚ö†Ô∏è Limit Switch Protection:</h4>
                  <p>If Y-END or Y-START is triggered unexpectedly during motion, controller immediately:</p>
                  <ul style="margin-left:1.5rem;">
                    <li>Stops STEP pulse generation</li>
                    <li>Holds motor position (EN remains LOW)</li>
                    <li>Flags position error to main controller</li>
                    <li>Requires manual intervention or re-homing</li>
                  </ul>
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">Pneumatic Solenoid Control via 41F Relays</div>
              </div>
              <div class="step-content">
                <p><strong>At Target Position:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>Y-axis completes motion and settles at target position</li>
                  <li>Controller confirms optical sensor state (part present/absent)</li>
                  <li>Based on cycle requirements, activates selected solenoid valve(s)</li>
                </ul>
                
                <p style="margin-top:1rem;"><strong>41F-1Z-C2-5 Relay Control Sequence:</strong></p>
                <div style="background:rgba(15,23,42,0.5);padding:1rem;border-radius:0.5rem;margin-top:0.75rem;">
                  <ol style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                    <li><strong>Controller Output:</strong> DN31C01 sends HIGH signal to relay control pin</li>
                    <li><strong>Relay Coil Energizes:</strong> Control signal energizes relay coil (A1/A2)</li>
                    <li><strong>Contacts Close:</strong> Internal contacts (11-14) close, connecting +24V to solenoid</li>
                    <li><strong>Power Path:</strong> Red Terminal (+24V) ‚Üí Pin 2 ‚Üí Relay (11-14) ‚Üí Pin 1 ‚Üí Solenoid V+</li>
                    <li><strong>Solenoid Energizes:</strong> 24V flows through solenoid coil ‚Üí valve opens</li>
                    <li><strong>Air Flows:</strong> Compressed air (80-100 PSI) flows through valve to pneumatic actuator</li>
                    <li><strong>Actuator Works:</strong> Clamp, eject, blow-off, or other pneumatic action occurs</li>
                    <li><strong>De-energize:</strong> Controller outputs LOW ‚Üí relay coil releases ‚Üí contacts open ‚Üí solenoid closes</li>
                  </ol>
                </div>
                
                <div class="info-box" style="margin-top:1rem;">
                  <h4>41F-1Z-C2-5 Relay Function:</h4>
                  <p style="color:#cbd5e1;margin-top:0.5rem;">The relay provides electrical isolation between the 5V logic control (DN31C01) and the 24V DC power switching for solenoids. This prevents damage to the microcontroller while allowing control of high-current solenoid coils.</p>
                  <div class="specs-grid" style="margin-top:0.75rem;">
                    <div class="spec-row"><span class="spec-label">Coil Side:</span><span class="spec-value">5V control signal (A1/A2 terminals)</span></div>
                    <div class="spec-row"><span class="spec-label">Contact Side:</span><span class="spec-value">24V DC switching (11-14 terminals)</span></div>
                    <div class="spec-row"><span class="spec-label">Isolation:</span><span class="spec-value">Complete electrical isolation between logic and power</span></div>
                  </div>
                </div>
                
                <div class="specs-grid" style="margin-top:1rem;">
                  <div class="spec-row"><span class="spec-label">Solenoids:</span><span class="spec-value">4x 24VDC valves</span></div>
                  <div class="spec-row"><span class="spec-label">Air Pressure:</span><span class="spec-value">80-100 PSI regulated</span></div>
                  <div class="spec-row"><span class="spec-label">Pulse Duration:</span><span class="spec-value">Typically 50-500ms (programmable)</span></div>
                  <div class="spec-row"><span class="spec-label">Valve Response:</span><span class="spec-value">&lt;10ms actuation time</span></div>
                  <div class="spec-row"><span class="spec-label">Return Path:</span><span class="spec-value">Solenoid GND ‚Üí Pin 5 ‚Üí Black Terminal (0V)</span></div>
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">5</div>
                <div class="step-title">Position Confirmation & Feedback</div>
              </div>
              <div class="step-content">
                <p><strong>Verification Process:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li><strong>Step Counter:</strong> Confirms actual steps match commanded steps</li>
                  <li><strong>Optical Sensor:</strong> Validates part presence at expected position</li>
                  <li><strong>Limit Switch Status:</strong> Ensures Y-axis is within safe travel bounds</li>
                  <li><strong>Position Error Check:</strong> Compares encoder (if present) vs step count</li>
                </ul>
                
                <p style="margin-top:1rem;"><strong>Status Reporting to Main Controller:</strong></p>
                <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:0.75rem;margin-top:0.75rem;">
                  <p style="color:#22c55e;font-weight:600;margin-bottom:0.5rem;">SUCCESS Conditions:</p>
                  <ul style="margin-left:1.5rem;color:#cbd5e1;">
                    <li>Position reached within tolerance (¬±2 steps typical)</li>
                    <li>No limit switch violations</li>
                    <li>Optical sensor confirms expected part state</li>
                    <li>Motor holding torque maintained</li>
                    <li>All relay-controlled solenoids completed their cycles</li>
                  </ul>
                  <p style="color:#cbd5e1;margin-top:0.5rem;">‚Üí Controller sends <strong>MOVE_COMPLETE</strong> signal to main system</p>
                </div>
                
                <div class="warning-box" style="margin-top:1rem;">
                  <h4>‚ö†Ô∏è ERROR Conditions:</h4>
                  <ul style="margin-left:1.5rem;">
                    <li><strong>Position Error:</strong> Actual position differs from target by &gt;5 steps</li>
                    <li><strong>Sensor Mismatch:</strong> Optical sensor state doesn't match expected</li>
                    <li><strong>Timeout:</strong> Motion did not complete within allocated time</li>
                    <li><strong>Limit Violation:</strong> Unexpected trigger of Y-END or Y-START</li>
                    <li><strong>Relay Failure:</strong> Solenoid did not activate (relay stuck or coil open)</li>
                  </ul>
                  <p style="color:#cbd5e1;margin-top:0.5rem;">‚Üí Controller sends <strong>FAULT</strong> signal and halts system</p>
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">6</div>
                <div class="step-title">Cycle Complete & Idle State</div>
              </div>
              <div class="step-content">
                <p><strong>Post-Motion Actions:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>Motor remains energized (EN = LOW) to hold position</li>
                  <li>All 41F relays return to de-energized state (contacts open)</li>
                  <li>Current position stored as "last known good position"</li>
                  <li>System returns to READY state awaiting next command</li>
                  <li>All solenoid valves confirmed closed (no air flow)</li>
                </ul>
                
                <p style="margin-top:1rem;"><strong>Idle Power Management:</strong></p>
                <ul style="margin-left:1.5rem;margin-top:0.5rem;">
                  <li>After idle timeout (e.g., 30 seconds), driver may reduce motor current</li>
                  <li>Maintains holding torque but reduces heat generation</li>
                  <li>Full current restored immediately upon next motion command</li>
                  <li>Relays consume no power when de-energized (open contacts)</li>
                </ul>
                
                <div class="info-box" style="margin-top:1rem;">
                  <h4>Continuous Operation Mode:</h4>
                  <p style="color:#cbd5e1;margin-top:0.5rem;">In production cycles, the Left Rear Feeder typically operates in rapid succession:</p>
                  <ol style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;margin-top:0.5rem;">
                    <li>Move to Position A ‚Üí Activate relay 1 ‚Üí Fire solenoid 1 ‚Üí Detect part</li>
                    <li>Move to Position B ‚Üí Activate relay 2 ‚Üí Fire solenoid 2 ‚Üí Confirm feed</li>
                    <li>Return to Home ‚Üí All relays off ‚Üí Wait for next cycle trigger</li>
                  </ol>
                  <p style="color:#cbd5e1;margin-top:0.75rem;">Total cycle time: typically 1-3 seconds depending on travel distance and dwell times.</p>
                </div>
              </div>
            </div>
            
            <div class="info-box" style="margin-top:2rem;">
              <h4>üîß Key Operational Parameters:</h4>
              <div class="specs-grid" style="margin-top:1rem;">
                <div class="spec-row"><span class="spec-label">Max Y-Axis Speed:</span><span class="spec-value">Depends on step frequency (e.g., 2000 steps/sec)</span></div>
                <div class="spec-row"><span class="spec-label">Acceleration Ramp:</span><span class="spec-value">Programmable (typical: 500-2000 steps/sec¬≤)</span></div>
                <div class="spec-row"><span class="spec-label">Positioning Accuracy:</span><span class="spec-value">¬±0.05mm (depends on microstep resolution)</span></div>
                <div class="spec-row"><span class="spec-label">Repeatability:</span><span class="spec-value">¬±0.02mm with encoder feedback</span></div>
                <div class="spec-row"><span class="spec-label">Travel Range:</span><span class="spec-value">Y-START to Y-END (measured during setup)</span></div>
                <div class="spec-row"><span class="spec-label">Holding Torque:</span><span class="spec-value">NEMA 23 rated torque at rated current</span></div>
                <div class="spec-row"><span class="spec-label">Relay Type:</span><span class="spec-value">41F-1Z-C2-5 (4x relays for solenoid control)</span></div>
              </div>
            </div>
            
            <div class="warning-box" style="margin-top:1.5rem;">
              <h4>‚ö†Ô∏è Safety & Maintenance Notes:</h4>
              <ul>
                <li><strong>Emergency Stop:</strong> E-stop immediately de-energizes stepper driver (EN = HIGH) and all relays</li>
                <li><strong>Position Loss:</strong> Power interruption requires re-homing before resuming operations</li>
                <li><strong>Relay Inspection:</strong> Periodically check 41F relay contacts for wear or pitting</li>
                <li><strong>Regular Checks:</strong> Verify limit switch function, optical sensor cleanliness, air pressure (80-100 PSI)</li>
                <li><strong>Cable Strain:</strong> Inspect motor and solenoid cables for wear at flex points during Y-axis travel</li>
                <li><strong>Lubrication:</strong> Keep Y-axis linear guides properly lubricated per maintenance schedule</li>
              </ul>
            </div>
          </div>
        </div>
        `
      },
      'right-feeder': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">üîå</span>Signal Flow</button>
            <button class="tab-btn" data-tab="technical"><span class="tab-icon">üîß</span>Technical</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">Right Rear Feeder - X-Axis Motor & Pneumatic Control</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">The Right Rear Feeder subsystem drives the X-axis stepper motor, reads optical sensors, and controls six pneumatic solenoid valves with associated surge protection circuits. This system handles precise horizontal positioning and multiple pneumatic operations for the right rear station.</p>
            
            <div class="info-box">
              <h4>Core Functions:</h4>
              <ul>
                <li><strong>X-Axis Motion:</strong> Moves right rear cradle/feeder horizontally along X-axis rail</li>
                <li><strong>Position Detection:</strong> EE-SX950W optical sensor for homing and part presence</li>
                <li><strong>Pneumatic Control:</strong> Six solenoid valves for clamps, ejectors, and actuators</li>
                <li><strong>Surge Protection:</strong> Six CAP circuits protect against inductive kickback</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>Key Components:</h4>
              <ul>
                <li><strong>Controller:</strong> DN31C01 microcontroller (5V logic)</li>
                <li><strong>Stepper Motor:</strong> X-Axis bipolar stepper motor (4-wire: A+/A‚àí, B+/B‚àí)</li>
                <li><strong>Stepper Driver:</strong> FMDD50D40 NOM Driver, 24V DC power (DC:20-50V input)</li>
                <li><strong>Optical Sensor:</strong> 1x EE-SX950W (24V, 3-wire)</li>
                <li><strong>Solenoid Valves:</strong> 6x 24VDC pneumatic control</li>
                <li><strong>CAP Circuits:</strong> 6x surge protection circuits</li>
              </ul>
            </div>
            
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Axis:</span><span class="spec-value">X-Axis (Horizontal)</span></div>
              <div class="spec-row"><span class="spec-label">Power Supply:</span><span class="spec-value">Dinkle 24V PSU (DC:20-50V)</span></div>
              <div class="spec-row"><span class="spec-label">Control Power:</span><span class="spec-value">Mean Well 5V supply</span></div>
              <div class="spec-row"><span class="spec-label">Branch Circuit:</span><span class="spec-value">120V AC "Right Rear Feeder Control"</span></div>
              <div class="spec-row"><span class="spec-label">Total Solenoids:</span><span class="spec-value">6 valves with individual CAP protection</span></div>
            </div>
            
            <div class="warning-box">
              <h4>‚ö†Ô∏è Safety & Architecture:</h4>
              <ul>
                <li>Dedicated 120V branch from 240V split-phase distribution</li>
                <li>Protected by Doepke G16 + Nader NDB1L-32</li>
                <li>Each solenoid paired with CAP circuit for spike suppression</li>
                <li>All signals referenced to common ground system</li>
              </ul>
            </div>
          </div>
          
                    <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Right Rear Feeder Power & Signal Flow</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">Complete electrical power distribution and control signal paths for the Right Rear Feeder X-axis subsystem. <strong style="color:#fbbf24;">Click any component</strong> for detailed specifications.</p>
            
            <div style="display:flex;flex-direction:column;align-items:center;gap:2rem;padding:2rem;background:rgba(15,23,42,0.5);border-radius:1rem;overflow-x:auto;">
              
              <!-- AC INPUT CHAIN -->
              <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;">
                <div class="clickable-component flow-box flow-box-red" data-component="wall-ac" style="width:220px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">WALL AC</strong><br>
                  <span style="font-size:0.9rem;">200-240V</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-orange" data-component="nader" style="width:240px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">NADER NDB1L-32</strong><br>
                  <span style="font-size:0.9rem;">RCBO Protection</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-orange" data-component="doepke" style="width:240px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">DOEPKE G16</strong><br>
                  <span style="font-size:0.9rem;">Ground Fault Detection</span>
                </div>
                
                <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                
                <div class="clickable-component flow-box flow-box-yellow" data-component="ukk80" style="width:220px;text-align:center;padding:1rem;">
                  <strong style="font-size:1.1rem;">UKK80 L2/N2</strong><br>
                  <span style="font-size:0.9rem;">120V AC Distribution</span>
                </div>
              </div>
              
              <!-- POWER SUPPLY SPLIT -->
              <div style="display:flex;gap:5rem;margin-top:2rem;flex-wrap:wrap;justify-content:center;align-items:flex-start;">
                
                <!-- LEFT SIDE: 24V PSU BRANCH -->
                <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;min-width:320px;">
                  <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                  <div class="clickable-component flow-box flow-box-green" data-component="dinkle-24v" style="width:220px;text-align:center;padding:1rem;">
                    <strong style="font-size:1.1rem;">DINKLE 24V PSU</strong><br>
                    <span style="font-size:0.9rem;">DC:20-50V</span>
                  </div>
                  
                  <!-- 24V splits THREE ways -->
                  <div style="display:flex;gap:2rem;margin-top:1rem;flex-wrap:wrap;justify-content:center;">
                    
                    <!-- Path 1: To Driver Power -->
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
                      <div style="font-size:2rem;color:#a78bfa;font-weight:700;">‚Üì V+/V-</div>
                      <div class="clickable-component flow-box flow-box-purple" data-component="nom-driver" style="width:180px;text-align:center;padding:1rem;">
                        <strong style="font-size:1rem;">NOM DRIVER</strong><br>
                        <span style="font-size:0.85rem;">FMDD50D40</span>
                        <div style="margin-top:0.75rem;padding-top:0.75rem;border-top:2px dashed rgba(251,191,36,0.5);">
                          <div style="font-size:0.8rem;color:#fbbf24;font-weight:600;">‚Üê 5V logic</div>
                          <div style="font-size:0.75rem;color:#fbbf24;">(PU, DR, MF)</div>
                        </div>
                      </div>
                      <div style="font-size:2.5rem;color:#a78bfa;font-weight:bold;">‚Üì</div>
                      <div class="clickable-component flow-box flow-box-red" data-component="x-motor" style="width:180px;text-align:center;padding:1rem;">
                        <strong style="font-size:1rem;">X-AXIS MOTOR</strong><br>
                        <span style="font-size:0.85rem;">Bipolar Stepper</span>
                      </div>
                    </div>
                    
                    <!-- Path 2: To EE-SX950W Sensor -->
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
                      <div style="font-size:2rem;color:#10b981;font-weight:700;">‚Üì Vcc</div>
                      <div class="clickable-component flow-box flow-box-green" data-component="ee-sx950w" style="width:180px;text-align:center;padding:1rem;">
                        <strong style="font-size:1rem;">EE-SX950W</strong><br>
                        <span style="font-size:0.85rem;">Optical Sensor</span>
                        <div style="margin-top:0.75rem;padding-top:0.75rem;border-top:2px dashed rgba(251,191,36,0.5);">
                          <div style="font-size:0.75rem;color:#fbbf24;font-weight:600;">OUT1 ‚Üí DN31C01</div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Path 3: To Red Phoenix Terminal -->
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1rem;">
                      <div style="font-size:2rem;color:#f87171;font-weight:700;">‚Üì 24V</div>
                      <div class="clickable-component flow-box flow-box-red" data-component="red-phoenix" style="width:180px;text-align:center;background:rgba(220,38,38,0.3);border:3px solid #dc2626;padding:1rem;">
                        <strong style="font-size:1rem;">RED PHOENIX</strong><br>
                        <span style="font-size:0.85rem;">Terminal Block</span>
                      </div>
                      
                      <!-- Red Phoenix splits to Relay and CAP -->
                      <div style="display:flex;gap:2rem;margin-top:0.5rem;">
                        <div style="display:flex;flex-direction:column;align-items:center;gap:0.75rem;">
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì Pin 11</div>
                          <div class="clickable-component flow-box flow-box-orange" data-component="relays" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">RELAY (6x)</strong><br>
                            <span style="font-size:0.8rem;">41F-1ZC2-5</span>
                            <div style="margin-top:0.5rem;padding-top:0.5rem;border-top:2px dashed rgba(251,191,36,0.5);pointer-events:none;">
                              <div style="font-size:0.75rem;color:#fbbf24;font-weight:600;">‚Üê A1/A2</div>
                            </div>
                          </div>
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì Pin 14</div>
                          <div class="clickable-component flow-box flow-box-green" data-component="solenoids" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">SOLENOIDS</strong><br>
                            <span style="font-size:0.8rem;">6x 24VDC</span>
                          </div>
                        </div>
                        
                        
                        <div style="display:flex;flex-direction:column;align-items:center;gap:0.75rem;">
                          <div style="font-size:1.5rem;color:#f87171;font-weight:bold;">‚Üì</div>
                          <div class="clickable-component flow-box flow-box-yellow" data-component="cap-circuits" style="width:140px;text-align:center;padding:0.75rem;">
                            <strong style="font-size:0.95rem;">CAP CIRCUITS</strong><br>
                            <span style="font-size:0.8rem;">6x Protection</span>
                            <div style="margin-top:0.5rem;font-size:0.7rem;color:#94a3b8;line-height:1.4;">
                              5√ó V+/GND<br>
                              1√ó V+/Cathode
                            </div>
                          </div>
                        </div>
                      </div>
                      
                    </div>
                    
                  </div>
                </div>
                
                <!-- RIGHT SIDE: 5V PSU BRANCH -->
                <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;min-width:320px;">
                  <div style="font-size:3rem;color:#60a5fa;font-weight:bold;">‚Üì</div>
                  <div class="clickable-component flow-box flow-box-green" data-component="meanwell-5v" style="width:220px;text-align:center;padding:1rem;">
                    <strong style="font-size:1.1rem;">MEAN WELL 5V PSU</strong><br>
                    <span style="font-size:0.9rem;">5V Logic Power</span>
                  </div>
                  
                  <!-- 5V Logic Loop Box -->
                  <div style="margin-top:1.5rem;padding:2rem;background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(139,92,246,0.05));border:3px solid #8b5cf6;border-radius:1rem;min-width:300px;box-shadow:0 4px 20px rgba(139,92,246,0.3);">
                    <div style="text-align:center;color:#8b5cf6;font-weight:700;font-size:1.1rem;margin-bottom:1.5rem;text-transform:uppercase;">5V Logic Loop</div>
                    
                    <div style="display:flex;flex-direction:column;align-items:center;gap:1.5rem;">
                      
                      <!-- 5V PSU text at top -->
                      <div style="font-size:0.95rem;color:#8b5cf6;font-weight:600;text-align:center;">5V from PSU ‚Üì</div>
                      
                      <!-- DN31C01 -->
                      <div class="clickable-component flow-box flow-box-cyan" data-component="dn31c01" style="width:200px;text-align:center;border:4px solid #06b6d4;padding:1rem;box-shadow:0 0 20px rgba(6,182,212,0.5);">
                        <strong style="font-size:1.1rem;">DN31C01</strong><br>
                        <span style="font-size:0.9rem;">MicroController</span>
                        <div style="margin-top:0.75rem;font-size:0.85rem;color:#fbbf24;font-weight:700;">"PLC BRAIN"</div>
                      </div>
                      
                      <!-- Control signals down arrow -->
                      <div style="font-size:2rem;color:#fbbf24;font-weight:bold;">‚Üì</div>
                      <div style="font-size:0.9rem;color:#fbbf24;font-weight:600;">PU+/PU‚àí, DR+/DR‚àí signals</div>
                      <div style="font-size:2rem;color:#fbbf24;font-weight:bold;">‚Üì</div>
                      
                      <!-- Connects to Driver BOX -->
                      <div style="background:linear-gradient(135deg,rgba(168,85,247,0.3),rgba(147,51,234,0.25));border:3px solid #a855f7;border-radius:0.75rem;padding:1.25rem;width:220px;text-align:center;box-shadow:0 4px 15px rgba(168,85,247,0.4);">
                        <div style="font-size:1rem;color:#e9d5ff;font-weight:700;margin-bottom:0.5rem;">Connects to NOM Driver</div>
                        <div style="font-size:0.85rem;color:#cbd5e1;">(PU, DR, MF terminals)</div>
                      </div>
                      
                      <!-- Loop arrow back -->
                      <div style="font-size:2rem;color:#8b5cf6;font-weight:bold;">‚Üì</div>
                      <div style="font-size:0.95rem;color:#8b5cf6;font-weight:600;text-align:center;">Back to 5V PSU</div>
                      
                    </div>
                    
                  </div>

                  <!-- Control summary -->
                  <div style="margin-top:1.5rem;padding:1.25rem;background:rgba(6,182,212,0.1);border:2px dashed #06b6d4;border-radius:0.75rem;width:100%;max-width:300px;">
                    <div style="font-size:1rem;font-weight:700;color:#06b6d4;text-align:center;margin-bottom:0.75rem;">DN31C01 CONTROLS:</div>
                    <div style="font-size:0.9rem;color:#cbd5e1;line-height:2;">
                      <div style="font-weight:600;">‚Üí NOM Driver (PU, DR, MF)</div>
                      <div style="font-weight:600;">‚Üí 6x Solenoid Relays</div>
                      <div style="font-weight:600;">‚Üê EE-SX950W (OUT1)</div>
                    </div>
                  </div>
                  
                </div>
                
              </div>
              
            </div>

            <!-- Legend -->
            <div style="margin-top:2.5rem;padding:1.75rem;background:rgba(30,41,59,0.6);border-radius:0.75rem;border-left:5px solid #60a5fa;">
              <h4 style="color:#60a5fa;margin-bottom:1.25rem;font-size:1.2rem;">Power & Signal Legend</h4>
              <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.25rem;color:#cbd5e1;font-size:1rem;">
                <div><strong style="color:#a78bfa;font-size:1.1rem;">Purple (V+/V-):</strong> 24V Motor Power</div>
                <div><strong style="color:#f87171;font-size:1.1rem;">Red (24V):</strong> Solenoid Power (6x)</div>
                <div><strong style="color:#8b5cf6;font-size:1.1rem;">Purple Loop:</strong> 5V Logic Circuit</div>
                <div><strong style="color:#fbbf24;font-size:1.1rem;">Yellow Text:</strong> Control Signals</div>
                <div><strong style="color:#06b6d4;font-size:1.1rem;">Cyan Border:</strong> Central Controller</div>
                <div><strong style="color:#10b981;font-size:1.1rem;">Green:</strong> Optical Sensor (24V)</div>
              </div>
            </div>

            <!-- Special Note about CAP Circuits -->
            <div style="margin-top:1.5rem;padding:1.5rem;background:rgba(251,191,36,0.1);border:2px solid #fbbf24;border-radius:0.75rem;">
              <h4 style="color:#fbbf24;margin-bottom:1rem;font-size:1.1rem;">‚ö° Right Rear Feeder Pneumatic Configuration</h4>
              <p style="color:#cbd5e1;line-height:1.8;">
                The Right Rear Feeder has <strong>6 solenoid valves</strong> (vs. 4 on Left Feeder) for increased pneumatic control capability at the right rear station. Each solenoid is protected by its own CAP circuit:<br><br>
                <strong style="color:#fbbf24;">Standard Configuration (5x):</strong> V+ / GND CAP circuits for typical inductive spike suppression<br>
                <strong style="color:#fbbf24;">Special Configuration (1x):</strong> V+ / Cathode CAP circuit with reversed diode polarity for a specific solenoid channel requiring different transient handling
              </p>
            </div>
            
            <div class="info-box" style="margin-top:1.5rem;">
              <h4>Power Distribution Architecture Summary:</h4>
              <p style="color:#cbd5e1;line-height:1.6;">The Right Rear Feeder uses a dual-voltage power architecture with dedicated 120V AC branch circuit "Right Rear Feeder Control" from UKK80 L2/N2 distribution blocks. <strong>24V DC</strong> (Dinkle PSU) powers the NOM stepper driver, EE-SX950W sensor, 6 solenoid outputs, and 6 CAP protection circuits. <strong>5V DC</strong> (Mean Well PSU) provides clean logic power for DN31C01 microcontroller and control signals. Both supplies are independently regulated with proper grounding through Yellow Green TB protective earth bonding.</p>
            </div>
          </div>
          
          <div class="tab-content" id="tab-technical">
            <h3 class="section-title">Right Rear Feeder Technical Specifications</h3>
            
            <!-- POWER SYSTEM -->
            <h4 style="color:#60a5fa;font-weight:700;margin:2rem 0 1rem;font-size:1.2rem;">‚ö° Power Distribution System</h4>
            
            <div class="info-box">
              <h4>Dinkle Series 24V Power Supply</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Converts 120V AC to regulated 24V DC for motor driver, sensors, and pneumatic control. Primary power source for the Right Rear Feeder subsystem.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Dinkle Series 24V Supply</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V AC from UKK80 L2/N2</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">DC:20-50V V+ / V‚àí</span></div>
                <div class="spec-row"><span class="spec-label">Status:</span><span class="spec-value">DC OK relay contact</span></div>
                <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix DIN rail terminals (red/black)</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Primary Connections:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>Line:</strong> Hot from UKK80 L2</li>
                <li><strong>Neutral:</strong> Neutral from UKK80 N2</li>
                <li><strong>Earth:</strong> Cabinet ground bar</li>
                <li><strong>V+:</strong> To Phoenix red terminals ‚Üí all 24V loads</li>
                <li><strong>V‚àí:</strong> To Phoenix black terminals ‚Üí all 24V returns</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>Mean Well 5V Power Supply</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Provides regulated 5V DC for DN31C01 microcontroller and control logic circuits.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Mean Well switching supply</span></div>
                <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V AC from cabinet</span></div>
                <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">5V Pos / 5V Neg</span></div>
                <div class="spec-row"><span class="spec-label">Distribution:</span><span class="spec-value">Phoenix red (5V+) and black (5V‚àí)</span></div>
              </div>
            </div>
            
            <div class="info-box">
              <h4>UKK80 AC Distribution Blocks</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> DIN rail terminal blocks that distribute 120V AC hot and neutral inside the right-side cabinet.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">UKK80 screw-clamp terminal blocks</span></div>
                <div class="spec-row"><span class="spec-label">UKK80 L2:</span><span class="spec-value">Hot (Line) distribution</span></div>
                <div class="spec-row"><span class="spec-label">UKK80 N2:</span><span class="spec-value">Neutral distribution</span></div>
              </div>
            </div>
            
            <!-- CONTROL & MOTION -->
            <h4 style="color:#60a5fa;font-weight:700;margin:2rem 0 1rem;font-size:1.2rem;">üéÆ Control & Motion System</h4>
            
            <div class="info-box">
              <h4>DN31C01 Microcontroller</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Central motion controller and I/O processor for the Right Rear Feeder. Manages stepper commands, sensor inputs, and solenoid activation sequences.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Motion control microcontroller</span></div>
                <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V DC from Mean Well supply</span></div>
                <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB connection</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Control Outputs:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>PU+ / PU‚àí:</strong> Differential step pulses to driver</li>
                <li><strong>DR+ / DR‚àí:</strong> Differential direction signal</li>
                <li><strong>MF+ / MF‚àí:</strong> Motor-free / enable signal</li>
                <li><strong>Solenoid channels:</strong> Digital outputs to upstream relays</li>
              </ul>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Sensor Inputs:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>EE-SX950W OUT1:</strong> Optical sensor signal</li>
                <li><strong>Position feedback:</strong> For homing and limit detection</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>FMDD50D40 NOM Stepper Driver</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Bipolar stepper driver that converts logic pulses from DN31C01 into precise motor coil currents for X-axis motion control.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">FMDD50D40 NOM Driver</span></div>
                <div class="spec-row"><span class="spec-label">Power Input:</span><span class="spec-value">DC:20-50V (24V typical)</span></div>
                <div class="spec-row"><span class="spec-label">Control Inputs:</span><span class="spec-value">PU+/PU‚àí, DR+/DR‚àí, MF+/MF‚àí</span></div>
                <div class="spec-row"><span class="spec-label">Motor Outputs:</span><span class="spec-value">A+, A‚àí, B+, B‚àí (bipolar)</span></div>
              </div>
              <div class="note-callout" style="margin-top:1rem;">
                <strong>Signal Chain:</strong> DN31C01 (commands) ‚Üí NOM Driver (current shaping) ‚Üí X-Axis Stepper (motion)
              </div>
            </div>
            
            <div class="info-box">
              <h4>X-Axis Stepper Motor (Right Rear Feeder)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Bipolar stepper motor that drives the right rear feeder carriage horizontally along the X-axis rail for precise component positioning.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">4-wire bipolar stepper</span></div>
                <div class="spec-row"><span class="spec-label">Phase A:</span><span class="spec-value">A+ (Red), A‚àí (Green)</span></div>
                <div class="spec-row"><span class="spec-label">Phase B:</span><span class="spec-value">B+ (Yellow), B‚àí (Blue)</span></div>
                <div class="spec-row"><span class="spec-label">Mounting:</span><span class="spec-value">Right rear feeder carriage</span></div>
              </div>
            </div>
            
            <!-- SENSORS -->
            <h4 style="color:#60a5fa;font-weight:700;margin:2rem 0 1rem;font-size:1.2rem;">üëÅÔ∏è Sensing System</h4>
            
            <div class="info-box">
              <h4>EE-SX950W Optical Sensor</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Through-beam optical slot sensor for home position detection, end-of-travel limits, and part presence verification on the Right Rear Feeder carriage.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">3-wire transmissive photoelectric sensor</span></div>
                <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">Vcc ‚Üí 24V from Dinkle supply</span></div>
                <div class="spec-row"><span class="spec-label">Signal:</span><span class="spec-value">OUT1 ‚Üí DN31C01 input</span></div>
                <div class="spec-row"><span class="spec-label">Ground:</span><span class="spec-value">GND ‚Üí 0V reference</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Detection Modes:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>Homing:</strong> Establishes zero reference position</li>
                <li><strong>Limit Detection:</strong> Prevents overtravel</li>
                <li><strong>Part Presence:</strong> Verifies component in pocket/station</li>
              </ul>
              <div class="note-callout" style="margin-top:1rem;">
                <strong>Operation:</strong> When interrupter flag blocks beam, OUT1 toggles state ‚Üí DN31C01 reads digital signal for position/presence feedback.
              </div>
            </div>
            
            <!-- PNEUMATICS -->
            <h4 style="color:#60a5fa;font-weight:700;margin:2rem 0 1rem;font-size:1.2rem;">üí® Pneumatic Control System</h4>
            
            
            <div class="info-box">
              <h4>41F-1ZC2-5 Relay (6x)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Electromechanical relays that switch 24V power to solenoid valves based on DN31C01 control signals. Provides electrical isolation between 5V logic and 24V power systems.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1ZC2-5</span></div>
                <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">6 relays (one per solenoid)</span></div>
                <div class="spec-row"><span class="spec-label">Coil Terminals:</span><span class="spec-value">A1, A2 (control input from DN31C01)</span></div>
                <div class="spec-row"><span class="spec-label">Contact Terminals:</span><span class="spec-value">11, 14 (switched output to solenoid)</span></div>
                <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC (or 5V control via DN31C01)</span></div>
                <div class="spec-row"><span class="spec-label">Contact Rating:</span><span class="spec-value">Switches 24V DC to solenoid coils</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Operation Sequence:</strong></p>
              <ol style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>DN31C01 Output:</strong> Controller sends control signal to relay coil terminal A1</li>
                <li><strong>Coil Energizes:</strong> Current flows through coil (A1 to A2), creating magnetic field</li>
                <li><strong>Contacts Close:</strong> Internal relay contacts close, connecting Pin 11 to Pin 14</li>
                <li><strong>Power Flow:</strong> +24V flows from Red Phoenix Terminal ‚Üí Pin 11 ‚Üí Pin 14 ‚Üí Solenoid V+</li>
                <li><strong>Solenoid Activates:</strong> 24V energizes solenoid coil, valve opens</li>
                <li><strong>De-energize:</strong> When DN31C01 removes signal, relay opens, solenoid de-energizes</li>
              </ol>
              <div class="note-callout" style="margin-top:1rem;">
                <strong>Electrical Isolation:</strong> The relay electromagnetically isolates the low-voltage 5V microcontroller logic from the high-current 24V solenoid power, preventing damage to sensitive electronics while enabling control of pneumatic actuators.
              </div>
            </div>
            <div class="info-box">
              <h4>24VDC Solenoid Valves (6x)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Electromagnetic pneumatic valves that control compressed air flow to actuators for clamps, ejectors, and mechanical operations at the right rear feeder station.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">6 solenoid outputs</span></div>
                <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC</span></div>
                <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">V+ (24V switched) / GND (return)</span></div>
                <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">Via upstream relay/driver (DN31C01)</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Current Path (when energized):</strong></p>
              <div style="color:#cbd5e1;font-family:monospace;background:rgba(0,0,0,0.3);padding:0.75rem;border-radius:0.5rem;margin-top:0.5rem;line-height:1.6;">
Phoenix Red (24V+) ‚Üí Upstream Relay/Driver ‚Üí V+ Solenoid ‚Üí Coil ‚Üí GND Solenoid ‚Üí Phoenix Black (0V) ‚Üí Dinkle PSU V‚àí
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Typical Functions:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li>Component clamping and holding</li>
                <li>Part ejection and transfer</li>
                <li>Air blast for cleaning/clearing</li>
                <li>Actuator positioning control</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>CAP Circuits - Surge Protection (6x Total)</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Snubber/suppression networks that absorb voltage spikes when solenoid coils de-energize, protecting relay contacts and preventing electrical noise from coupling into control circuits.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Standard CAP:</span><span class="spec-value">5x V+ / GND configuration</span></div>
                <div class="spec-row"><span class="spec-label">Special CAP:</span><span class="spec-value">1x V+ / Cathode (diode-oriented)</span></div>
                <div class="spec-row"><span class="spec-label">Components:</span><span class="spec-value">RC network or diode + capacitor</span></div>
                <div class="spec-row"><span class="spec-label">Mounting:</span><span class="spec-value">Parallel with each solenoid coil</span></div>
              </div>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Protection Mechanism:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>Relay ON:</strong> Solenoid energizes, CAP charges to 24V</li>
                <li><strong>Relay OFF:</strong> Magnetic field in coil begins to collapse</li>
                <li><strong>Inductive Kick:</strong> Collapsing field generates voltage spike (100+ volts)</li>
                <li><strong>CAP Clamps:</strong> RC/diode network absorbs transient energy</li>
                <li><strong>Result:</strong> Voltage limited, relay protected, 24V rail stays clean</li>
              </ul>
              <div class="note-callout" style="margin-top:1rem;">
                <strong>V+ / Cathode Circuit:</strong> The special cathode-referenced CAP circuit indicates reversed diode polarity for a specific solenoid channel that may require different spike handling characteristics.
              </div>
            </div>
            
            <!-- WIRING & INTEGRATION -->
            <h4 style="color:#60a5fa;font-weight:700;margin:2rem 0 1rem;font-size:1.2rem;">üîå Wiring & Integration</h4>
            
            <div class="info-box">
              <h4>Field Wiring & Harness</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Interconnection system between cabinet electronics and field devices on the right rear feeder mechanism.</p>
              <p style="margin-top:0.75rem;color:#94a3b8;"><strong>Key Interconnections:</strong></p>
              <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
                <li><strong>SPLICE Connections:</strong> Field joints in harness (marked on schematics)</li>
                <li><strong>WAGO Blocks:</strong> Quick-connect junctions for maintenance access</li>
                <li><strong>Harness Routing:</strong> Notes indicate physical locations (e.g., "Under CRDLE.ROT", "CRDLE_SQUECEC")</li>
                <li><strong>Cable Management:</strong> Organized paths to prevent interference with motion</li>
              </ul>
              <div class="warning-box" style="margin-top:1rem;">
                <h4>‚ö†Ô∏è Service Notes:</h4>
                <p>Field harness segments are documented with physical location callouts. When troubleshooting, reference schematic notes for splice/WAGO locations relative to frame features (cradle, rotation points, etc.).</p>
              </div>
            </div>
            
            <div class="info-box">
              <h4>Grounding & Safety</h4>
              <p style="margin-bottom:0.75rem;"><strong>Function:</strong> Protective earth bonding for electrical safety and EMI reduction.</p>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Source:</span><span class="spec-value">120V branch earth from main distribution</span></div>
                <div class="spec-row"><span class="spec-label">PSU Earth:</span><span class="spec-value">Dinkle and Mean Well earth terminals</span></div>
                <div class="spec-row"><span class="spec-label">Cabinet Ground:</span><span class="spec-value">DIN rail ground bar, metal chassis bonding</span></div>
                <div class="spec-row"><span class="spec-label">Protection:</span><span class="spec-value">Doepke G16 + Nader NDB1L-32</span></div>
              </div>
            </div>
            
          </div>
          
          <div class="tab-content" id="tab-operation">
            <h3 class="section-title">Right Rear Feeder Operation Sequence</h3>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Power Up</div>
              </div>
              <div class="step-content">
                <strong>AC Path:</strong> 200-240V AC ‚Üí Main breakers (Doepke G16 + Nader NDB1L-32) ‚Üí 120V branch "Right Rear Feeder Control" ‚Üí UKK80 L2/N2 distribution blocks<br><br>
                <strong>DC Supplies:</strong><br>
                ‚Ä¢ Dinkle 24V PSU: 120V AC ‚Üí 24V DC to driver, sensor, solenoids, CAP circuits<br>
                ‚Ä¢ Mean Well 5V PSU: 120V AC ‚Üí 5V DC to DN31C01 logic and control circuits
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Idle State</div>
              </div>
              <div class="step-content">
                ‚Ä¢ DN31C01 powered and ready, communicating with main system<br>
                ‚Ä¢ Stepper driver enabled via MF signal, holding torque on X-axis if required<br>
                ‚Ä¢ EE-SX950W sensor powered (24V), OUT1 in default state (no flag interruption)<br>
                ‚Ä¢ All solenoid outputs de-energized, pneumatic valves in rest position
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">X-Axis Motion Command</div>
              </div>
              <div class="step-content">
                ‚Ä¢ DN31C01 receives move command from main controller<br>
                ‚Ä¢ Sets direction via DR+/DR‚àí differential pair to driver<br>
                ‚Ä¢ Generates step pulses on PU+/PU‚àí at commanded rate<br>
                ‚Ä¢ NOM driver shapes current into motor phases: A+/A‚àí, B+/B‚àí<br>
                ‚Ä¢ X-axis stepper rotates, moving right rear feeder carriage horizontally
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">Position & Home Feedback</div>
              </div>
              <div class="step-content">
                ‚Ä¢ As carriage moves, interrupter flag may enter EE-SX950W optical slot<br>
                ‚Ä¢ Sensor beam blocked ‚Üí OUT1 toggles state<br>
                ‚Ä¢ DN31C01 reads OUT1 transition:<br>
                &nbsp;&nbsp;‚Üí Stop motion if home position reached<br>
                &nbsp;&nbsp;‚Üí Zero X-axis reference<br>
                &nbsp;&nbsp;‚Üí Activate overtravel interlock if end limit detected<br>
                &nbsp;&nbsp;‚Üí Verify part present in expected location
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">5</div>
                <div class="step-title">Pneumatic Actions via 41F-1ZC2-5 Relays</div>
              </div>
              <div class="step-content">
                <strong>Relay Control Sequence (6x 41F-1ZC2-5 relays, one per solenoid):</strong><br><br>
                <ol style="margin-left:1.5rem;color:#cbd5e1;line-height:1.8;">
                  <li><strong>DN31C01 Activation:</strong> Controller sends control signal to relay coil terminal A1</li>
                  <li><strong>Relay Coil Energizes:</strong> Current flows through coil (A1 to A2), creating electromagnetic field</li>
                  <li><strong>Contacts Close:</strong> Relay internal contacts close, connecting Pin 11 to Pin 14</li>
                  <li><strong>24V Power Flow:</strong> Phoenix Red (24V) ‚Üí Pin 11 ‚Üí Pin 14 ‚Üí Solenoid V+</li>
                  <li><strong>Solenoid Energizes:</strong> 24V flows through solenoid coil ‚Üí electromagnet engages ‚Üí valve shifts</li>
                  <li><strong>Pneumatic Action:</strong> Compressed air (80-100 PSI) flows through valve to actuator</li>
                  <li><strong>Mechanical Result:</strong> Clamp, eject, transfer, or other pneumatic action occurs</li>
                  <li><strong>De-energize:</strong> DN31C01 removes signal ‚Üí relay opens ‚Üí solenoid spring-returns to rest position</li>
                </ol>
                <div class="note-callout" style="margin-top:1rem;">
                  <strong>Electrical Isolation:</strong> The 41F-1ZC2-5 relay provides critical isolation between the 5V microcontroller logic (DN31C01) and the 24V solenoid power system, preventing damage to sensitive electronics.
                </div>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">6</div>
                <div class="step-title">CAP Circuit Protection (During Solenoid Switching)</div>
              </div>
              <div class="step-content">
                ‚Ä¢ <strong>When relay/driver closes:</strong> 24V applied, solenoid energizes, CAP circuit capacitor charges to 24V<br>
                ‚Ä¢ <strong>When relay/driver opens:</strong> Solenoid coil current stops, magnetic field collapses<br>
                ‚Ä¢ <strong>Inductive kickback:</strong> Collapsing field generates voltage spike (can exceed 100V)<br>
                ‚Ä¢ <strong>CAP absorbs spike:</strong> RC network or diode clamps transient, dissipates energy safely<br>
                ‚Ä¢ <strong>Protection achieved:</strong> Relay contacts protected from arcing, 24V rail stays clean, no noise injected into signal wires
              </div>
            </div>
            
            <div class="info-box" style="margin-top:2rem;">
              <h4>Service & Debugging Access Points</h4>
              <ul style="color:#cbd5e1;line-height:1.8;margin-left:1.5rem;">
                <li><strong>UKK80 L2/N2:</strong> Check for incoming 120V AC to feeder branch (should read ~120V AC)</li>
                <li><strong>Dinkle PSU Terminals:</strong> Verify 24V DC on V+ / V‚àí outputs (Phoenix red/black)</li>
                <li><strong>Mean Well 5V Terminals:</strong> Confirm 5V DC presence for logic circuits</li>
                <li><strong>Driver A/B Outputs:</strong> Verify proper phase wiring to stepper (A+/A‚àí, B+/B‚àí to correct colors)</li>
                <li><strong>Solenoid V+ / GND:</strong> Check for 24V when specific feeder function is commanded</li>
                <li><strong>EE-SX950W:</strong> Test Vcc (24V), OUT1 (signal transitions), GND (0V reference)</li>
                <li><strong>CAP Circuits:</strong> If solenoids cause electrical noise or relay contact wear, inspect CAP circuit integrity</li>
              </ul>
            </div>
            
            <div class="note-callout" style="margin-top:1.5rem;background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;">
              <strong>Count Summary for Right Rear Feeder X-Axis:</strong><br><br>
              ‚Ä¢ 1√ó DN31C01 microcontroller<br>
              ‚Ä¢ 1√ó NOM stepper driver (D40/D50)<br>
              ‚Ä¢ 1√ó X-axis stepper motor (4-wire bipolar)<br>
              ‚Ä¢ 1√ó EE-SX950W optical sensor<br>
              ‚Ä¢ 6√ó CAP circuits (5 standard V+/GND + 1 V+/Cathode)<br>
              ‚Ä¢ 6√ó Solenoid outputs (24V V+/GND connections)
            </div>
          </div>
        `
      },
      'air-distribution': {
        getHTML: () => `
          <div class="tab-navigation">
            <button class="tab-btn active" data-tab="overview"><span class="tab-icon">‚ÑπÔ∏è</span>Overview</button>
            <button class="tab-btn" data-tab="flow"><span class="tab-icon">üí®</span>Air Flow</button>
            <button class="tab-btn" data-tab="components"><span class="tab-icon">üîß</span>Components</button>
            <button class="tab-btn" data-tab="operation"><span class="tab-icon">‚öôÔ∏è</span>Operation</button>
          </div>
          
          <div class="tab-content active" id="tab-overview">
            <h3 class="section-title">Air Distribution & Pneumatic Control</h3>
            <p style="color:#cbd5e1;line-height:1.6;margin-bottom:1.5rem;">The Air Distribution cabinet is the heart of the pneumatic system, managing compressed air distribution through solenoid valves controlled by an Arduino Nano microcontroller. This system feeds caps/parts using precisely timed air pulses.</p>
            
            <div class="info-box">
              <h4>System Architecture:</h4>
              <ul>
                <li><strong>Microcontroller:</strong> Arduino Nano DN31C01 handles timing, sequencing, and sensor processing</li>
                <li><strong>Relay Control:</strong> 41F-1Z-C2-5 DIN-rail relays switch 24V to solenoids</li>
                <li><strong>Feeder Modules:</strong> Clay, Almond, and White independent feeder channels</li>
                <li><strong>Solenoid Manifolds:</strong> Screw Feeding and Distribution manifolds</li>
                <li><strong>Power Distribution:</strong> Red (+24V) and Black (0V) terminal blocks</li>
              </ul>
            </div>
            
            <div class="info-box">
              <h4>‚ö° Power System:</h4>
              <ul>
                <li><strong>Nader NDB1L-32:</strong> Primary circuit protection </li>
                <li><strong>Doepke G16:</strong> Ground fault detection and leakage monitoring</li>
                <li><strong>24V Power Supply:</strong> Dinkle Series DRL-24V240W1AA </li>
                <li><strong>5V Power Supply:</strong> For DN31C01 and optical sensors </li>
                <li><strong>UKK160 Terminal Blocks:</strong> AC distribution splicing hub</li>
                <li><strong>Yellow-Green TB:</strong> Protective earth bus bar (safety bonding)</li>
              </ul>
            </div>
            
            <div class="warning-box">
              <h4>‚ö†Ô∏è Critical Understanding:</h4>
              <ul>
                <li>The main machine does NOT micromanage air feeding - the DN31C01 does it independently</li>
                <li>Without this microcontroller: solenoids fire wrong, caps don't feed, system jams constantly</li>
                <li>Yellow-Green TB is ONLY for safety earth - NOT DC return (0V uses Black terminal)</li>
                <li>Only ONE feeder can be activated at a time</li>
              </ul>
            </div>
          </div>
          
          <div class="tab-content" id="tab-components">
            <h3 class="section-title">Key Components</h3>
            
            <h4 style="font-weight:700;margin:1.5rem 0 1rem;color:#60a5fa;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üñ•Ô∏è Arduino Nano DN31C01 Microcontroller</h4>
            
            <div class="info-box">
              <h4>‚≠ê Primary Role:</h4>
              <ul style="color:#cbd5e1;line-height:1.8;margin-left:1.5rem;">
                <li>Controls the air-feed solenoids</li>
                <li>Reads sensors (optical, cap-detection, limit sensors)</li>
                <li>Runs timing sequences</li>
                <li>Tracks feeder state</li>
                <li>Communicates feeder readiness to the main controller</li>
                <li>Detects jams or feed failures</li>
                <li>Provides independent control so main controller is not overloaded</li>
              </ul>
              <p style="margin-top:0.75rem;color:#fbbf24;font-weight:600;">The main machine does NOT micromanage air feeding - this microcontroller does it.</p>
            </div>
            
            <div class="info-box">
              <h4>‚≠ê Internal Processing:</h4>
              
              <h5 style="color:#60a5fa;margin-top:1rem;margin-bottom:0.5rem;">Sensor Input Processing</h5>
              <p style="color:#cbd5e1;margin-bottom:0.75rem;">Reads via digital pins (D2-D13) and analog pins (A0-A7):</p>
              <ul style="color:#cbd5e1;line-height:1.8;margin-left:1.5rem;">
                <li>Cap sensors</li>
                <li>Optical sensors</li>
                <li>Presence switches</li>
                <li>Pressure/airflow sensors (if used)</li>
              </ul>
              
              <h5 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.5rem;">Logic Decision Making</h5>
              <p style="color:#cbd5e1;margin-bottom:0.75rem;">User-programmed software makes decisions based on sensor inputs using IF/THEN logic.</p>
              
              <h5 style="color:#60a5fa;margin-top:1.5rem;margin-bottom:0.5rem;">Timing and Sequencing</h5>
              <p style="color:#cbd5e1;margin-bottom:0.75rem;">The air-feed system depends heavily on precise timing. Example sequence:</p>
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;">
                <ol style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Fire solenoid A</li>
                  <li>Wait 30ms</li>
                  <li>Fire solenoid B</li>
                  <li>Check sensor</li>
                  <li>If cap not detected, retry cycle</li>
                </ol>
              </div>
              <p style="color:#cbd5e1;margin-top:0.75rem;">The microcontroller handles: delays, pulse durations, repetition, debounce, retries, timeouts</p>
            </div>
            
            <div class="info-box">
              <h4>‚≠ê Communication with Main Controller:</h4>
              <p style="color:#cbd5e1;margin-bottom:0.75rem;">Sends status signals through digital output lines, serial (optional), or status pins:</p>
              <ul style="color:#cbd5e1;line-height:1.8;margin-left:1.5rem;">
                <li>"Ready" signals</li>
                <li>"Cap Present"</li>
                <li>"Feed Complete"</li>
                <li>"Jam Detected"</li>
                <li>"Feeder Empty"</li>
                <li>"Error / Fault"</li>
              </ul>
              <p style="margin-top:0.75rem;color:#cbd5e1;">Main controller uses these signals to coordinate with motion. This is why a dedicated MCU is needed.</p>
            </div>
            
            <div class="info-box">
              <h4>‚≠ê Power and Isolation:</h4>
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Logic Power:</span><span class="spec-value">5V (from breakout board)</span></div>
                <div class="spec-row"><span class="spec-label">Ground:</span><span class="spec-value">Shared with sensors</span></div>
                <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB-C connection</span></div>
              </div>
              
              <div class="danger-box" style="margin-top:1rem;">
                <h4>üõ°Ô∏è Protection Design:</h4>
                <ul>
                  <li>Nano NEVER powers solenoids directly</li>
                  <li>NEVER switches 24V directly</li>
                  <li>NEVER carries motor power</li>
                  <li>Instead: drives driver transistors/MOSFETs that handle 24V solenoid coils</li>
                  <li>This prevents damage and keeps signals isolated</li>
                </ul>
              </div>
            </div>
            
            <div class="danger-box">
              <h4>‚ö†Ô∏è Why This Microcontroller Is Critical:</h4>
              <p style="margin-bottom:0.75rem;color:#cbd5e1;">Without this microcontroller:</p>
              <ul style="color:#cbd5e1;line-height:1.8;">
                <li>Solenoids fire in the wrong order</li>
                <li>Caps don't feed</li>
                <li>Sensors don't get read</li>
                <li>Main controller would freeze</li>
                <li>Machine would constantly jam</li>
                <li>Timing cannot be maintained</li>
                <li>System cannot self-correct</li>
              </ul>
              <p style="margin-top:1rem;color:#fbbf24;font-weight:700;">This is the heart of the pneumatic system.</p>
            </div>
            
            <h4 style="font-weight:700;margin:2rem 0 1rem;color:#60a5fa;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üîå 41F-1Z-C2-5 Relay Socket</h4>
            
            <div class="info-box">
              <h4>Function & Purpose:</h4>
              <p style="margin-bottom:0.75rem;color:#cbd5e1;">DIN-rail mount relay socket holding a single mechanical relay (1-pole, SPDT). Switches 24V power to solenoid valves based on microcontroller commands.</p>
              
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1Z-C2-5</span></div>
                <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">1-pole, SPDT mechanical relay</span></div>
                <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24 VDC (from controller)</span></div>
                <div class="spec-row"><span class="spec-label">Contact Rating:</span><span class="spec-value">6A 250VAC / 6-24VDC/VAC</span></div>
              </div>
              
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Terminal Configuration:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>A1:</strong> Positive control voltage (from DN31C01 controller)</li>
                  <li><strong>A2:</strong> Return / 0V</li>
                  <li><strong>11:</strong> Common terminal (connects to 24V red terminal)</li>
                  <li><strong>14:</strong> Normally open terminal (output to solenoid)</li>
                  <li><strong>12:</strong> Normally closed terminal (not used in this application)</li>
                </ul>
              </div>
              
              <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>How Relay Works with Microprocessor:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Relays send ON/OFF information (0V or floating) to the microprocessor</li>
                  <li>Microprocessor reads these as TRUE/FALSE signals</li>
                  <li>Microprocessor software makes decisions using IF/THEN logic</li>
                  <li>Microprocessor sends output commands to motors, solenoids, and other relays</li>
                  <li>Flow: <strong>Inputs ‚Üí Logic ‚Üí Outputs ‚Üí Machine Movement</strong></li>
                </ul>
              </div>
            </div>
            
            <h4 style="font-weight:700;margin:2rem 0 1rem;color:#60a5fa;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üé® Feeder Solenoid Modules (Clay, Almond, White)</h4>
            
            <div class="info-box">
              <h4>Independent Feeder Channels:</h4>
              <p style="margin-bottom:0.75rem;color:#cbd5e1;">Three independent solenoid-driven pneumatic feeder channels. Each channel activates its own solenoid (air blast) for feeding caps/products into position.</p>
              
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Channels:</span><span class="spec-value">Clay, Almond, White</span></div>
                <div class="spec-row"><span class="spec-label">Operation:</span><span class="spec-value">Independent, one at a time</span></div>
                <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">Microcontroller selects which feeder to fire</span></div>
                <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">ONLY solenoid control (no sensors in connectors)</span></div>
              </div>
              
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>5-Pin Connector Pinout:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>Pin 1 (Blue):</strong> Switched +24V OUT from relay to solenoid</li>
                  <li><strong>Pin 2 (Red):</strong> Raw +24V IN (power into relay contacts from Red terminal block)</li>
                  <li><strong>Pin 3:</strong> Not used in standard configuration</li>
                  <li><strong>Pin 4 (Orange):</strong> Microcontroller control signal (relay coil control)</li>
                  <li><strong>Pin 5 (Black):</strong> Ground / 0V return path (to Black terminal strip)</li>
                </ul>
              </div>
            </div>
            
            <h4 style="font-weight:700;margin:2rem 0 1rem;color:#60a5fa;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üí® Screw Distribution Manifold</h4>
            
            <div class="info-box">
              <h4>24V DC Solenoid Coils:</h4>
              <p style="margin-bottom:0.75rem;color:#cbd5e1;">Pneumatic air valves with 24V DC solenoid coils for screw/cap feeding and distribution.</p>
              
              <div class="specs-grid">
                <div class="spec-row"><span class="spec-label">Coil Type:</span><span class="spec-value">24V DC solenoid</span></div>
                <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Two wires per valve</span></div>
                <div class="spec-row"><span class="spec-label">Group A (Blue/Brown):</span><span class="spec-value">Screw FEEDING valves</span></div>
                <div class="spec-row"><span class="spec-label">Group B (Red/Black):</span><span class="spec-value">Screw DISTRIBUTION valves</span></div>
              </div>
              
              <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Group A - Feeding Functions:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Blow screws/caps forward</li>
                  <li>Advance parts in chute</li>
                  <li>Clear jams</li>
                  <li>Move parts to next step</li>
                </ul>
              </div>
              
              <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
                <strong>Group B - Distribution Paths:</strong>
                <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Left path routing</li>
                  <li>Middle path routing</li>
                  <li>Bottom path routing</li>
                  <li>Machine chooses which path the screw/cap goes to</li>
                </ul>
              </div>
            </div>
            
            <h4 style="font-weight:700;margin:2rem 0 1rem;color:#60a5fa;border-bottom:2px solid rgba(148,163,184,0.3);padding-bottom:0.5rem;">üî¥‚ö´ Phoenix DIN Rail Terminals</h4>
            
            <div class="wire-grid">
              <div class="wire-box wire-red">
                <strong>Red Terminal Block</strong>
                <p style="font-size:0.85rem;color:#cbd5e1;margin-top:0.5rem;">24V distribution to the 41F-1ZC2-5 relays. Provides positive voltage rail for all solenoid power.</p>
              </div>
              <div class="wire-box wire-black">
                <strong>Black Terminal Block</strong>
                <p style="font-size:0.85rem;color:#cbd5e1;margin-top:0.5rem;">Return path / 0V for entire AirFeed system including solenoid coil returns, sensor grounds, microcontroller grounds, and all DC returns.</p>
              </div>
            </div>
            
            <div class="info-box">
              <h4>Brown Terminal Block - Complete Ground Return:</h4>
              <ul style="color:#cbd5e1;line-height:1.8;margin-left:1.5rem;">
                <li>Solenoid valve coil returns (0V for Screw Manifolds/Distribution)</li>
                <li>Sensor ground lines</li>
                <li>Microcontroller (DN31C01) ground tie-ins</li>
                <li>Driver board input returns</li>
                <li>Pressure sensor grounds</li>
                <li>Optical sensor grounds</li>
                <li>Cap detection sensor grounds</li>
                <li>Airfeed logic ground</li>
                <li>Any chassis-referenced circuit needing common ground</li>
              </ul>
            </div>
          </div>
          
                              <div class="tab-content" id="tab-flow">
            <h3 class="section-title">Air Distribution Component Flow</h3>
            <p style="color:#cbd5e1;margin-bottom:1.5rem;text-align:center;"><strong style="color:#fbbf24;">Click any component</strong> for detailed specifications.</p>
            
            <div class="flow-diagram" style="max-width:800px;margin:0 auto;">
              
              <!-- Stage 1: Terminal Distribution -->
              <div style="margin-bottom:2rem;">
                <h4 style="color:#60a5fa;margin-bottom:1rem;font-weight:700;text-align:center;">Stage 1: Terminal Block Distribution</h4>
                <div style="display:flex;justify-content:center;gap:1.5rem;flex-wrap:wrap;">
                  <div class="wire-box wire-red" data-air-component="red-terminal" style="cursor:pointer;flex:0 0 220px;">
                    <strong>Red Terminal</strong>
                    <p style="font-size:0.85rem;margin-top:0.5rem;">24V to Relay</p>
                  </div>
                  <div class="wire-box" style="background:rgba(139,69,19,0.3);border:3px solid #8b4513;cursor:pointer;flex:0 0 220px;" data-air-component="brown-terminal">
                    <strong style="color:#d2691e;">Brown Terminal</strong>
                    <p style="font-size:0.85rem;margin-top:0.5rem;color:#cbd5e1;">24V to Manifolds</p>
                  </div>
                  <div class="wire-box wire-black" data-air-component="black-terminal" style="cursor:pointer;flex:0 0 220px;">
                    <strong>Black Terminal</strong>
                    <p style="font-size:0.85rem;margin-top:0.5rem;">0V / GND Return</p>
                  </div>
                </div>
              </div>
              
              <div style="text-align:center;font-size:2.5rem;color:#94a3b8;margin:1.5rem 0;">‚Üì</div>
              
              <!-- Stage 2: Microcontroller -->
              <div style="margin-bottom:2rem;">
                <h4 style="color:#60a5fa;margin-bottom:1rem;font-weight:700;text-align:center;">Stage 2: Central Control</h4>
                <div style="display:flex;justify-content:center;">
                  <div class="flow-box flow-box-purple" data-air-component="dn31c01" style="cursor:pointer;max-width:350px;">
                    DN31C01 Arduino Nano
                    <div class="subtitle">Microcontroller</div>
                  </div>
                </div>
              </div>
              
              <div style="text-align:center;font-size:2.5rem;color:#94a3b8;margin:1.5rem 0;">‚Üì</div>
              
              <!-- Stage 3: Relay System -->
              <div style="margin-bottom:2rem;">
                <h4 style="color:#60a5fa;margin-bottom:1rem;font-weight:700;text-align:center;">Stage 3: Relay Interface</h4>
                <div style="display:flex;justify-content:center;">
                  <div class="flow-box flow-box-orange" data-air-component="41f-relay" style="cursor:pointer;max-width:350px;">
                    41F-1Z-C2-5 Relay
                    <div class="subtitle">Signal feedback to microprocessor</div>
                  </div>
                </div>
              </div>
              
              <div style="text-align:center;font-size:2.5rem;color:#94a3b8;margin:1.5rem 0;">‚Üì</div>
              
              <!-- Stage 4: Solenoid Valves -->
              <div style="margin-bottom:2rem;">
                <h4 style="color:#60a5fa;margin-bottom:1rem;font-weight:700;text-align:center;">Stage 4: Pneumatic Valves</h4>
                <div style="display:flex;justify-content:center;gap:1.5rem;flex-wrap:wrap;">
                  <div class="flow-box flow-box-green" data-air-component="screw-feed" style="cursor:pointer;flex:0 0 240px;">
                    Screw Feed Manifold
                    <div class="subtitle">6 Valves (Blue/Brown)</div>
                  </div>
                  <div class="flow-box flow-box-blue" data-air-component="screw-distribution" style="cursor:pointer;flex:0 0 240px;">
                    Screw Distribution Manifold
                    <div class="subtitle">6 Valves (Red/Black)</div>
                  </div>
                  <div class="flow-box flow-box-purple" data-air-component="feeder-modules" style="cursor:pointer;flex:0 0 240px;">
                    Feeder Modules
                    <div class="subtitle">Clay / Almond / White</div>
                  </div>
                </div>
              </div>
              
              <!-- Stage 5: 5-Pin Connector Detail -->
              <div style="margin-top:2rem;padding:1.5rem;background:rgba(30,41,59,0.6);border-radius:0.75rem;border-left:5px solid #8b5cf6;">
                <h4 style="color:#a78bfa;margin-bottom:1rem;font-weight:700;text-align:center;">Stage 5: Feeder Interface</h4>
                <div style="display:flex;justify-content:center;">
                  <div class="flow-box" style="background:#1f2937;color:white;cursor:pointer;max-width:400px;" data-air-component="5pin-connector">
                    5-Pin Connector
                    <div class="subtitle">Clay / Almond / White Interface</div>
                  </div>
                </div>
              </div>
              
            </div>
            
            <!-- Legend -->
            <div style="margin-top:2.5rem;padding:1.75rem;background:rgba(30,41,59,0.6);border-radius:0.75rem;border-left:5px solid #60a5fa;max-width:800px;margin-left:auto;margin-right:auto;">
              <h4 style="color:#60a5fa;margin-bottom:1.25rem;font-size:1.2rem;text-align:center;">Key Information</h4>
              <div style="color:#cbd5e1;font-size:1rem;line-height:1.8;">
                <div><strong style="color:#fbbf24;">Yellow Wire:</strong> Power input for relay coil (from PDF)</div>
                <div><strong style="color:#10b981;">Pin 11 (Relay):</strong> Tied to Black Terminal (0V) for low-side signaling</div>
                <div><strong style="color:#10b981;">Pin 14 (Relay):</strong> Goes to microprocessor as sense input</div>
                <div><strong style="color:#ef4444;">Critical:</strong> Only ONE feeder (Clay/Almond/White) active at a time</div>
              </div>
            </div>
          </div>
          <div class="tab-content" id="tab-operation">
            <h3 class="section-title">System Operation Sequence</h3>
            
            <div class="info-box">
              <h4>Complete Feeder Module Operation (Step-by-Step):</h4>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Microcontroller Decision</div>
              </div>
              <div class="step-content">
                <p style="margin-bottom:0.5rem;">DN31C01 (Arduino Nano) runs AirFeed logic and selects which feeder to activate:</p>
                <div style="background:rgba(15,23,42,0.5);padding:1rem;border-radius:0.5rem;font-family:monospace;font-size:0.85rem;color:#10b981;margin-top:0.5rem;">
                  If Clay feeder is active:<br>
                  &nbsp;&nbsp;energize Clay solenoid<br>
                  Else if Almond feeder is active:<br>
                  &nbsp;&nbsp;energize Almond solenoid<br>
                  Else if White feeder is active:<br>
                  &nbsp;&nbsp;energize White solenoid
                </div>
                <p style="margin-top:0.75rem;color:#cbd5e1;">Sends logic HIGH out of one output pin to <strong>Pin 4</strong> of selected feeder connector.</p>
                <p style="margin-top:0.5rem;color:#fbbf24;font-weight:600;">‚ö†Ô∏è Only ONE feeder can be activated at a time</p>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">2</div>
                <div class="step-title">Pin 4 Activates Relay</div>
              </div>
              <div class="step-content">
                <p style="margin-bottom:0.5rem;">Pin 4 connected to relay's coil driver (41F-1ZC2-5).</p>
                <p style="color:#cbd5e1;">When microcontroller outputs HIGH signal:</p>
                <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;margin-top:0.5rem;">
                  <li>Transistor or driver energizes relay coil</li>
                  <li>Relay clicks ON</li>
                  <li>Internal contacts close (Pin 11 to Pin 14)</li>
                  <li>Relay becomes a switch for 24V power</li>
                </ul>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Relay Switches 24V Power</div>
              </div>
              <div class="step-content">
                <p style="margin-bottom:0.5rem;color:#cbd5e1;">Power flow through relay:</p>
                <div style="background:rgba(220,38,38,0.1);padding:1rem;border-radius:0.5rem;border-left:4px solid #dc2626;margin-top:0.5rem;">
                  <strong style="color:#dc2626;">+24V (Pin 2 - Red terminal) ‚Üí Relay ‚Üí Pin 1 (Blue) ‚Üí Solenoid</strong>
                </div>
                <p style="margin-top:0.75rem;color:#cbd5e1;">Pin 1 becomes energized ONLY when relay is ON. This gives solenoid its +24V to fire.</p>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">Solenoid Coil Activates</div>
              </div>
              <div class="step-content">
                <p style="margin-bottom:0.5rem;">Solenoid has two wires:</p>
                <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li><strong>+24V from Pin 1 (power)</strong></li>
                  <li><strong>0V ground from Pin 5</strong> (via Black terminal strip)</li>
                </ul>
                <p style="margin-top:0.75rem;color:#cbd5e1;">When Pin 1 goes high:</p>
                <ol style="margin-left:1.5rem;color:#10b981;line-height:1.6;margin-top:0.5rem;">
                  <li>Solenoid coil energizes</li>
                  <li>Valve opens</li>
                  <li>Air flows</li>
                  <li>Cap is pushed / fed / blown forward</li>
                </ol>
                <p style="margin-top:0.75rem;color:#fbbf24;font-weight:600;">This is the actual mechanical action in the feeder chute.</p>
              </div>
            </div>
            
            <div class="operation-step">
              <div class="step-header">
                <div class="step-number">5</div>
                <div class="step-title">Signal Termination</div>
              </div>
              <div class="step-content">
                <p style="margin-bottom:0.5rem;">When microcontroller stops the signal:</p>
                <ul style="margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
                  <li>Microcontroller drops Pin 4 to LOW</li>
                  <li>Relay coil de-energizes</li>
                  <li>Relay contacts open</li>
                  <li>Pin 1 loses power</li>
                  <li>Solenoid releases</li>
                  <li>Air flow stops</li>
                </ul>
                <p style="margin-top:0.75rem;color:#10b981;font-weight:600;">Feeder is now ready for next cycle.</p>
              </div>
            </div>
            
            <div class="info-box">
              <h4>üîÅ Relay Contact Operation Detail:</h4>
              <p style="color:#cbd5e1;margin-bottom:0.5rem;">The microcontroller operates the relay coil which closes Pin 11 and Pin 14 together. This shorts Pin 1 and Pin 2 together, allowing 24V to flow from the Red terminal block through to the solenoid.</p>
              <div style="background:rgba(99,102,241,0.1);padding:1rem;border-radius:0.5rem;border-left:4px solid #6366f1;margin-top:1rem;">
                <strong style="color:#6366f1;">Complete Circuit Path:</strong><br>
                <span style="color:#cbd5e1;">Red Terminal (+24V) ‚Üí Pin 2 ‚Üí Relay Contacts (11-14) ‚Üí Pin 1 ‚Üí Solenoid Coil ‚Üí Pin 5 ‚Üí Black Terminal (0V)</span>
              </div>
            </div>
            
            <div class="footer-warning">
              <strong>‚ö†Ô∏è Critical:</strong> The relay provides electrical isolation between the low-power microcontroller logic (5V) and the high-power solenoid circuit (24V). This prevents damage to the DN31C01 and ensures reliable operation.
            </div>
          </div>
        `
      }
    };

    const COMPONENT_DETAILS = {
  'ac-input': {
    title: 'AC Input - 120-240V',
    function: 'Standard wall AC power provides primary electrical service for entire system.',
    connections: [
      '<strong>Line (Hot):</strong> Red wire from wall outlet',
      '<strong>Neutral:</strong> White wire from wall outlet',
      '<strong>Ground:</strong> Green/bare copper wire'
    ],
    specs: {
      'Supply Type': 'Split-phase AC',
      'Voltage': '200-240V AC',
            'Protection': 'Building-level circuit breaker'
    }
  },
  'breaker': {
    title: 'Nader NDB1L-32 Breaker',
    function: 'Primary overcurrent, overvoltage, and leakage protection for AC input. Circuit Breaker combines circuit breaker and Protection Device functionality.',
    connections: [
      '<strong>Input:</strong> Line and Neutral from wall',
      '<strong>Output:</strong> Protected Line and Neutral to Doepke G16',
      '<strong>Test Button:</strong> Simulates fault for verification'
    ],
    specs: {
      'Type': 'Circuit Breaker',
      'Current Rating': 'High',
      'Voltage': '200-240V AC',
      'Trip Conditions': 'Overcurrent, short circuit, leakage, over-voltage',
      'Reset': 'Manual after fault cleared'
    }
  },
  'rcd': {
    title: 'Doepke G16',
    function: 'Detects leakage current between Line and Neutral to protect against electric shock and ground faults. Monitors whole cabinet.',
    connections: [
      '<strong>Pin 1:</strong> Line IN (from Nader)',
      '<strong>Pin 2:</strong> Line OUT (to UKK80 ‚Üí whole machine)',
      '<strong>Pin 3:</strong> Neutral IN (from Nader)',
      '<strong>Pin 4:</strong> Neutral OUT & RETURN (to/from UKK80)'
    ],
    specs: {
      'Type': '2-pole Residual Current Device',
      'Current': '16 A',
      'Principle': 'Current OUT on Line must equal current BACK on Neutral',
      'Protection': 'Electric shock, insulation failure, moisture, ground faults'
    }
  },
  'safety-relay': {
    title: 'DOLD D-78120 Safety Relay',
    function: 'Monitors safety devices (E-stops, light curtains) and controls power enable through Finder contactor. Dual-channel redundancy ensures safe operation.',
    connections: [
      '<strong>S11, S12, S22:</strong> Safety circuit monitoring inputs',
      '<strong>S21:</strong> Cross-fault detection',
      '<strong>23-24, 33-34:</strong> Redundant output contacts to Finder coil',
      '<strong>A1, A2:</strong> 24V DC supply',
      '<strong>Reset:</strong> Manual reset button'
    ],
    specs: {
      'Model': 'DOLD D-78120 (LG 5925 series)',
      'Supply': '24V DC',
      'Safety Channels': 'K1, K2 dual redundancy',
      'Control Current': '‚âà30mA over S12, S22',
      'Operation': '9-step startup sequence, instant shutdown on fault',
      'Redundancy': 'S24 and S34 paralleled for safety loop protection'
    }
  },
  'finder-contactor': {
    title: 'Finder 22.32.0120.1340 Contactor',
    function: 'Electrically controlled AC power switch. DOLD controls the coil (A1-A2) which electromagnetically closes/opens the power contacts (1‚Üí3, 2‚Üí4).',
    connections: [
      '<strong>A1:</strong> Coil input from DOLD safety relay',
      '<strong>A2:</strong> Coil return to Neutral',
      '<strong>1‚Üí2:</strong> AC power contact (L1 in/out)',
      '<strong>3‚Üí4:</strong> AC power contact (second switched line)',
      '<strong>Selector:</strong> ON/AUTO/OFF switch'
    ],
    specs: {
      'Coil Circuit': 'Low-power control (A1-A2) creates magnetic field',
      'Power Circuit': 'High-current AC switching (1‚Üí3, 2‚Üí4)',
      'Coil OFF': 'Both power contacts OPEN - no power flows',
      'Coil ON': 'Both power contacts CLOSE - power flows to machine',
      'Selector Mode': 'USE ONLY AUTO for normal operation',
      'Control': 'DOLD outputs 23-24, 33-34 energize coil'
    }
  },
  'ukk-terminals': {
    title: 'UKK80 AC Distribution Bus',
    function: 'Single-pole power distribution blocks. Each screw terminal connects to same internal metal bar - works like a power splitter for AC distribution.',
    connections: [
      '<strong>LINE UKK:</strong> Receives L from Doepke Pin 2, distributes to all AC loads',
      '<strong>NEUTRAL UKK:</strong> Receives N from Doepke Pin 4, distributes to all loads',
      '<strong>Outputs:</strong> SDR-480, NDR-240, safety systems, all AC equipment'
    ],
    specs: {
      'Type': 'Single-pole terminal block',
      'Function': 'All terminals internally connected',
      'LINE Block': 'Main Line bus for entire machine',
      'NEUTRAL Block': 'Neutral distribution and return path',
      'Principle': 'One input, all other terminals become outputs'
    }
  },
  'psu-48v': {
    title: 'Mean Well SDR-480-48 (48V Power Supply)',
    function: 'Converts 200-240V AC to regulated 48V DC for stepper motor drivers. Uses PFC for high efficiency and DC OK relay for monitoring.',
    connections: [
      '<strong>TB1 Pin 1:</strong> FG (Earth Ground)',
      '<strong>TB1 Pin 2:</strong> AC/L (Hot from Finder)',
      '<strong>TB1 Pin 3:</strong> AC/N (Neutral)',
      '<strong>TB2 Pin 1,2:</strong> DC +48V output',
      '<strong>TB2 Pin 3,4:</strong> DC -V (ground)',
      '<strong>TB2 Pin 5-8:</strong> DC OK relay contacts'
    ],
    specs: {
      'Model': 'SDR-480-48',
      'Output': '48V DC',
      'Input': '200-240V AC',
      'Features': 'PFC circuit, DC OK relay',
      'Protection': 'OVP, OCP, OLP, OTP',
      'Loads': 'DD50D40NOM motor drivers (X, Y, Z axes)',
      'Conversion': 'AC‚ÜíEMI filter‚Üírectifier‚ÜíPFC‚Üíswitching‚Üítransformer‚ÜíDC'
    }
  },
  'psu-24v': {
    title: 'Mean Well NDR-240-24 (24V Power Supply)',
    function: 'Converts 200-240V AC to regulated 24V DC for pneumatic solenoids, safety relays, and control systems. Industrial DIN rail mount.',
    connections: [
      '<strong>TB1 Pin 1:</strong> FG (Earth Ground)',
      '<strong>TB1 Pin 2:</strong> AC/L (Hot)',
      '<strong>TB1 Pin 3:</strong> AC/N (Neutral)',
      '<strong>TB2 Pin 1,2:</strong> DC +24V output to Red Phoenix terminals',
      '<strong>TB2 Pin 3,4:</strong> DC -V to Black Phoenix terminals'
    ],
    specs: {
      'Model': 'NDR-240-24',
      'Output': '24V DC',
      'Input': '200-240V AC',
            'Protection': 'OVP, OCP, OLP, OTP',
      'Loads': '12 pneumatic solenoids, DOLD relay, control systems, cabinet fan',
      'Conversion': 'AC‚ÜíEMI filter‚Üíbridge rectifier‚ÜíPWM‚Üítransformer‚ÜíDC filter'
    }
  },
  'psu-aux': {
    title: 'Mean Well NDR-120-12 + 5V (Auxiliary Supplies)',
    function: 'Provides 12V DC for LED lighting and Z-axis brake, plus 5V DC for optical sensors and encoder logic.',
    connections: [
      '<strong>12V Supply:</strong> for LED light bars (4x) and Z-brake',
      '<strong>5V Supply:</strong> for EE-SX950W sensors (6x) and encoders (3x)',
      '<strong>Distribution:</strong> Through Phoenix Red/Black terminals'
    ],
    specs: {
      '12V Model': 'NDR-120-12',
      '12V Output': '12V DC, 24W',
      '5V Output': '5V DC',
      'Input': '200-240V AC',
      '12V Loads': 'LED bars, Z-axis brake',
      '5V Loads': 'Optical sensors, encoders, logic circuits'
    }
  },
  'motor-loads': {
    title: '48V Motor Drivers',
    function: 'Stepper motor drivers powered by 48V supply.',
    connections: [
      '<strong>Power:</strong> 48V from SDR-480-48',
      '<strong>Drivers:</strong> DD50D40NOM (X, Y, Z axes)',
      '<strong>Motors:</strong> NEMA 23 steppers'
    ],
    specs: {
      'Supply': '48 VDC',
      'Current': 'peak (all three axes)',
      'Driver Model': 'DD50D40NOM or equivalent',
      'Loads': 'X-axis, Y-axis, Z-axis stepper motors'
    }
  },
  'pneumatic-loads': {
    title: '24V Pneumatics',
    function: 'Solenoid valves and pneumatic control relays.',
    connections: [
      '<strong>Solenoids:</strong> 12 total valves',
      '<strong>Distribution:</strong> Via Red/Black Phoenix terminals',
      '<strong>Control:</strong> PLC I/O signals'
    ],
    specs: {
      'Supply': '24 VDC',
      'Total Load': 'continuous',
      'Valves': '12 solenoid valves for air control',
      'Other': 'Safety relays, control logic'
    }
  },
  'sensor-loads': {
    title: '12V/5V Electronics',
    function: 'Sensors, encoders, LED lighting, and control logic.',
    connections: [
      '<strong>12V:</strong> LED light bars (4x), Z-axis brake',
      '<strong>5V:</strong> EE-SX950W optical sensors (6x)',
      '<strong>5V:</strong> Motor encoders (3x), logic circuits'
    ],
    specs: {
      '12V Supply': '12V',
      '5V Supply': '5V',
      'Sensors': 'EE-SX950W optical',
      'Lighting': 'LED light bars',
      'Logic': 'Encoders and control circuits'
    }
  },
  'rcd-breaker': {
    title: 'Protection System (RCD + Breaker)',
    function: 'Combined protection from Nader NDB1L-32 breaker and Doepke G16.',
    connections: [
      '<strong>Nader:</strong> Overcurrent and overvoltage protection',
      '<strong>Doepke:</strong> Ground fault and leakage detection',
      '<strong>Sequence:</strong> Wall ‚Üí Nader ‚Üí Doepke ‚Üí System'
    ],
    specs: {
      'Breaker': 'Nader NDB1L-32 ',
      'Protection': 'Complete electrical safety system'
    }
  },
  'ac-bus': {
    title: 'AC Distribution Bus (UKK80)',
    function: 'Central AC power distribution point.',
    connections: [
      '<strong>Input:</strong> From Doepke G16',
      '<strong>LINE Bus:</strong> Distributes hot line',
      '<strong>NEUTRAL Bus:</strong> Distributes neutral and return'
    ],
    specs: {
      'Type': 'UKK80 terminal blocks',
      'Function': 'Power splitting/distribution',
      'Outputs': 'All AC-powered equipment',
      'Design': 'All terminals internally connected'
    }
  }
};

    document.querySelectorAll('.cabinet, .feeder').forEach(el => {
      el.addEventListener('click', () => {
        switchToFlowView(el.dataset.system);
      });
    });

    document.getElementById('backBtn').addEventListener('click', () => {
      switchToSchematicView();
    });

    function switchToFlowView(systemKey) {
      document.getElementById('schematicView').classList.remove('active');
      document.getElementById('flowView').classList.add('active');
      
      const systemTitles = {
        'wall-power': { title: '240V Power Distribution', subtitle: 'Main power system flow' },
        'power': { title: 'Power Distribution Cabinet', subtitle: 'System power routing' },
        'motor-control': { title: 'Motor Control Cabinet', subtitle: 'X/Y/Z axis motor drivers' },
        'left-feeder': { title: 'Left Feeder - Y-Axis', subtitle: 'Vertical positioning' },
        'right-feeder': { title: 'Right Feeder - X-Axis', subtitle: 'Horizontal positioning' },
        'air-distribution': { title: 'Air Distribution System', subtitle: 'Pneumatic control' }
      };
      
      const info = systemTitles[systemKey];
      document.getElementById('flowViewTitle').textContent = info.title;
      document.getElementById('flowViewSubtitle').textContent = info.subtitle;
      document.getElementById('headerSubtitle').textContent = 'Detailed system flow diagram';
      
      document.getElementById('flowContent').innerHTML = DATA[systemKey].getHTML();
      attachTabHandlers(systemKey);
      initAirComponentListeners(); // Initialize air flow component click handlers
      initMotorComponentListeners(); // Initialize motor control component click handlers
      initRightFeederComponentListeners(); // Initialize right feeder component click handlers
      initPowerComponentListeners(); // Initialize power distribution component click handlers
      initWallPowerComponentListeners(); // Initialize wall power (240V) component click handlers
    }

    function switchToSchematicView() {
      document.getElementById('flowView').classList.remove('active');
      document.getElementById('schematicView').classList.add('active');
      document.getElementById('headerSubtitle').textContent = 'Click on any cabinet to view its detailed flow diagram';
    }

    function attachTabHandlers(systemKey) {
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
          document.getElementById(`tab-${this.dataset.tab}`).classList.add('active');
        });
      });

      if (systemKey === 'wall-power' || systemKey === 'power') {
        // REMOVED: Bottom panel functionality disabled for Power Distribution
        // The expanding panels near components still work via initPowerComponentListeners()

        document.getElementById('splitPhaseInfo')?.addEventListener('click', (e) => {
          e.stopPropagation();
          showPowerDetail(COMPONENT_DETAILS['split-phase-info']);
        });
      }
    }

    function showPowerDetail(data) {
      document.getElementById('powerDetailTitle').textContent = data.title;
      document.getElementById('powerDetailContent').innerHTML = `
        <div class="power-detail-section">
          <h4>Function</h4>
          <p>${data.function}</p>
        </div>
        <div class="power-detail-section">
          <h4>Connections</h4>
          <ul>${data.connections.map(c => `<li>${c}</li>`).join('')}</ul>
        </div>
        <div class="power-detail-section">
          <h4>Specifications</h4>
          <div class="specs-grid">
            ${Object.entries(data.specs).map(([k,v]) => 
              `<div class="spec-row">
                <span class="spec-label">${k}:</span>
                <span class="spec-value">${v}</span>
              </div>`
            ).join('')}
          </div>
        </div>
      `;
      document.getElementById('powerFlowDetail').classList.add('active');
    }
  
// Component data for side panel
      const componentData = {
        'wall-ac': {
          name: 'Wall Power Input',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">200-240V AC</span></div>
              <div class="spec-row"><span class="spec-label">Frequency:</span><span class="spec-value">50/60Hz</span></div>
              <div class="spec-row"><span class="spec-label">Connection:</span><span class="spec-value">Line H (Hot) + Line N (Neutral) + Earth</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Primary AC power input from building mains. Provides electrical energy for entire Left Feeder cabinet.</p>
            </div>
            <div class="warning-box" style="margin-top:1rem;">
              <h4>‚ö° Safety Warning</h4>
              <p>High voltage AC power. All work must be performed by qualified electricians with power disconnected.</p>
            </div>
          `
        },
        
        'nader': {
          name: 'Nader NDB1L-32',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Circuit Breaker</span></div>
              <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">High Current</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">Line N / Line H from wall power</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">Load H, Load N to Doepke G16</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Protection Functions</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Short Circuit Protection:</strong> Instantly trips if wires short together</li>
                <li><strong>Overload Protection:</strong> Trips if current exceeds limit</li>
                <li><strong>Leakage Detection:</strong> Detects ground faults and current leakage</li>
                <li><strong>Overvoltage Protection:</strong> Protects against voltage spikes</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>First Line of Defense:</strong> If any fault is detected, Nader trips immediately and cuts all power to the system, preventing damage and ensuring safety.
            </div>
          `
        },
        
        'doepke': {
          name: 'Doepke G16',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">2-pole Protection Device</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">From Nader Load H, Load N</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">To UKK160 terminal blocks</span></div>
              <div class="spec-row"><span class="spec-label">Monitoring:</span><span class="spec-value">Compares Line and Neutral current</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Operation Principle</h4>
              <p>Continuously compares current in Line vs Neutral. If imbalance detected (indicating ground fault or leakage), trips to prevent shock hazard.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Protects Against</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Electric shock from contact with live parts</li>
                <li>Insulation failure in equipment</li>
                <li>Water or moisture causing leakage</li>
                <li>Wire touching metal frame/enclosure</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Power Flow:</strong> Wall AC ‚Üí Nader ‚Üí Doepke ‚Üí UKK160 ‚Üí Power Supplies
            </div>
          `
        },
        
        'ukk160': {
          name: 'UKK160 Terminal Blocks',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Feed-through terminal blocks</span></div>
              <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">High rating</span></div>
              <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">Two blocks - Line bus and Neutral bus</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Connections</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Neutral UKK160 Terminal 6:</strong> Connects to Doepke G16 Pin 2</li>
                <li><strong>Line UKK160 Terminal 7:</strong> Connects to Doepke G16 Pin 4</li>
                <li>Distributes AC to: 24V power supply, 5V power supply inputs</li>
                <li>Distributes 24V DC from Vo+ and Vo‚àí to all DC loads</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Three Bus System:</strong><br>
              ‚Ä¢ +24V bus (Line UKK160) feeds loads<br>
              ‚Ä¢ 0V/Return bus (Neutral UKK160) provides DC return<br>
              ‚Ä¢ PE/Earth bus (Yellow Green TB) provides safety bonding
            </div>
          `
        },
        
        'psu-24v': {
          name: 'Dinkle Series 24V Power Supply (DRL-24V240W1AA)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DRL-24V240W1AA</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">200-240V AC from UKK160 Line and UKK160 Neutral</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">24V DC</span></div>
              <div class="spec-row"><span class="spec-label">Isolation:</span><span class="spec-value">Galvanic isolation via transformer</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Internal Stages</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>EMI Filter & Bridge Rectifier:</strong> Converts AC to high-voltage DC, filters noise</li>
                <li><strong>PFC Converter:</strong> Power Factor Correction, improves efficiency, stabilizes DC bus</li>
                <li><strong>PWM Converter:</strong> High-frequency switching through transformer for isolation and step-down</li>
                <li><strong>Output Rectifier & Filter:</strong> Converts transformer secondary to clean 24V DC</li>
                <li><strong>Feedback Control:</strong> CV (Constant Voltage) and CC (Constant Current) mode regulation</li>
              </ul>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Output Distribution</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Vo+ (24V+):</strong> Goes to Line UKK160 ‚Üí DN31C01, relays, solenoids, driver logic</li>
                <li><strong>Vo‚àí (0V):</strong> Goes to Neutral UKK160 ‚Üí Return path for all 24V loads</li>
                <li><strong>FG (Frame Ground):</strong> Goes to Yellow-Green TB earth bus for safety</li>
              </ul>
            </div>
            <div class="warning-box" style="margin-top:1rem;">
              <h4>üîí Protection Features</h4>
              <p>Overvoltage, overcurrent, over-temperature protection with automatic shutdown/foldback.</p>
            </div>
          `
        },
        
        'psu-5v': {
          name: '5V Power Supply',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">5V DC</span></div>
              <div class="spec-row"><span class="spec-label">Output Current:</span><span class="spec-value">Low Power</span></div>
              <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">Low Power</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">From UKK160 AC distribution</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Provides clean 5V DC logic power for microcontroller and optical sensor power.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Loads Powered</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>DN31C01 Microcontroller:</strong> 5V logic power</li>
                <li><strong>EE-SX950W Optical Sensors:</strong> Vcc power supply</li>
              </ul>
            </div>
          `
        },
        
        'dn31c01': {
          name: 'DN31C01 Microcontroller (Arduino Nano)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Motion-control microcontroller / I/O controller</span></div>
              <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB-C connection for programming</span></div>
              <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V logic, 24V outputs</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>üß† The "PLC Brain" of the Feeder</h4>
              <p>Central logic controller that coordinates all feeder operations.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Primary Functions</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Reads all sensors (optical, CAP sensors, limit switches)</li>
                <li>Sends step/direction commands to FMDD50D40NOM driver</li>
                <li>Activates solenoid relays for pneumatic control</li>
                <li>Controls motion sequences and timing logic</li>
                <li>Interfaces electrically with all feeder components</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Signal Chain:</strong> DN31C01 decides when to move motor, fire solenoid, wait for sensor, reject part, retry movement, stop feeder, home axis, or continue to next cycle.
            </div>
          `
        },
        
        'dn31c01-motor': {
          name: 'DN31C01 ‚Üí Motor Control',
          content: `
            <div class="info-box">
              <h4>Motor Control Signals</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>PU‚àí (Pulse/Step):</strong> Each pulse = one microstep forward</li>
                <li><strong>DR‚àí (Direction):</strong> Controls left or right movement</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>How It Works:</strong><br>
              ‚Ä¢ DN31C01 generates step pulses at specific frequency<br>
              ‚Ä¢ Pulse frequency controls motor speed<br>
              ‚Ä¢ Number of pulses controls distance traveled<br>
              ‚Ä¢ Direction signal determines which way motor turns
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Motion Control Applications</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Move X-axis to pick position</li>
                <li>Move to align caps/parts</li>
                <li>Return to home position</li>
                <li>Precise positioning for pick-and-place</li>
              </ul>
            </div>
          `
        },
        
        'dn31c01-pneumatic': {
          name: 'DN31C01 ‚Üí Pneumatic Control',
          content: `
            <div class="info-box">
              <h4>Relay Control Signals</h4>
              <p>DN31C01 outputs low-voltage control signals that energize relay coils (A1/A2), which then switch 24V power to solenoid valves.</p>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Control Sequence:</strong><br>
              1. DN31C01 decides when to actuate pneumatic cylinder<br>
              2. Sends control signal to relay coil A1<br>
              3. Relay closes contacts 11‚Üí14<br>
              4. 24V flows to solenoid valve<br>
              5. Solenoid actuates, air flows to cylinder<br>
              6. Mechanical action occurs (push, clamp, eject, etc.)
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Controlled Actions</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Cap ejection / forwarding</li>
                <li>Cap clamping / holding</li>
                <li>Air blast cleaning</li>
                <li>Part positioning</li>
              </ul>
            </div>
          `
        },
        
        'dn31c01-sensors': {
          name: 'Sensors ‚Üí DN31C01',
          content: `
            <div class="info-box">
              <h4>Sensor Input Monitoring</h4>
              <p>DN31C01 continuously reads digital inputs from all sensors to understand system state and part positions.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Optical Sensor Inputs</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>OUT1 signal:</strong> HIGH when beam clear, LOW when blocked</li>
                <li>Used for: home position, limit switches, jam detection</li>
              </ul>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>CAP Sensor Inputs</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Detects: part present/missing, misalignment, double parts</li>
                <li>Provides real-time part status to controller</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Logic Integration:</strong> All sensor inputs combine to give DN31C01 complete awareness of system state, enabling intelligent decision-making for motion and pneumatic control.
            </div>
          `
        },
        
        'driver': {
          name: 'FMDD50D40NOM Stepper Driver',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">FMDD50D40NOM</span></div>
              <div class="spec-row"><span class="spec-label">Input Voltage:</span><span class="spec-value">DC 20-50V (typically 24V)</span></div>
              <div class="spec-row"><span class="spec-label">Logic Inputs:</span><span class="spec-value">PU‚àí, DR‚àí, MF+, MF‚àí</span></div>
              <div class="spec-row"><span class="spec-label">Motor Outputs:</span><span class="spec-value">A+, A‚àí, B+, B‚àí</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>üéõÔ∏è The "Brain of the Motor"</h4>
              <p>Electronic module that controls the X-axis stepper motor by converting logic commands into precise motor movements.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Driver Functions</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>PU‚àí (Pulse):</strong> Step signal from DN31C01 (one pulse = one microstep)</li>
                <li><strong>DR‚àí (Direction):</strong> Direction control (left or right)</li>
                <li><strong>MF+/MF‚àí:</strong> Enable control (not connected, auto-enabled)</li>
                <li>Provides controlled current to motor coils</li>
                <li>Microsteps the motor for smooth motion</li>
                <li>Controls coil energizing order and direction</li>
                <li>Protects motor from overcurrent</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Signal Chain:</strong> DN31C01 (commands) ‚Üí FMDD50D40NOM (coil control) ‚Üí X Stepper Motor (movement)
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Note:</strong> PU+ and DR+ are tied to +5V (common-anode wiring). Driver automatically enables when MF+/MF‚àí left disconnected.
            </div>
          `
        },
        
        'motor': {
          name: 'X-Axis Stepper Motor',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">NEMA 23 Bipolar Stepper</span></div>
              <div class="spec-row"><span class="spec-label">Phases:</span><span class="spec-value">2-phase (A and B coils)</span></div>
              <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">A+, A‚àí, B+, B‚àí (4 wires)</span></div>
              <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">Receives power from FMDD50D40NOM driver</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>üí™ The "Muscle" of the System</h4>
              <p>Bipolar stepper motor that converts electrical signals from the driver into precise rotational movement for X-axis positioning.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>How It Works</h4>
              <p>Driver sends controlled current through motor coils (A and B phases) in specific sequence. By energizing coils in precise order and timing, the motor rotates in discrete steps, providing accurate position control without feedback.</p>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Applications:</strong> Moves X-axis carriage for pick-and-place operations, precise positioning of parts, and automated feeding sequences.
            </div>
          `
        },
        
        'relays': {
          name: '41F-1ZC2-5 Relay (4x)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1ZC2-5</span></div>
              <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 relays (one per solenoid)</span></div>
              <div class="spec-row"><span class="spec-label">Coil Terminals:</span><span class="spec-value">A1, A2 (control input from DN31C01)</span></div>
              <div class="spec-row"><span class="spec-label">Contact Terminals:</span><span class="spec-value">11‚Üí14 (switches 24V to solenoid)</span></div>
              <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC (or controlled by DN31C01 output)</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Electromechanical relays that switch 24V power to solenoid valves based on DN31C01 control signals.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Operation Sequence</h4>
              <ol style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Step 1:</strong> DN31C01 sends control signal to relay coil A1</li>
                <li><strong>Step 2:</strong> Current flows through coil (A1 to A2), energizing electromagnet</li>
                <li><strong>Step 3:</strong> Relay contacts close: Pin 11 connects to Pin 14</li>
                <li><strong>Step 4:</strong> +24V flows from Red Phoenix Terminal ‚Üí Pin 11 ‚Üí Pin 14 ‚Üí Solenoid V+</li>
                <li><strong>Step 5:</strong> Solenoid energizes and actuates pneumatic valve</li>
                <li><strong>Step 6:</strong> When DN31C01 removes signal, relay opens, solenoid de-energizes</li>
              </ol>
            </div>
          `
        },
        
        'solenoids': {
          name: 'Solenoid Valves (4x - 24VDC)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">24V DC solenoid coils</span></div>
              <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 valves</span></div>
              <div class="spec-row"><span class="spec-label">Locations:</span><span class="spec-value">Top/Right, Top/Left, Bottom/Right, Bottom/Left</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Pneumatic control valves that direct compressed air to actuators when energized by 24V DC.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Electrical Connections (per solenoid)</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>V+:</strong> 24V+ from relay contact 14 (relay-switched power)</li>
                <li><strong>GND:</strong> 0V return to Phoenix Black Terminal ‚Üí Neutral UKK160 ‚Üí PSU</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Current Loop (when energized):</strong><br>
              <code style="display:block;margin-top:0.5rem;padding:0.5rem;background:rgba(0,0,0,0.3);border-radius:0.5rem;font-size:0.85rem;">
              24V PSU Vo+ ‚Üí Line UKK160 ‚Üí Relay 11‚Üí14 ‚Üí Solenoid V+ ‚Üí Solenoid Coil ‚Üí Solenoid GND ‚Üí Phoenix Black Terminal ‚Üí Neutral UKK160 ‚Üí PSU Vo‚àí
              </code>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Pneumatic Functions</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Cap ejection / forwarding</li>
                <li>Cap clamping / holding</li>
                <li>Air blast cleaning</li>
                <li>Part positioning</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Energized State:</strong> Coil creates electromagnetic field ‚Üí valve shifts ‚Üí air flows ‚Üí cylinder moves<br>
              <strong>De-energized State:</strong> Spring returns valve to rest position ‚Üí air stops/exhausts
            </div>
          `
        },
        
        'cap-circuits': {
          name: 'CAP Circuits (4x - Surge Protection)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">RC snubber or diode network</span></div>
              <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">Parallel with each solenoid coil</span></div>
              <div class="spec-row"><span class="spec-label">Terminals:</span><span class="spec-value">V+, GND (same nodes as solenoid)</span></div>
              <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">4 circuits (one per solenoid)</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Snubber/suppression circuits that protect relay contacts and electronics from voltage spikes when solenoid coils are de-energized.</p>
            </div>
            <div class="warning-box" style="margin-top:1rem;">
              <h4>Why Needed</h4>
              <p>When relay opens and solenoid coil is de-energized, collapsing magnetic field generates large voltage spike (can be 100+ volts). Without protection, this spike can:</p>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li>Arc across relay contacts, causing wear and failure</li>
                <li>Induce noise into nearby signal wires</li>
                <li>Damage microcontroller or other electronics</li>
              </ul>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>How Surge Protection Works</h4>
              <ol style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Relay ON:</strong> 24V applied, solenoid energizes, CAP circuit capacitor charges</li>
                <li><strong>Relay turns OFF:</strong> Relay opens contact</li>
                <li><strong>Coil collapse:</strong> Solenoid's magnetic field collapses, generating voltage spike</li>
                <li><strong>Spike absorption:</strong> CAP circuit clamps/absorbs energy via capacitor + resistor/diode</li>
                <li><strong>Protection result:</strong> Voltage spike reduced, relay contacts protected, electronics safe</li>
              </ol>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Summary:</strong> Solenoid does the pneumatic work, CAP circuit protects the electrical system from inductive kickback.
            </div>
          `
        },
        
        'optical-sensors': {
          name: 'EE-SX950W Optical Sensors',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Slot-type photoelectric sensor</span></div>
              <div class="spec-row"><span class="spec-label">Detection Method:</span><span class="spec-value">Infrared LED + phototransistor</span></div>
              <div class="spec-row"><span class="spec-label">Supply Voltage (Vcc):</span><span class="spec-value">5V DC</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">OUT1 signal to DN31C01</span></div>
              <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Vcc (5V), GND (0V), OUT1 (signal)</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>How It Works</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Beam Clear:</strong> IR LED light hits phototransistor ‚Üí OUT1 goes HIGH</li>
                <li><strong>Beam Blocked:</strong> Part/flag blocks slot ‚Üí OUT1 goes LOW</li>
                <li>DN31C01 monitors OUT1 to detect: home position, limit confirmation, jam detection</li>
              </ul>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Applications in Feeder</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Home Position:</strong> Detects when axis is at home/zero position</li>
                <li><strong>Limit Switches:</strong> X-START, X-END, X-LIN position confirmation</li>
                <li><strong>Jam Detection:</strong> Detects if mechanism is blocked</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Operation Principle:</strong> Internal IR LED on one side of slot emits light to phototransistor on other side. When beam is clear, OUT1 is HIGH. When flag/part blocks slot, OUT1 goes LOW.
            </div>
          `
        },
        
        'cap-sensors': {
          name: 'CAP Sensors (Capacitive Part Sensors)',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">2 physical wires (power and signal combined)</span></div>
              <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">Signal to DN31C01</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Part presence sensors that detect component position and status using capacitive sensing technology.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Detection Capabilities</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Part Present:</strong> Is the part in the correct position?</li>
                <li><strong>Part Missing:</strong> Is the expected part absent?</li>
                <li><strong>Misalignment:</strong> Is the part positioned incorrectly?</li>
                <li><strong>Double Detection:</strong> Are two parts stuck together?</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Integration:</strong> CAP sensor outputs feed to DN31C01 for integrated position and status monitoring, enabling intelligent decisions about part handling and quality control.
            </div>
          `
        }
      ,
        
        'red-phoenix': {
          name: 'Red Phoenix Terminal Block',
          content: `
            <div class="specs-grid">
              <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix Contact DIN Rail Terminal (Red)</span></div>
              <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">24V DC distribution point</span></div>
              <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">24V from Dinkle PSU Vo+</span></div>
              <div class="spec-row"><span class="spec-label">Outputs:</span><span class="spec-value">Relay Pin 11, CAP Circuits V+</span></div>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Function</h4>
              <p>Distribution terminal that takes 24V DC from the power supply and splits it to multiple loads.</p>
            </div>
            <div class="info-box" style="margin-top:1rem;">
              <h4>Connections</h4>
              <ul style="margin-left:1.5rem;line-height:1.8;">
                <li><strong>Input:</strong> 24V+ from Dinkle PSU (Vo+ output)</li>
                <li><strong>Output 1:</strong> Relay Pin 11 (provides 24V that will be switched to Pin 14)</li>
                <li><strong>Output 2:</strong> CAP Circuits V+ (24V for surge protection circuits)</li>
              </ul>
            </div>
            <div class="note-callout" style="margin-top:1rem;">
              <strong>Current Flow:</strong><br>
              24V PSU ‚Üí Red Phoenix ‚Üí Relay Pin 11<br>
              When relay closes (11‚Üí14), 24V flows to solenoid coils
            </div>
          `
        }
      };

      // Function to open side panel with component data
      function openComponentPanel(componentKey) {
        const panel = document.getElementById('component-side-panel');
        const overlay = document.getElementById('panel-overlay');
        const panelName = document.getElementById('panel-component-name');
        const panelContent = document.getElementById('panel-component-content');
        
        const data = componentData[componentKey];
        if (data) {
          panelName.textContent = data.name;
          panelContent.innerHTML = data.content;
          
          panel.classList.add('active');
          overlay.classList.add('active');
          document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }
      }

      // Function to close side panel
      function closeComponentPanel() {
        const panel = document.getElementById('component-side-panel');
        const overlay = document.getElementById('panel-overlay');
        
        panel.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = ''; // Restore scrolling
      }

      // Add click event listeners to all clickable components
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
          const clickableComponents = document.querySelectorAll('.clickable-component');
          clickableComponents.forEach(component => {
            component.addEventListener('click', function() {
              const componentKey = this.getAttribute('data-component');
              openComponentPanel(componentKey);
            });
          });
        }, 500);
      });

// Wall Power (240V Distribution) component details
const WALL_POWER_COMPONENT_DETAILS = {
  'wall-power': {
    title: '200-240V Wall Power Outlet',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Primary electrical service entrance providing split-phase 200-240V AC power to the entire LaunchPad system.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Supply Type:</span><span class="spec-value">200-240V AC split-phase</span></div>
        <div class="spec-row"><span class="spec-label">Line 1 (L1):</span><span class="spec-value">Red wire - 120V to N</span></div>
        <div class="spec-row"><span class="spec-label">Line 2 (L2):</span><span class="spec-value">Black wire - 120V to N</span></div>
        <div class="spec-row"><span class="spec-label">L1 to L2:</span><span class="spec-value">240V (high power)</span></div>
        <div class="spec-row"><span class="spec-label">Neutral (N):</span><span class="spec-value">White wire</span></div>
        <div class="spec-row"><span class="spec-label">Ground:</span><span class="spec-value">Green + Bare copper</span></div>
        <div class="spec-row"><span class="spec-label">Wire Gauge:</span><span class="spec-value">10 AWG all conductors</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Split-Phase Explanation:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>L1 to Neutral = 120V AC (for 120V loads)</li>
          <li>L2 to Neutral = 120V AC (for 120V loads)</li>
          <li>L1 to L2 = 240V AC (for high-power equipment)</li>
        </ul>
        <p style="color:#cbd5e1;margin-top:0.75rem;">This configuration allows both 120V and 240V equipment to be powered from a single service entrance.</p>
      </div>
    `
  },
  'power-switch': {
    title: '240V Main Power Switch',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">It is a 2-pole main disconnect that simultaneously opens the two hot legs of a 240V circuit.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Voltage Rating:</span><span class="spec-value">240V AC</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Main disconnect</span></div>
        <div class="spec-row"><span class="spec-label">Controls:</span><span class="spec-value">Both L1 and L2 simultaneously</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Safety Function:</h4>
        <p style="color:#cbd5e1;">When OFF, this switch breaks both hot legs (L1 and L2) simultaneously, completely de-energizing all downstream equipment. This is the primary safety shutoff for maintenance and emergency situations.</p>
        <ul style="margin-left:1.5rem;margin-top:0.5rem;">
          <li>Single control point for entire system</li>
          <li>Accessible for emergency shutoff</li>
          <li>Neutral and ground remain connected (safe)</li>
        </ul>
      </div>
    `
  },
  'servo-drive': {
    title: 'Mitsubishi MR-JE-200C Conveyor Driver',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">AC servo amplifier providing closed-loop control of the conveyor motor for precise speed, torque, and position control.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Mitsubishi MR-JE-200C</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">AC Servo Drive</span></div>
        <div class="spec-row"><span class="spec-label">Power Input:</span><span class="spec-value">200-240V AC (L1-used, L2-used, L3)</span></div>
        <div class="spec-row"><span class="spec-label">Motor Output:</span><span class="spec-value">U, V, W (3-phase)</span></div>
        <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">C, D terminals</span></div>
        <div class="spec-row"><span class="spec-label">DC Bus:</span><span class="spec-value">P+ connection</span></div>
        <div class="spec-row"><span class="spec-label">Ground Output:</span><span class="spec-value"> GND (used)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Function:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Receives 240V AC power and supplies controlled three-phase output to a servo motor using closed-loop servo control. Regulates torque, speed, acceleration, deceleration, and position of the conveyor system.</p>
      </div> 
      <div class="info-box" style="margin-top:1rem;">
        <h4>Connections:</h4>
        <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
          <li><strong>L1, L2, L3:</strong> 240V AC power input</li>
          <li><strong>U, V, W:</strong> 3-phase output to conveyor motor</li>
          <li><strong>C, D:</strong> Control signals (speed, direction)</li>
          <li><strong>P+:</strong> DC link for regenerative braking</li>
          <li><strong>GND:</strong> Motor ground connection</li>
        </ul>
      </div>
    `
  },
  'outlet-120v': {
    title: '120V Power Distribution Panel',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Distributes 120V AC power to nine independent branch circuits throughout the machine system.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V AC (L1 or L2 to Neutral)</span></div>
        <div class="spec-row"><span class="spec-label">Circuits:</span><span class="spec-value">9 branch circuits</span></div>
        <div class="spec-row"><span class="spec-label">Wire Gauge:</span><span class="spec-value">14-22 AWG (load dependent)</span></div>
        <div class="spec-row"><span class="spec-label">Protection:</span><span class="spec-value">Individual breakers per circuit</span></div>
      </div>
      <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>9 Branch Circuits:</strong>
        <div style="margin-top:0.75rem;color:#cbd5e1;line-height:1.8;">
          <div><strong>1. Almond Feeder Control:</strong> Left feeder pneumatics and motor</div>
          <div><strong>2. Clay Feeder Control:</strong> Center feeder pneumatics and motor</div>
          <div><strong>3. White Feeder Control:</strong> Right feeder pneumatics and motor</div>
          <div><strong>4. Left Cabinet:</strong> Left rear feeder cabinet power</div>
          <div><strong>5. Right Cabinet:</strong> Right rear feeder cabinet power</div>
          <div><strong>6. Power Distribution Cabinet:</strong> Main power cabinet systems</div>
          <div><strong>7. Motor Control Cabinet:</strong> Motor control and driver power</div>
          <div><strong>8. Computer/HMI:</strong> PC and interface power</div>
          <div><strong>9. Auxiliary:</strong> Lighting, accessories, spare capacity</div>
        </div>
      </div>
      <div class="info-box" style="margin-top:1rem;">
        <h4>Safety Features:</h4>
        <ul style="color:#cbd5e1;line-height:1.6;margin-left:1.5rem;">
          <li>Each circuit independently protected</li>
          <li>Circuit isolation prevents cascade failures</li>
          <li>Individual breakers for maintenance access</li>
          <li>Proper wire gauge for each load type</li>
        </ul>
      </div>
    `
  }
};

// Initialize wall power modal popups
function initWallPowerComponentListeners() {
  const wallModal = document.getElementById('airDetailModal'); // Reuse the same modal
  const wallModalTitle = document.getElementById('airDetailTitle');
  const wallModalContent = document.getElementById('airDetailContent');
  const wallCloseBtn = document.getElementById('airDetailClose');
  
  if (wallModal && wallModalTitle && wallModalContent && wallCloseBtn) {
    const components = document.querySelectorAll('[data-power-component]');
    
    components.forEach(comp => {
      // Store original onclick if exists
      const originalOnClick = comp.onclick;
      
      comp.onclick = function(e) {
        e.stopPropagation();
        const key = this.dataset.powerComponent;
        const data = WALL_POWER_COMPONENT_DETAILS[key];
        
        if (data) {
          wallModalTitle.textContent = data.title;
          wallModalContent.innerHTML = data.content;
          wallModal.style.display = 'block';
        } else if (originalOnClick) {
          // If no data but had original onclick, call it
          originalOnClick.call(this, e);
        }
      };
    });
  }
}

// Power Distribution scroll-down component details
const POWER_COMPONENT_DETAILS = {
  'ac-input': {
    title: 'Wall AC Input',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Primary AC power input from wall outlet (200-240V AC).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">200-240V AC (split-phase)</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Red (L1), Black (L2), White (N), Green (GND)</span></div>
        <div class="spec-row"><span class="spec-label">Source:</span><span class="spec-value">Building electrical panel</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Safety:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">High voltage system. All downstream protection and safety devices depend on proper installation at building panel.</p>
      </div>
    `
  },
  'breaker': {
    title: 'Nader NDB1L-32',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Main circuit breaker providing overcurrent protection for entire system.</p>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Protection Functions:</h4>
        <ul style="margin-left:1.5rem;">
          <li>Trips on short circuit (instantaneous)</li>
          <li>Detects ground fault leakage</li>
        </ul>
      </div>
    `
  },
  'rcd': {
    title: 'Doepke G16',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Residual Current Device monitoring for ground fault and leakage current.</p>
      </div>
      <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Function:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Continuously monitors current balance between line and neutral. If imbalance exceeds threshold (indicating current leaking to ground), device trips immediately for personnel safety.</p>
      </div>
    `
  },
  'safety-relay': {
    title: 'DOLD D-78120 Safety Relay',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Safety relay monitoring emergency stop buttons and safety interlocks.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DOLD D-78120</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">E-stop and safety monitoring</span></div>
        <div class="spec-row"><span class="spec-label">Controls:</span><span class="spec-value">Finder 22.32.0120</span></div>
      </div>
      <div class="note-callout" style="background:rgba(168,85,247,0.1);border-left:4px solid #a855f7;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Safety Logic:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Monitors E-stop button circuit (normally closed)</li>
          <li>Monitors light curtain safety signals</li>
          <li>If any safety input opens ‚Üí relay de-energizes ‚Üí contactor drops out ‚Üí system powers down</li>
          <li>Requires manual reset after E-stop</li>
        </ul>
      </div>
    `
  },
  'finder-contactor': {
    title: 'Finder 22.32.0120',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;"> AC power contactor/relay used to enable/disable downstream AC distribution under control of the safety chain (DOLD safety relay)</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Finder 22.32.0120</span></div>
        <div class="spec-row"><span class="spec-label">Controlled by:</span><span class="spec-value">DOLD safety relay</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Safety Function:</h4>
        <p style="color:#cbd5e1;">When E-stop is pressed or safety interlock opens, DOLD relay de-energizes contactor coil ‚Üí contacts open ‚Üí ALL AC power is disconnected. System cannot restart until safety conditions are restored and manual reset is performed.</p>
      </div>
    `
  },
  'ukk-terminals': {
    title: 'UKK80 Terminal Blocks',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact terminal blocks providing AC distribution to all power supplies.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">UKK80</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">AC distribution bus</span></div>
        <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">LINE + NEUTRAL buses</span></div>
      </div>
      <div class="note-callout" style="background:rgba(234,179,8,0.1);border-left:4px solid #eab308;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Central junction point distributing safety-approved AC power to four DC power supplies (48V, 24V, 12V, 5V).</p>
      </div>
    `
  },
  'psu-48v': {
    title: 'SDR-480-48<br>Power Supply',
    content: `
      <div class="info-box" style="margin-bottom:2rem;">
        <h4 style="margin-bottom:1.5rem;">Description:</h4>
        <p style="color:#cbd5e1;font-size:1rem;line-height:1.8;">48V DC main motor power supply for the system</p>
      </div>
      
      <div class="specs-grid" style="margin-top:2rem;">
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Model:</span>
          <span class="spec-value" style="white-space:nowrap;">Mean Well SDR-480-48</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Output:</span>
          <span class="spec-value" style="white-space:nowrap;">48V DC</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Purpose:</span>
          <span class="spec-value" style="white-space:nowrap;">Motor drive power supply</span>
        </div>
      </div>
      
      <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1.5rem;border-radius:0.5rem;margin-top:2rem;">
        <strong style="font-size:1.1rem;">Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:1rem;line-height:1.8;">Provides high-current 48V DC distributed through Phoenix Terminal blocks</p>
      </div>
    `
  },
  'psu-24v': {
    title: 'NDR-240-24<br>Power Supply',
    content: `
      <div class="info-box" style="margin-bottom:2rem;">
        <h4 style="margin-bottom:1.5rem;">Description:</h4>
        <p style="color:#cbd5e1;font-size:1rem;line-height:1.8;">24V DC logic and control power for motor drivers and relays.</p>
      </div>
      
      <div class="specs-grid" style="margin-top:2rem;">
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Model:</span>
          <span class="spec-value" style="white-space:nowrap;">Mean Well NDR-240-24</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Output:</span>
          <span class="spec-value" style="white-space:nowrap;">24V DC</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Purpose:</span>
          <span class="spec-value" style="white-space:nowrap;">24V current distributed through Phoenix Terminal blocks for systems that does not require high-current</span>
        </div>
      </div>
      
      <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1.5rem;border-radius:0.5rem;margin-top:2rem;">
        <strong style="font-size:1.1rem;">Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:1rem;line-height:1.8;">Powers motor driver boards, solenoid valves, relay coils, and 24V sensors throughout the system.</p>
      </div>
    `
  },
  'psu-12v': {
    title: 'NDR-120-12<br>Power Supply',
    content: `
      <div class="info-box" style="margin-bottom:2rem;">
        <h4 style="margin-bottom:1.5rem;">Description:</h4>
        <p style="color:#cbd5e1;font-size:1rem;line-height:1.8;">12V DC auxiliary power for auxiliary systems.</p>
      </div>
      
      <div class="specs-grid" style="margin-top:2rem;">
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Model:</span>
          <span class="spec-value" style="white-space:nowrap;">Mean Well NDR-120-12</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Output:</span>
          <span class="spec-value" style="white-space:nowrap;">12V DC</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Purpose:</span>
          <span class="spec-value" style="white-space:nowrap;">Powers small relays, or 12V sensors</span>
        </div>
      </div>

       <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1.5rem;border-radius:0.5rem;margin-top:2rem;">
        <strong style="font-size:1.1rem;">Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:1rem;line-height:1.8;">12V DC is most likely distributed to the Right Cabinet</p>
      </div>
    `
  },
  'psu-5v': {
    title: 'Mean Well<br>5V Power Supply',
    content: `
      <div class="info-box" style="margin-bottom:2rem;">
        <h4 style="margin-bottom:1.5rem;">Description:</h4>
        <p style="color:#cbd5e1;font-size:1rem;line-height:1.8;">5V DC control power supply for low-voltage control electronics</p>
      </div>
      
      <div class="specs-grid" style="margin-top:2rem;">
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Brand:</span>
          <span class="spec-value" style="white-space:nowrap;">Mean Well</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Output:</span>
          <span class="spec-value" style="white-space:nowrap;">5V DC</span>
        </div>
        <div class="spec-row" style="margin-bottom:1.5rem;display:flex;align-items:baseline;">
          <span class="spec-label" style="min-width:150px;flex-shrink:0;margin-right:2rem;">Purpose:</span>
          <span class="spec-value" style="white-space:nowrap;">Powers low-voltage sensors and control circuits</span>
        </div>
      </div>
      
      <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1.5rem;border-radius:0.5rem;margin-top:2rem;">
        <strong style="font-size:1.1rem;">Powers:</strong>
        <ul style="margin-top:1rem;margin-left:1.5rem;color:#cbd5e1;line-height:2;">
          <li>5V control and logic circuits</li>
          <li>DN31C01 microcontrollers</li>
        </ul>
      </div>
    `
  }
};

// Initialize Power Distribution scroll-down expand/collapse
function initPowerComponentListeners() {
  const components = document.querySelectorAll('[data-power-component]');
  let currentExpandedPanel = null;
  
  components.forEach(comp => {
    comp.style.cursor = 'pointer';
    
    comp.onclick = function(e) {
      e.stopPropagation();
      const key = this.dataset.powerComponent;
      const data = POWER_COMPONENT_DETAILS[key];
      
      if (!data) return;
      
      // Check if this component already has an expanded panel
      const existingPanel = this.parentElement.querySelector('.power-detail-panel');
      
      if (existingPanel) {
        // Close this panel
        existingPanel.style.maxHeight = '0px';
        existingPanel.style.opacity = '0';
        setTimeout(() => {
          existingPanel.remove();
          this.classList.remove('selected');
          this.style.borderColor = 'transparent';
        }, 300);
        currentExpandedPanel = null;
      } else {
        // Helper function to create and show new panel
        const createAndShowPanel = (targetComp) => {
          // Create new panel
          const panel = document.createElement('div');
          panel.className = 'power-detail-panel';
          
          // Check if this is one of the bottom 4 power supplies - make them much bigger
          const isPowerSupply = ['psu-48v', 'psu-24v', 'psu-12v', 'psu-5v'].includes(targetComp.dataset.powerComponent);
          
          if (isPowerSupply) {
            // BIGGER panels for power supplies (bottom 4 components)
            panel.style.cssText = `
              max-height: 0px;
              opacity: 0;
              overflow: hidden;
              transition: all 0.3s ease-in-out;
              margin-top: 1rem;
              background: #1a1f35;
              border: 2px solid rgba(148,163,184,0.3);
              border-radius: 1rem;
              padding: 0 3rem;
              min-height: 500px;
            `;
          } else {
            // Normal size for other components
            panel.style.cssText = `
              max-height: 0px;
              opacity: 0;
              overflow: hidden;
              transition: all 0.3s ease-in-out;
              margin-top: 1rem;
              background: #1a1f35;
              border: 2px solid rgba(148,163,184,0.3);
              border-radius: 1rem;
              padding: 0 2rem;
              min-height: 300px;
            `;
          }
          
          panel.innerHTML = `
            <div style="padding: ${isPowerSupply ? '3.5rem 2rem' : '2.5rem 1rem'};">
              <h3 style="color:#60a5fa;font-size:1.5rem;margin-bottom:${isPowerSupply ? '2rem' : '1.5rem'};font-weight:700;line-height:1.4;">${data.title}</h3>
              <div style="color:#cbd5e1;line-height:1.8;font-size:1rem;">${data.content}</div>
              <div style="text-align:center;margin-top:${isPowerSupply ? '3rem' : '2rem'};">
                <button onclick="this.closest('.power-detail-panel').previousElementSibling.click()" style="background:rgba(239,68,68,0.2);border:2px solid #ef4444;color:#ef4444;padding:0.75rem 1.5rem;border-radius:0.5rem;cursor:pointer;font-size:0.95rem;font-weight:600;">‚úï Close</button>
              </div>
            </div>
          `;
          
          // Insert panel after the component's parent container
          targetComp.parentElement.appendChild(panel);
          
          // Mark component as selected
          targetComp.classList.add('selected');
          targetComp.style.borderColor = '#fbbf24';
          
          // Trigger expand animation
          setTimeout(() => {
            panel.style.maxHeight = isPowerSupply ? '4000px' : '3000px';
            panel.style.opacity = '1';
            panel.style.padding = isPowerSupply ? '0 3rem' : '0 2rem';
          }, 10);
          
          // Scroll to the panel
          setTimeout(() => {
            panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 350);
          
          currentExpandedPanel = panel;
        };
        
        // Close any other open panel first
        if (currentExpandedPanel) {
          currentExpandedPanel.style.maxHeight = '0px';
          currentExpandedPanel.style.opacity = '0';
          setTimeout(() => {
            currentExpandedPanel.remove();
          }, 300);
          document.querySelectorAll('[data-power-component].selected').forEach(c => {
            c.classList.remove('selected');
            c.style.borderColor = 'transparent';
          });
          
          // Wait for close animation to complete (320ms) before opening new panel
          setTimeout(() => {
            createAndShowPanel(this);
          }, 320);
        } else {
          // No panel currently open, create immediately
          createAndShowPanel(this);
        }
      }
    };
  });
}

const RIGHT_FEEDER_COMPONENT_DETAILS = {
  'wall-ac': {
    title: 'Wall AC Power',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">AC line and neutral power from wall outlet serving the Right Rear Feeder circuit.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">200-240V AC</span></div>
        <div class="spec-row"><span class="spec-label">Source:</span><span class="spec-value">240V split-phase distribution</span></div>
        <div class="spec-row"><span class="spec-label">Branch:</span><span class="spec-value">Right Rear Feeder Control</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Safety:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Dedicated 120V branch circuit with proper overcurrent protection via Nader Circuit Breaker.</p>
      </div>
    `
  },
  'nader': {
    title: 'Nader NDB1L-32',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Residual Current Circuit Breaker with Overcurrent protection - combines circuit breaker and Protection Device functions.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Nader NDB1L-32</span></div>
        <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">High Current</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Overcurrent + Ground Fault</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">1-pole Circuit Breaker</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Dual Protection:</h4>
        <ul style="margin-left:1.5rem;">
          <li><strong>Overcurrent:</strong> Trips if load exceeds limit</li>
          <li><strong>Ground Fault:</strong> Detects leakage current to ground</li>
          <li><strong>Primary Safety:</strong> First line of defense for circuit</li>
        </ul>
      </div>
    `
  },
  'doepke': {
    title: 'Doepke G16',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Residual Current Device providing sensitive ground fault detection and leakage monitoring.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">Doepke G16</span></div>
        <div class="spec-row"><span class="spec-label">Trip Current:</span><span class="spec-value">30mA typical</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Ground fault / leakage detection</span></div>
      </div>
      <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Protection:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Monitors for current imbalance between line and neutral. Trips if leakage current (to ground or chassis) exceeds threshold. Critical safety device for personnel protection.</p>
      </div>
    `
  },
  'ukk80': {
    title: 'UKK80 Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact terminal block distributing 120V AC to downstream power supplies.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">UKK80</span></div>
        <div class="spec-row"><span class="spec-label">Rating:</span><span class="spec-value">500V</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">AC distribution junction</span></div>
        <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">L2/N2 AC distribution</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Splits 120V AC to both Dinkle 24V PSU and Mean Well 5V PSU.</p>
      </div>
    `
  },
  'dinkle-24v': {
    title: 'Dinkle 24V Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Main 24V DC power supply for motor driver, solenoids, and sensor power.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Brand:</span><span class="spec-value">Dinkle Series</span></div>
        <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">24V DC (DC:20-50V)</span></div>
        <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V AC (from UKK80)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution (3 paths):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>Path 1:</strong> V+/V- to NOM stepper driver</li>
          <li><strong>Path 2:</strong> Vcc to EE-SX950W optical sensor</li>
          <li><strong>Path 3:</strong> 24V to Red Phoenix Terminal (solenoids & CAP circuits)</li>
        </ul>
      </div>
    `
  },
  'meanwell-5v': {
    title: 'Mean Well 5V Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Precision 5V DC supply for DN31C01 microcontroller and logic circuits.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Brand:</span><span class="spec-value">Mean Well</span></div>
        <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">5V DC</span></div>
        <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">120V AC (from UKK80)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>5V Logic Loop:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Powers DN31C01 microcontroller which provides logic control signals (PU, DR, MF) to NOM driver and reads sensor feedback.</p>
      </div>
    `
  },
  'red-phoenix': {
    title: 'Red Phoenix Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Positive 24V DC power rail distributing to solenoid valves and CAP protection circuits.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">+24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Source:</span><span class="spec-value">Dinkle 24V PSU</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>V+ to 6x solenoid valves (24VDC coils)</li>
          <li>V+ to 6x CAP surge protection circuits</li>
        </ul>
      </div>
    `
  },
  'black-phoenix': {
    title: 'Black Phoenix Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Common 0V ground reference for all DC circuits in Right Rear Feeder.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">0V (Ground)</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">DC return path</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Returns from:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>6x solenoid valve returns</li>
          <li>CAP circuit grounds</li>
          <li>EE-SX950W sensor ground</li>
          <li>DN31C01 ground reference</li>
        </ul>
      </div>
    `
  },
  'nom-driver': {
    title: 'FMDD50D40 NOM Stepper Driver',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Digital stepper motor driver controlling Right Rear Feeder X-axis horizontal motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">FMDD50D40 NOM Driver</span></div>
        <div class="spec-row"><span class="spec-label">Power Input:</span><span class="spec-value">DC:20-50V (24V typical from Dinkle PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Logic:</span><span class="spec-value">5V (PU, DR, MF from DN31C01)</span></div>
        <div class="spec-row"><span class="spec-label">Motor:</span><span class="spec-value">Bipolar stepper motor (4-wire)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(192,132,252,0.1);border-left:4px solid #c084fc;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Control Signals (5V logic):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>PU:</strong> Pulse (STEP) - each pulse = 1 microstep</li>
          <li><strong>DR:</strong> Direction (HIGH/LOW)</li>
          <li><strong>MF:</strong> Motor Free (Enable/Disable)</li>
        </ul>
        <strong style="display:block;margin-top:1rem;">Output:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">4-wire bipolar connection (A+, A-, B+, B-) to X-axis stepper motor</p>
      </div>
    `
  },
  'x-motor': {
    title: 'X-Axis Stepper Motor',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Bipolar stepper motor providing Right Rear Feeder X-axis horizontal positioning.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Bipolar stepper motor</span></div>
        <div class="spec-row"><span class="spec-label">Connection:</span><span class="spec-value">4-wire (A+, A-, B+, B-)</span></div>
        <div class="spec-row"><span class="spec-label">Phase A:</span><span class="spec-value">Red (+), Green (-)</span></div>
        <div class="spec-row"><span class="spec-label">Phase B:</span><span class="spec-value">Yellow (+), Blue (-)</span></div>
        <div class="spec-row"><span class="spec-label">Motion:</span><span class="spec-value">Horizontal (X-axis)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Operation:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">FMDD50D40 NOM driver sends alternating current to A and B coils ‚Üí rotor rotates in precise microsteps ‚Üí horizontal positioning of right rear feeder cradle</p>
      </div>
    `
  },
  'relays': {
    title: '41F-1ZC2-5 Relay (6x)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Electromechanical relays that switch 24V power to solenoid valves based on DN31C01 control signals.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1ZC2-5</span></div>
        <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">6 relays (one per solenoid)</span></div>
        <div class="spec-row"><span class="spec-label">Coil Terminals:</span><span class="spec-value">A1, A2 (control input from DN31C01)</span></div>
        <div class="spec-row"><span class="spec-label">Contact Terminals:</span><span class="spec-value">11‚Üí14 (switches 24V to solenoid)</span></div>
        <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC (controlled by DN31C01 output)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(249,115,22,0.1);border-left:4px solid #f97316;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Operation Sequence:</strong>
        <ol style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
          <li>DN31C01 sends control signal to relay coil A1</li>
          <li>Current flows through coil (A1 to A2), energizing electromagnet</li>
          <li>Relay contacts close: Pin 11 connects to Pin 14</li>
          <li>+24V flows from Red Phoenix Terminal ‚Üí Pin 11 ‚Üí Pin 14 ‚Üí Solenoid V+</li>
          <li>Solenoid energizes and actuates pneumatic valve</li>
          <li>When DN31C01 removes signal, relay opens, solenoid de-energizes</li>
        </ol>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Function:</h4>
        <p style="color:#cbd5e1;">The relay provides electrical isolation between the 5V logic control (DN31C01) and the 24V DC power switching for solenoids. This prevents damage to the microcontroller while allowing control of high-current solenoid coils.</p>
      </div>
    `
  },
  'solenoids': {
    title: '6x Solenoid Valves (24VDC)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Six pneumatic solenoid valves controlling clamps, ejectors, and actuators for right rear station.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">6 valves</span></div>
        <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Power Source:</span><span class="spec-value">Red Phoenix Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">41F-1Z-C2-5 relays (from DN31C01)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(37,99,235,0.1);border-left:4px solid #2563eb;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Control Sequence:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">DN31C01 activates relay ‚Üí Relay closes ‚Üí 24V flows to solenoid coil ‚Üí Valve opens ‚Üí Compressed air flows ‚Üí Pneumatic action</p>
      </div>
      <div class="info-box" style="margin-top:1rem;">
        <h4>Surge Protection:</h4>
        <p style="color:#cbd5e1;">Each solenoid has a dedicated CAP circuit to suppress inductive voltage spikes during de-energization.</p>
      </div>
    `
  },
  'cap-circuits': {
    title: '6x CAP Surge Protection Circuits',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Capacitor-based surge protection circuits protecting against inductive kickback from solenoid coils.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Quantity:</span><span class="spec-value">6 circuits (one per solenoid)</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">RC snubber circuits</span></div>
        <div class="spec-row"><span class="spec-label">Configuration:</span><span class="spec-value">5√ó V+/GND, 1√ó V+/Cathode</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Critical Protection:</h4>
        <p style="color:#cbd5e1;">When solenoid coil de-energizes, collapsing magnetic field generates high-voltage spike (300-500V). CAP circuits absorb this energy preventing:</p>
        <ul style="margin-left:1.5rem;margin-top:0.5rem;">
          <li>Relay contact arcing and pitting</li>
          <li>Damage to DN31C01 control outputs</li>
          <li>Electrical noise in control circuits</li>
        </ul>
      </div>
    `
  },
  'ee-sx950w': {
    title: 'EE-SX950W Optical Sensor',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Through-beam optical sensor for X-axis homing and part presence detection.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">EE-SX950W</span></div>
        <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">24V DC (Vcc from Dinkle PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">3-wire (Vcc, OUT1, GND)</span></div>
        <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">OUT1 ‚Üí DN31C01</span></div>
      </div>
      <div class="note-callout" style="background:rgba(37,99,235,0.1);border-left:4px solid #2563eb;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Function:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Detects X-axis home position and part presence. When beam is broken, OUT1 signal changes state ‚Üí DN31C01 reads this for position reference.</p>
      </div>
    `
  },
  'dn31c01': {
    title: 'DN31C01 Microcontroller',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Arduino-based microcontroller providing 5V logic control for motor driver and solenoid relays.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DN31C01 (Arduino Nano compatible)</span></div>
        <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V DC (from Mean Well PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB-C connection</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Outputs (5V logic):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>PU, DR, MF:</strong> To NOM driver for X-axis motor control</li>
          <li><strong>Relay Controls:</strong> To 6x 41F-1Z-C2-5 relays for solenoid activation</li>
        </ul>
        <strong style="display:block;margin-top:1rem;">Inputs:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>OUT1:</strong> From EE-SX950W optical sensor</li>
          <li><strong>Feedback:</strong> Position and status signals</li>
        </ul>
      </div>
    `
  }
};

// Initialize right feeder component listeners
function initRightFeederComponentListeners() {
  const rightModal = document.getElementById('airDetailModal'); // Reuse the same modal
  const rightModalTitle = document.getElementById('airDetailTitle');
  const rightModalContent = document.getElementById('airDetailContent');
  const rightCloseBtn = document.getElementById('airDetailClose');
  
  if (rightModal && rightModalTitle && rightModalContent && rightCloseBtn) {
    const components = document.querySelectorAll('[data-component]');
    
    components.forEach(comp => {
      comp.onclick = function(e) {
        e.stopPropagation();
        const key = this.dataset.component;
        const data = RIGHT_FEEDER_COMPONENT_DETAILS[key];
        if (data) {
          rightModalTitle.textContent = data.title;
          rightModalContent.innerHTML = data.content;
          rightModal.style.display = 'block';
        }
      };
    });
  }
}

const MOTOR_COMPONENT_DETAILS = {
  'sdr-480-48': {
    title: 'SDR-480-48 Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Main motor power supply providing high-current 48V DC for all stepper motor drivers (Vmain).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">SDR-480-48</span></div>
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">48V DC</span></div>
        <div class="spec-row"><span class="spec-label">Output Power:</span><span class="spec-value">@ 48V</span></div>
        <div class="spec-row"><span class="spec-label">Location:</span><span class="spec-value">Power Cabinet</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Red Terminal ‚Üí Individual fuses ‚Üí All 4 motor drivers (X, Y, Z, 4th)</p>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Provides the high-current power needed to drive stepper motor coils (A+/A-, B+/B-).</p>
      </div>
    `
  },
  'ndr-240-24': {
    title: 'NDR-240-24 Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Logic and relay power supply providing 24V DC for driver logic circuits (Vlogic).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">NDR-240-24</span></div>
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Output Power:</span><span class="spec-value">@ 24V</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Vlogic, relay coils, enable signals</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Red ‚Üí WAGO 221 Vlogic Splicer ‚Üí All 4 motor control boards</p>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Powers control logic circuits enabling signal processing and motor control.</p>
      </div>
    `
  },
  'ndr-120-12': {
    title: 'NDR-120-12 Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Auxiliary 12V DC power supply for auxiliary systems.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">NDR-120-12</span></div>
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">12V DC</span></div>
        <div class="spec-row"><span class="spec-label">Output Power:</span><span class="spec-value">@ 12V</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Auxiliary system power</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Red Terminal ‚Üí Auxiliary systems requiring 12V DC</p>
      </div>
    `
  },
  'mean-well-5v': {
    title: 'Mean Well 5V Power Supply',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Precision 5V DC supply for sensors, encoders, and feedback devices.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Brand:</span><span class="spec-value">Mean Well</span></div>
        <div class="spec-row"><span class="spec-label">Output Voltage:</span><span class="spec-value">5V DC</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Sensor and encoder power</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Powers:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>EE-SX950W optical sensors (X/Y/Z-START home positions)</li>
          <li>Encoders (X/Y/Z-LIN bundles for position feedback)</li>
          <li>Light bars (status indicators)</li>
        </ul>
      </div>
    `
  },
  'phoenix-red': {
    title: 'Phoenix Red Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Positive power rail distributing +48V, +24V, and +5V throughout Motor Control Cabinet.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Voltages:</span><span class="spec-value">+48V, +24V, +12V, +5V</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Positive power distribution hub</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution Paths:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>48V:</strong> To motor drivers (Vmain) with individual fuses</li>
          <li><strong>24V:</strong> To WAGO 221 Vlogic splicer ‚Üí 4 motor boards</li>
          <li><strong>12V:</strong> To auxiliary systems</li>
          <li><strong>5V:</strong> To sensors and encoders</li>
        </ul>
      </div>
    `
  },
  'phoenix-black': {
    title: 'Phoenix Black Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Common ground (0V) reference for all DC circuits in Motor Control Cabinet.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-label">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">0V (Ground)</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">System ground reference</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Ground Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Black ‚Üí WAGO Ground Splicer ‚Üí All 4 motor boards (GND inputs)</p>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Common ground reference for signals, encoders, power returns, and safety.</p>
      </div>
    `
  },
  'wago-vlogic': {
    title: 'WAGO 221 Vlogic Splicer',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Distributes 24V logic power (Vlogic) to all 4 motor control boards using tool-free lever connections.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">WAGO 221 Series</span></div>
        <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">5-port (1 input + 4 outputs)</span></div>
        <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">24V from NDR-240-24 (via Phoenix Red)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Splits 24V Vlogic power to all 4 motor control boards simultaneously.</p>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Enables driver circuits to process control signals and drive motors.</p>
      </div>
    `
  },
  'wago-ground': {
    title: 'WAGO Ground Splicer',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Connects ground wires from all 4 motor control boards to Phoenix Black terminal (system ground).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">WAGO Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">5-port ground junction</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Common ground reference</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Critical for:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Signal integrity (common reference for all boards)</li>
          <li>Safety (proper ground path)</li>
          <li>Noise reduction (single-point ground)</li>
        </ul>
      </div>
    `
  },
  'x-driver': {
    title: 'X-Axis Motor Driver (DM542)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Digital stepper motor driver controlling X-axis horizontal motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DM542</span></div>
        <div class="spec-row"><span class="spec-label">Vmain:</span><span class="spec-value">48V DC (from SDR-480-48)</span></div>
        <div class="spec-row"><span class="spec-label">Vlogic:</span><span class="spec-value">24V DC (from NDR-240-24)</span></div>
        <div class="spec-row"><span class="spec-label">Motor:</span><span class="spec-value">NEMA 23 Bipolar</span></div>
      </div>
      <div class="note-callout" style="background:rgba(236,72,153,0.1);border-left:4px solid #ec4899;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Inputs:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>STEP:</strong> Pulse train for motion (1 pulse = 1 microstep)</li>
          <li><strong>DIR:</strong> Direction (HIGH/LOW)</li>
          <li><strong>EN:</strong> Enable (LOW = enabled)</li>
        </ul>
        <strong style="display:block;margin-top:1rem;">Outputs:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>A+/A-:</strong> Phase A coil (Red/Green wires)</li>
          <li><strong>B+/B-:</strong> Phase B coil (Yellow/Blue wires)</li>
        </ul>
      </div>
    `
  },
  'y-driver': {
    title: 'Y-Axis Motor Driver (DM542)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Digital stepper motor driver controlling Y-axis lateral motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DM542</span></div>
        <div class="spec-row"><span class="spec-label">Vmain:</span><span class="spec-value">48V DC (from SDR-480-48)</span></div>
        <div class="spec-row"><span class="spec-label">Vlogic:</span><span class="spec-value">24V DC (from NDR-240-24)</span></div>
        <div class="spec-row"><span class="spec-label">Motor:</span><span class="spec-value">NEMA 23 Bipolar</span></div>
      </div>
      <div class="note-callout" style="background:rgba(236,72,153,0.1);border-left:4px solid #ec4899;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Control Signals:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">STEP/DIR/EN from motion controller ‚Üí precise Y-axis positioning</p>
        <strong style="display:block;margin-top:1rem;">Motor Output:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">4-wire bipolar connection (A+/A-, B+/B-) to Y-axis NEMA 23 motor</p>
      </div>
    `
  },
  'z-driver': {
    title: 'Z-Axis Motor Driver (DM542)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Digital stepper motor driver controlling Z-axis vertical motion with integrated brake control.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DM542</span></div>
        <div class="spec-row"><span class="spec-label">Vmain:</span><span class="spec-value">48V DC (from SDR-480-48)</span></div>
        <div class="spec-row"><span class="spec-label">Vlogic:</span><span class="spec-value">24V DC (from NDR-240-24)</span></div>
        <div class="spec-row"><span class="spec-label">Special:</span><span class="spec-value">Z-axis brake integration</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Z-Axis Brake:</h4>
        <p style="color:#cbd5e1;">Electromagnetic brake prevents Z-axis drop when power is removed. Brake releases when motor is energized, engages when motor is disabled.</p>
      </div>
    `
  },
  '4th-driver': {
    title: '4th Motor Driver (DM542)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Additional motor driver for auxiliary motor functions.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DM542</span></div>
        <div class="spec-row"><span class="spec-label">Vmain:</span><span class="spec-value">48V DC (from SDR-480-48)</span></div>
        <div class="spec-row"><span class="spec-label">Vlogic:</span><span class="spec-value">24V DC (from NDR-240-24)</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Auxiliary motor control</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Function:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Controls additional stepper motor for auxiliary machine functions beyond X/Y/Z axes.</p>
      </div>
    `
  },
  'x-motor': {
    title: 'X-Axis Stepper Motor',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">NEMA 23 bipolar stepper motor providing X-axis horizontal motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">NEMA 23 Bipolar</span></div>
        <div class="spec-row"><span class="spec-label">Connection:</span><span class="spec-value">4-wire (A+, A-, B+, B-)</span></div>
        <div class="spec-row"><span class="spec-label">Colors:</span><span class="spec-value">Red, Green, Yellow, Blue</span></div>
        <div class="spec-row"><span class="spec-label">Motion:</span><span class="spec-value">Horizontal (left/right)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Wire Connections:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>A+ (Red):</strong> Phase A positive</li>
          <li><strong>A- (Green):</strong> Phase A negative</li>
          <li><strong>B+ (Yellow):</strong> Phase B positive</li>
          <li><strong>B- (Blue):</strong> Phase B negative</li>
        </ul>
      </div>
    `
  },
  'y-motor': {
    title: 'Y-Axis Stepper Motor',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">NEMA 23 bipolar stepper motor providing Y-axis lateral motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">NEMA 23 Bipolar</span></div>
        <div class="spec-row"><span class="spec-label">Connection:</span><span class="spec-value">4-wire (A+, A-, B+, B-)</span></div>
        <div class="spec-row"><span class="spec-label">Colors:</span><span class="spec-value">Red, Green, Yellow, Blue</span></div>
        <div class="spec-row"><span class="spec-label">Motion:</span><span class="spec-value">Lateral (forward/back)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Operation:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Driver sends alternating current to A and B coils in precise sequence ‚Üí rotor rotates in microsteps ‚Üí precise Y-axis positioning</p>
      </div>
    `
  },
  'z-motor': {
    title: 'Z-Axis Stepper Motor',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">NEMA 23 bipolar stepper motor with integrated electromagnetic brake for Z-axis vertical motion.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">NEMA 23 Bipolar with Brake</span></div>
        <div class="spec-row"><span class="spec-label">Connection:</span><span class="spec-value">4-wire motor + 2-wire brake</span></div>
        <div class="spec-row"><span class="spec-label">Colors:</span><span class="spec-value">Red, Green, Yellow, Blue</span></div>
        <div class="spec-row"><span class="spec-label">Motion:</span><span class="spec-value">Vertical (up/down)</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Brake Function:</h4>
        <p style="color:#cbd5e1;">Electromagnetic brake prevents vertical drop when motor is disabled. Essential for safety - holds Z-axis position even during power loss.</p>
      </div>
    `
  },
  'sensors': {
    title: 'EE-SX950W Optical Sensors',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Through-beam optical sensors used for home position detection on X, Y, and Z axes.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">EE-SX950W</span></div>
        <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V DC (from Mean Well PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">3-wire (Vcc, OUT1, GND)</span></div>
        <div class="spec-row"><span class="spec-label">Locations:</span><span class="spec-value">X-START, Y-START, Z-START</span></div>
      </div>
      <div class="note-callout" style="background:rgba(37,99,235,0.1);border-left:4px solid #2563eb;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Homing Function:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">System moves each axis until sensor beam is broken ‚Üí establishes home position (zero reference) ‚Üí all subsequent moves calculated from this point</p>
      </div>
    `
  },
  'encoders': {
    title: 'Position Encoders (X/Y/Z-LIN)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Linear encoders providing real-time position feedback for closed-loop control on all three axes.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V DC (from Mean Well PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Incremental encoders</span></div>
        <div class="spec-row"><span class="spec-label">Axes:</span><span class="spec-value">X-LIN, Y-LIN, Z-LIN bundles</span></div>
      </div>
      <div class="note-callout" style="background:rgba(37,99,235,0.1);border-left:4px solid #2563eb;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Closed-Loop Control:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Encoder pulses continuously report actual position ‚Üí controller compares to commanded position ‚Üí corrects for any missed steps or positioning errors</p>
      </div>
    `
  },
  'light-bars': {
    title: 'Status Light Bars',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Visual status indicators showing system state, errors, and operational status.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Power:</span><span class="spec-value">5V DC (from Mean Well PSU)</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">LED light bars</span></div>
        <div class="spec-row"><span class="spec-label">Purpose:</span><span class="spec-value">Visual status feedback</span></div>
      </div>
      <div class="note-callout" style="background:rgba(37,99,235,0.1);border-left:4px solid #2563eb;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Status Indications:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Power on/off</li>
          <li>Motion in progress</li>
          <li>Fault conditions</li>
          <li>Homing complete</li>
        </ul>
      </div>
    `
  },
  'can-network': {
    title: 'CAN Communication Network',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Controller Area Network (CAN) bus connecting all 4 motor control boards in a communication loop.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Protocol:</span><span class="spec-value">CAN bus</span></div>
        <div class="spec-row"><span class="spec-label">Topology:</span><span class="spec-value">4-board loop</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">CAN_H and CAN_L (differential pair)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Functions:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Synchronized motion control across all axes</li>
          <li>Real-time status monitoring</li>
          <li>Fault reporting and diagnostics</li>
          <li>Parameter tuning and configuration</li>
        </ul>
        <p style="color:#cbd5e1;margin-top:0.75rem;">CAN includes both physical wire rules AND message protocol rules.</p>
      </div>
    `
  },
  'motion-controller': {
    title: 'Motion Controller (PLC)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Main motion controller processing G-code commands and generating STEP/DIR pulses for all motor control boards.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Input:</span><span class="spec-value">G-code motion commands</span></div>
        <div class="spec-row"><span class="spec-label">Output:</span><span class="spec-value">STEP/DIR/EN signals (24V logic)</span></div>
        <div class="spec-row"><span class="spec-label">Communication:</span><span class="spec-value">CAN bus to all 4 boards</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Control Flow:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">G-code command ‚Üí Motion planning ‚Üí Pulse generation ‚Üí STEP/DIR to boards ‚Üí Coordinated multi-axis motion</p>
      </div>
    `
  },
  'power-cabinet-summary': {
    title: 'Power Supply - 4 PCUs',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Power Supply houses four Power Conversion Units (PCUs) that generate all DC voltages needed by the Motor Control Cabinet.</p>
      </div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-top:1rem;">
        <div style="background:rgba(220,38,38,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(220,38,38,0.3);">
          <strong style="color:#ef4444;">SDR-480-48</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">48V DC for motor power (Vmain)</p>
        </div>
        <div style="background:rgba(249,115,22,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(249,115,22,0.3);">
          <strong style="color:#f97316;">NDR-240-24</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">24V DC for logic power (Vlogic)</p>
        </div>
        <div style="background:rgba(59,130,246,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(59,130,246,0.3);">
          <strong style="color:#3b82f6;">NDR-120-12</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">12V DC for auxiliary systems</p>
        </div>
        <div style="background:rgba(34,197,94,0.1);padding:1rem;border-radius:0.5rem;border:1px solid rgba(34,197,94,0.3);">
          <strong style="color:#22c55e;">Mean Well 5V</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">5V DC for sensors & encoders</p>
        </div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Click individual PCUs above for detailed specifications</strong>
      </div>
    `
  },
  'phoenix-summary': {
    title: 'Phoenix Terminal Blocks - Distribution System',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact DIN rail terminal blocks act as distribution hubs within the Motor Control Cabinet.</p>
      </div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-top:1rem;">
        <div style="text-align:center;padding:1.5rem;background:rgba(220,38,38,0.1);border-radius:0.5rem;">
          <div style="font-size:3rem;margin-bottom:0.5rem;">üî¥</div>
          <strong style="color:#dc2626;font-size:1.1rem;">RED</strong>
          <p style="color:#cbd5e1;font-size:0.85rem;margin-top:0.5rem;">+48V, +24V, +12V, +5V positive rails</p>
        </div>
        <div style="text-align:center;padding:1.5rem;background:rgba(31,41,55,0.3);border-radius:0.5rem;">
          <div style="font-size:3rem;margin-bottom:0.5rem;">‚ö´</div>
          <strong style="color:#9ca3af;font-size:1.1rem;">BLACK</strong>
          <p style="color:#cbd5e1;font-size:0.85rem;margin-top:0.5rem;">Ground (0V) common reference</p>
        </div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution Flow:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">PCUs ‚Üí Phoenix Terminals ‚Üí WAGO Splicing ‚Üí Motor Control Boards</p>
      </div>
    `
  },
  'motor-boards-summary': {
    title: '4 Motor Control Boards',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Four motor control boards manage X, Y, Z axes and auxiliary motor functions with closed-loop control capabilities.</p>
      </div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:1rem;margin-top:1rem;">
        <div style="padding:1rem;background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:0.5rem;">
          <strong style="color:#ec4899;">Board 1 - X-Axis</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">Horizontal motion control</p>
        </div>
        <div style="padding:1rem;background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:0.5rem;">
          <strong style="color:#ec4899;">Board 2 - Y-Axis</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">Lateral motion control</p>
        </div>
        <div style="padding:1rem;background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:0.5rem;">
          <strong style="color:#ec4899;">Board 3 - Z-Axis</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">Vertical motion + Z brake control</p>
        </div>
        <div style="padding:1rem;background:rgba(236,72,153,0.1);border:1px solid rgba(236,72,153,0.3);border-radius:0.5rem;">
          <strong style="color:#ec4899;">Board 4 - Auxiliary</strong>
          <p style="color:#cbd5e1;margin-top:0.5rem;font-size:0.9rem;">Additional motor functions</p>
        </div>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Power Input:</span><span class="spec-value">48V Vmain + 24V Vlogic</span></div>
        <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">STEP/DIR signals from controller</span></div>
        <div class="spec-row"><span class="spec-label">Feedback:</span><span class="spec-value">Encoder (ENC_A/ENC_B) closed-loop</span></div>
        <div class="spec-row"><span class="spec-label">Communication:</span><span class="spec-value">CAN bus loop + RS485 (Modbus or similar)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Motor Outputs (From Documentation):</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Each board has motor outputs that directly drive the motors.</p>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è Z-Axis Special Feature:</h4>
        <p style="color:#cbd5e1;">Board 3 (bottom-left) OUT0 connects to Z-axis brake for load holding when power is lost or commanded.</p>
      </div>
    `
  },
  'wago-power': {
    title: 'WAGO 221 Power Splicer',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">WAGO 221 series compact splicing connector distributing 24V power to 3 motor control boards.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">WAGO 221 Series</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">24V power distribution</span></div>
        <div class="spec-row"><span class="spec-label">Connections:</span><span class="spec-value">1 input + 3 outputs</span></div>
        <div class="spec-row"><span class="spec-label">Connection Method:</span><span class="spec-value">Tool-free lever clamps</span></div>
      </div>
      <div class="note-callout" style="background:rgba(168,85,247,0.1);border-left:4px solid #a855f7;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Distribution:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Takes 24V from Phoenix Red terminal and splits to 3 motor control boards for general power needs.</p>
      </div>
    `
  }
};

// Initialize motor component listeners
function initMotorComponentListeners() {
  const motorModal = document.getElementById('airDetailModal'); // Reuse the same modal
  const motorModalTitle = document.getElementById('airDetailTitle');
  const motorModalContent = document.getElementById('airDetailContent');
  const motorCloseBtn = document.getElementById('airDetailClose');
  
  if (motorModal && motorModalTitle && motorModalContent && motorCloseBtn) {
    const components = document.querySelectorAll('[data-motor-component]');
    
    components.forEach(comp => {
      comp.onclick = function(e) {
        e.stopPropagation();
        const key = this.dataset.motorComponent;
        const data = MOTOR_COMPONENT_DETAILS[key];
        if (data) {
          motorModalTitle.textContent = data.title;
          motorModalContent.innerHTML = data.content;
          motorModal.style.display = 'block';
        }
      };
    });
  }
}

const AIR_COMPONENT_DETAILS = {
  'red-terminal': {
    title: 'Red Phoenix Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact DIN rail terminal block for 24V distribution.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">24V distribution to 41F-1ZC2-5 relay</span></div>
      </div>
      <div class="note-callout" style="background:rgba(220,38,38,0.1);border-left:4px solid #dc2626;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>From PDF:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">"Terminal Block Red: 24V distribution to the 41F-1ZC2-5 relay"</p>
      </div>
    `
  },
  'brown-terminal': {
    title: 'Brown Phoenix Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact DIN rail terminal block for 24V distribution to manifolds and feeders.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">24V to Screw Manifolds/Distribution</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,69,19,0.15);border-left:4px solid #8b4513;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>From PDF:</strong>
        <p style="color:#cbd5e1;margin-top:0.5rem;">"Terminal Block Brown: 24V to Screw Manifolds/Distribution and the three (Clay, Almond, and White)"</p>
      </div>
    `
  },
  'black-terminal': {
    title: 'Black Phoenix Terminal Block',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Phoenix Contact DIN rail terminal block serving as the return path for the entire AirFeed system.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">Phoenix DIN Rail Terminal</span></div>
        <div class="spec-row"><span class="spec-label">Voltage:</span><span class="spec-value">0V (return/ground)</span></div>
        <div class="spec-row"><span class="spec-label">Function:</span><span class="spec-value">Common return path</span></div>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>From PDF - Return path for:</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Solenoid valve coil returns</li>
          <li>Sensor ground lines</li>
          <li>Microcontroller ground tie-ins</li>
          <li>Driver board input returns</li>
          <li>Pressure sensor grounds</li>
          <li>Optical sensor grounds</li>
          <li>Cap detection sensor grounds</li>
          <li>Airfeed logic ground</li>
        </ul>
      </div>
    `
  },
  'dn31c01': {
    title: 'DN31C01 Arduino Nano (Microcontroller)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Arduino Nano-compatible microcontroller that independently manages all solenoid timing, sequencing, and sensor processing.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">DN31C01 (Arduino Nano compatible)</span></div>
        <div class="spec-row"><span class="spec-label">Programming:</span><span class="spec-value">USB-C connection</span></div>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Primary Functions (from PDF):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
          <li>Controls air-feed solenoids</li>
          <li>Reads sensors (optical, cap-detection, limit) via digital D2-D13 and analog A0-A7</li>
          <li>Runs timing sequences (delays, pulse durations, retries, timeouts)</li>
          <li>Tracks feeder state</li>
          <li>Communicates feeder readiness to main controller</li>
          <li>Detects jams or feed failures</li>
          <li>Provides independent control (main controller is not overloaded)</li>
        </ul>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è From PDF:</h4>
        <p style="color:#cbd5e1;">"The main machine does NOT micromanage air feeding ‚Äî this microcontroller does it."</p>
        <p style="color:#cbd5e1;margin-top:0.5rem;">"Without this microcontroller: solenoids fire wrong, caps don't feed, system jams constantly, timing cannot be maintained, system cannot self-correct."</p>
      </div>
    `
  },
  '41f-relay': {
    title: '41F-1Z-C2-5 Relay Socket',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">DIN-rail mount relay socket with 1-pole SPDT mechanical relay.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Model:</span><span class="spec-value">41F-1Z-C2-5</span></div>
        <div class="spec-row"><span class="spec-label">Type:</span><span class="spec-value">1-pole SPDT</span></div>
        <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">+24V DC (A1-A2)</span></div>
        <div class="spec-row"><span class="spec-label">Contact Rating:</span><span class="spec-value">6A @ 250VAC / 24VDC</span></div>
      </div>
      <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Coil Terminals (from PDF):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>A1:</strong> Positive control voltage (from controller)</li>
          <li><strong>A2:</strong> Return / 0V</li>
          <li>When A1-A2 gets +24V DC, relay coil pulls in</li>
        </ul>
      </div>
      <div class="note-callout" style="background:rgba(99,102,241,0.1);border-left:4px solid #6366f1;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Contact Terminals (from PDF):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li><strong>Pin 11:</strong> Common - "tied to the black terminal"</li>
          <li><strong>Pin 14:</strong> Normally Open - "goes into the microprocessor as the sense input"</li>
        </ul>
        <p style="color:#cbd5e1;margin-top:0.75rem;"><strong>From PDF:</strong> "Pin 11 is tied to the black terminal because the relay contact is being used to pull a microprocessor input DOWN to 0V when the relay activates. This is low-side signaling, not power switching."</p>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è From PDF:</h4>
        <p style="color:#cbd5e1;">"The relay is not controlling a valve or solenoid. It's simply providing a clean, isolated digital input to the controller."</p>
      </div>
    `
  },
  'screw-feed': {
    title: 'Screw Feed Manifold (Group A)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Pneumatic solenoid manifold with 6 valves (24V DC coils).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Valve Count:</span><span class="spec-value">6 solenoid valves</span></div>
        <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Blue (+24V) / Brown (0V)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(34,197,94,0.1);border-left:4px solid #22c55e;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Functions (from PDF - Group A):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Blow screws/caps forward</li>
          <li>Advance parts in chute</li>
          <li>Clear jams</li>
          <li>Move parts to next step</li>
        </ul>
      </div>
    `
  },
  'screw-distribution': {
    title: 'Screw Distribution Manifold (Group B)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Pneumatic solenoid manifold with 6 valves (24V DC coils).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Valve Count:</span><span class="spec-value">6 solenoid valves</span></div>
        <div class="spec-row"><span class="spec-label">Coil Voltage:</span><span class="spec-value">24V DC</span></div>
        <div class="spec-row"><span class="spec-label">Wiring:</span><span class="spec-value">Red (+24V) / Black (0V)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(59,130,246,0.1);border-left:4px solid #3b82f6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Functions (from PDF - Group B):</strong>
        <ul style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;">
          <li>Routes screws to: Left</li>
          <li>Routes screws to: Middle</li>
          <li>Routes screws to: Bottom</li>
        </ul>
        <p style="color:#cbd5e1;margin-top:0.75rem;">"This lets the machine choose which path the screw goes to."</p>
      </div>
    `
  },
  'feeder-modules': {
    title: 'Feeder Modules (Clay / Almond / White)',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Three independent solenoid-driven pneumatic feeder channels.</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Feeders:</span><span class="spec-value">Clay, Almond, White</span></div>
        <div class="spec-row"><span class="spec-label">Interface:</span><span class="spec-value">5-pin connector each</span></div>
        <div class="spec-row"><span class="spec-label">Control:</span><span class="spec-value">DN31C01 microcontroller</span></div>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è From PDF:</h4>
        <p style="color:#cbd5e1;">"Only one feeder can be activated at a time"</p>
      </div>
      <div class="note-callout" style="background:rgba(139,92,246,0.1);border-left:4px solid #8b5cf6;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Operation (from PDF):</strong>
        <ol style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
          <li>DN31C01 decides which feeder to fire (Clay/Almond/White)</li>
          <li>DN31C01 outputs HIGH on Pin 4 for selected feeder</li>
          <li>Relay energizes</li>
          <li>Relay takes raw +24V (Pin 2) and switches it to Pin 1</li>
          <li>Solenoid coil activates, valve opens, air flows</li>
          <li>Cap is pushed/fed/blown forward</li>
        </ol>
      </div>
    `
  },
  '5pin-connector': {
    title: '5-Pin Feeder Connector',
    content: `
      <div class="info-box">
        <h4>Description:</h4>
        <p style="color:#cbd5e1;margin-top:0.5rem;">Standard 5-pin connector interface for each feeder module (Clay, Almond, White).</p>
      </div>
      <div class="specs-grid" style="margin-top:1rem;">
        <div class="spec-row"><span class="spec-label">Pin 1 (Blue):</span><span class="spec-value">Switched +24V OUT (relay to solenoid)</span></div>
        <div class="spec-row"><span class="spec-label">Pin 2 (Red):</span><span class="spec-value">Raw +24V IN (from Red terminal)</span></div>
        <div class="spec-row"><span class="spec-label">Pin 3:</span><span class="spec-value">Not used</span></div>
        <div class="spec-row"><span class="spec-label">Pin 4 (Orange):</span><span class="spec-value">Control signal (DN31C01 to relay)</span></div>
        <div class="spec-row"><span class="spec-label">Pin 5 (Black):</span><span class="spec-value">Ground / 0V return (to Black terminal)</span></div>
      </div>
      <div class="note-callout" style="background:rgba(251,191,36,0.1);border-left:4px solid #fbbf24;padding:1rem;border-radius:0.5rem;margin-top:1rem;">
        <strong>Complete Operation (from PDF):</strong>
        <ol style="margin-top:0.5rem;margin-left:1.5rem;color:#cbd5e1;line-height:1.6;">
          <li>DN31C01 sends HIGH to Pin 4</li>
          <li>Pin 4 energizes relay coil</li>
          <li>Relay closes contacts (Pin 11 to Pin 14)</li>
          <li>Pin 2 (+24V) flows through relay to Pin 1</li>
          <li>Pin 1 powers solenoid coil</li>
          <li>Solenoid return via Pin 5 to Black terminal</li>
        </ol>
      </div>
      <div class="warning-box" style="margin-top:1rem;">
        <h4>‚ö†Ô∏è From PDF:</h4>
        <p style="color:#cbd5e1;">"The MicroController will operate the coil which will then closes pin 11 and pin 14 on the relay together which will short pin 1 and pin 1 together and will allow the solenoid to operate."</p>
      </div>
    `
  }
};

// Add event listeners for air components
function initAirComponentListeners() {
  const airModal = document.getElementById('airDetailModal');
  const airModalTitle = document.getElementById('airDetailTitle');
  const airModalContent = document.getElementById('airDetailContent');
  const airCloseBtn = document.getElementById('airDetailClose');
  
  if (airModal && airModalTitle && airModalContent && airCloseBtn) {
    // Remove old listeners by cloning (simple way to remove all)
    const components = document.querySelectorAll('[data-air-component]');
    
    components.forEach(comp => {
      // Create new click handler
      comp.onclick = function(e) {
        e.stopPropagation();
        const key = this.dataset.airComponent;
        const data = AIR_COMPONENT_DETAILS[key];
        if (data) {
          airModalTitle.textContent = data.title;
          airModalContent.innerHTML = data.content;
          airModal.style.display = 'block';
        }
      };
    });
    
    // Setup close handler (only once)
    if (!airCloseBtn.onclick) {
      airCloseBtn.onclick = () => {
        airModal.style.display = 'none';
      };
      
      airModal.onclick = (e) => {
        if (e.target === airModal || e.target === airModal.firstElementChild) {
          airModal.style.display = 'none';
        }
      };
    }
  }
}

document.addEventListener('DOMContentLoaded', function() {
  initAirComponentListeners(); // Try to init on page load too
  initMotorComponentListeners(); // Try to init motor components too
  initRightFeederComponentListeners(); // Try to init right feeder components too
  initPowerComponentListeners(); // Try to init power components too
  initWallPowerComponentListeners(); // Try to init wall power components too
});

// ========================================
// PASSWORD AUTHENTICATION SYSTEM
// ========================================

// Configuration
const INACTIVITY_TIMEOUT = 5 * 60 * 60 * 1000; // 5 hours in milliseconds
let inactivityTimer = null;
let lastActivityTime = Date.now();

// Function to reset view to home page (schematic view)
function resetToHomePage() {
  console.log('Resetting to home page...');
  
  // Switch back to schematic view
  const flowView = document.getElementById('flowView');
  const schematicView = document.getElementById('schematicView');
  
  if (flowView) {
    flowView.classList.remove('active');
  }
  
  if (schematicView) {
    schematicView.classList.add('active');
  }
  
  // Reset header subtitle
  const headerSubtitle = document.getElementById('headerSubtitle');
  if (headerSubtitle) {
    headerSubtitle.textContent = 'Click on any cabinet to view its detailed flow diagram';
  }
  
  console.log('View reset to home page');
}

// Function to perform logout
function performLogout(showMessage = false, message = '') {
  console.log('performLogout called with showMessage:', showMessage, 'message:', message);
  
  // Clear authentication
  sessionStorage.removeItem('launchpad_authenticated');
  sessionStorage.removeItem('launchpad_login_time');
  console.log('Session storage cleared');
  
  // Reset to home page view BEFORE showing login screen
  resetToHomePage();
  
  // Hide logout button
  const logoutButton = document.getElementById('logoutButton');
  if (logoutButton) {
    logoutButton.classList.remove('visible');
    logoutButton.style.display = 'none';
    console.log('Logout button hidden');
  }
  
  // Show login overlay with a small delay to ensure view is reset
  setTimeout(() => {
    const overlay = document.getElementById('password-overlay');
    if (overlay) {
      overlay.classList.remove('hidden');
      overlay.style.opacity = '1';
      overlay.style.display = 'flex';
      console.log('Login overlay shown');
    } else {
      console.error('Password overlay not found!');
    }
  }, 100);
  
  // Clear form fields
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  if (usernameInput) usernameInput.value = '';
  if (passwordInput) passwordInput.value = '';
  
  // Clear any error messages
  const errorMessage = document.getElementById('errorMessage');
  if (errorMessage) errorMessage.classList.remove('visible');
  
  // Show message if provided
  if (showMessage && message) {
    setTimeout(() => alert(message), 200);
  }
  
  console.log('User logged out successfully');
}

// Manual logout function (called by logout button)
function manualLogout() {
  console.log('=== Manual logout button clicked ===');
  console.log('Current authentication status:', sessionStorage.getItem('launchpad_authenticated'));
  
  // Remove the confirmation for now to test
  // if (confirm('Are you sure you want to log out?')) {
    console.log('Calling performLogout...');
    performLogout(false);
    console.log('performLogout completed');
  // } else {
  //   console.log('User cancelled logout');
  // }
  
  return false; // Prevent any default action
}

// Explicitly add to window object for inline onclick handlers
window.manualLogout = manualLogout;

// Function to show logout button
function showLogoutButton() {
  console.log('=== Attempting to show logout button ===');
  const logoutButton = document.getElementById('logoutButton');
  if (logoutButton) {
    logoutButton.classList.add('visible');
    logoutButton.style.display = 'flex'; // Force display
    console.log('Logout button display:', window.getComputedStyle(logoutButton).display);
    console.log('Logout button classes:', logoutButton.className);
  } else {
    console.error('Logout button not found in DOM');
  }
}

// Function to hide logout button
function hideLogoutButton() {
  const logoutButton = document.getElementById('logoutButton');
  if (logoutButton) {
    logoutButton.classList.remove('visible');
  }
}

// Function to reset inactivity timer
function resetInactivityTimer() {
  lastActivityTime = Date.now();
  
  // Clear existing timer
  if (inactivityTimer) {
    clearTimeout(inactivityTimer);
  }
  
  // Set new timer
  inactivityTimer = setTimeout(() => {
    performLogout(true, 'You have been logged out due to 5 hours of inactivity.');
  }, INACTIVITY_TIMEOUT);
}

// Function to check if session has expired
function checkSessionExpiry() {
  const loginTime = sessionStorage.getItem('launchpad_login_time');
  const authenticated = sessionStorage.getItem('launchpad_authenticated');
  
  if (authenticated === 'true' && loginTime) {
    const elapsedTime = Date.now() - parseInt(loginTime);
    
    // If more than 5 hours have passed since login
    if (elapsedTime > INACTIVITY_TIMEOUT) {
      performLogout(true, 'Your session has expired. Please log in again.');
      return false;
    }
  }
  
  return true;
}

function validateLogin() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;
  const errorMessage = document.getElementById('errorMessage');
  const usernameInput = document.getElementById('username');
  const passwordInput = document.getElementById('password');
  
  // Authentication credentials (you can change these)
  const validCredentials = [
    { username: 'admin', password: 'LaunchPad2024' },
    { username: 'engineer', password: 'SystemAccess123' },
    { username: 'technician', password: 'TechView2024' }
  ];
  
  // Check if credentials match
  const isValid = validCredentials.some(cred => 
    cred.username === username && cred.password === password
  );
  
  if (isValid) {
    console.log('Login successful - starting transition');
    
    // Clear error state immediately
    errorMessage.classList.remove('visible');
    usernameInput.classList.remove('error');
    passwordInput.classList.remove('error');
    
    // Ensure we're on the home page view BEFORE hiding login screen
    resetToHomePage();
    
    // Success - hide overlay with animation
    const overlay = document.getElementById('password-overlay');
    overlay.style.transition = 'opacity 0.5s ease';
    overlay.style.opacity = '0';
    
    setTimeout(() => {
      overlay.classList.add('hidden');
      overlay.style.display = 'none'; // Ensure it's gone
      
      // Store session with timestamp
      sessionStorage.setItem('launchpad_authenticated', 'true');
      sessionStorage.setItem('launchpad_login_time', Date.now().toString());
      
      // Show logout button
      showLogoutButton();
      
      // Start inactivity timer
      resetInactivityTimer();
      
      console.log('Login complete - user authenticated');
    }, 500);
    
  } else {
    // Failed login - show error
    errorMessage.classList.add('visible');
    usernameInput.classList.add('error');
    passwordInput.classList.add('error');
    
    // Shake animation
    setTimeout(() => {
      usernameInput.classList.remove('error');
      passwordInput.classList.remove('error');
    }, 400);
    
    // Clear password field
    passwordInput.value = '';
    passwordInput.focus();
  }
  
  return false;
}

// Initialize authentication system
document.addEventListener('DOMContentLoaded', function() {
  // Add click listener to logout button (alternative to onclick attribute)
  const logoutBtn = document.getElementById('logoutButton');
  if (logoutBtn) {
    logoutBtn.addEventListener('click', function(e) {
      e.preventDefault();
      manualLogout();
    });
  }
  
  // Check if already authenticated in this session
  if (sessionStorage.getItem('launchpad_authenticated') === 'true') {
    // Check if session has expired
    if (checkSessionExpiry()) {
      document.getElementById('password-overlay').classList.add('hidden');
      // Show logout button
      showLogoutButton();
      // Start inactivity timer for existing session
      resetInactivityTimer();
    }
  }
  
  // Add enter key listener
  const passwordInput = document.getElementById('password');
  const usernameInput = document.getElementById('username');
  
  if (passwordInput && usernameInput) {
    passwordInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        validateLogin();
      }
    });
    
    usernameInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        validateLogin();
      }
    });
  }
  
  // ========================================
  // ACTIVITY TRACKING FOR INACTIVITY LOGOUT
  // ========================================
  
  // Track user activity to reset inactivity timer
  const activityEvents = [
    'mousedown',
    'mousemove', 
    'keypress',
    'scroll',
    'touchstart',
    'click'
  ];
  
  // Throttle activity tracking to prevent excessive calls
  let activityThrottle = null;
  
  activityEvents.forEach(event => {
    document.addEventListener(event, function() {
      // Only reset timer if user is authenticated
      if (sessionStorage.getItem('launchpad_authenticated') === 'true') {
        // Throttle to once per minute
        if (!activityThrottle) {
          resetInactivityTimer();
          
          activityThrottle = setTimeout(() => {
            activityThrottle = null;
          }, 60000); // 1 minute throttle
        }
      }
    }, true);
  });
  
  // ========================================
  // TAB CLOSE/BROWSER CLOSE - AUTO LOGOUT
  // ========================================
  
  // Detect when tab/window is about to close
  window.addEventListener('beforeunload', function(e) {
    // Clear session when tab/browser closes
    if (sessionStorage.getItem('launchpad_authenticated') === 'true') {
      performLogout();
    }
  });
  
  // ========================================
  // TAB VISIBILITY - CHECK SESSION ON RETURN
  // ========================================
  
  // Check session when user returns to tab
  document.addEventListener('visibilitychange', function() {
    if (!document.hidden) {
      // Tab became visible - check if session expired while away
      if (sessionStorage.getItem('launchpad_authenticated') === 'true') {
        if (!checkSessionExpiry()) {
          // Session expired - already logged out by checkSessionExpiry
        } else {
          // Session still valid - reset timer
          resetInactivityTimer();
        }
      }
    }
  });
  
  // ========================================
  // PERIODIC SESSION CHECK
  // ========================================
  
  // Check session validity every minute
  setInterval(() => {
    if (sessionStorage.getItem('launchpad_authenticated') === 'true') {
      checkSessionExpiry();
    }
  }, 60000); // Check every 1 minute
});

</script>
    <!-- Air Flow Component Detail Modal - Global -->
    <div id="airDetailModal" style="display:none;">
      <div style="position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.85);z-index:9999;display:flex;align-items:center;justify-content:center;padding:2rem;">
        <div style="background:#1a1f35;border:2px solid rgba(148,163,184,0.3);border-radius:1rem;padding:2rem;max-width:700px;width:90%;max-height:80vh;overflow-y:auto;position:relative;box-shadow:0 20px 60px rgba(0,0,0,0.5);">
          <button id="airDetailClose" style="position:absolute;top:1rem;right:1rem;background:rgba(239,68,68,0.2);border:1px solid #ef4444;color:#ef4444;padding:0.5rem 1rem;border-radius:0.5rem;cursor:pointer;font-size:0.9rem;font-weight:600;border:2px solid #ef4444;">‚úï Close</button>
          <h3 id="airDetailTitle" style="color:#60a5fa;font-size:1.5rem;margin-bottom:1rem;font-weight:700;padding-right:5rem;"></h3>
          <div id="airDetailContent" style="color:#cbd5e1;"></div>
        </div>
      </div>
    </div>

</body>
</html>
